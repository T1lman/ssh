[2025-06-23 18:30:24] [INFO] [Thread-0] Shutdown signal received
[2025-06-23 18:32:10] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Message length: 933
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Read 933 bytes for message body (expected 933)
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: restLength = 933
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 928 (restLength=933 - 5)
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: checksum = -1659090970
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1321
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Encrypted message length: 965
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Read 965 bytes for encrypted message body
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 965
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 937
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: restLength = 933
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 928 (restLength=933 - 5)
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] fromPacket: checksum = 488147875
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Authentication attempt for user: tilman, type: dual
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] User existence check for 'tilman': true
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] User validation passed for: tilman
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Verifying password for user: tilman
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: tilman
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for tilman: true
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Password authentication result for tilman: true
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Dual authentication successful for user: tilman
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 220
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Message encrypted, new length: 248
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 252
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:32] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Encrypted message length: 206
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Read 206 bytes for encrypted message body
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 206
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 178
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] fromPacket: restLength = 174
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 169 (restLength=174 - 5)
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] fromPacket: checksum = 1066413956
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Executing shell command: 'ls' for user: tilman
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 297
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Message encrypted, new length: 325
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 329
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:35] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Encrypted message length: 209
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Read 209 bytes for encrypted message body
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 209
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 181
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] fromPacket: restLength = 177
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 172 (restLength=177 - 5)
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] fromPacket: checksum = -525601408
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Executing shell command: 'ls -a' for user: tilman
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='.
..
.cache
.cargo
.CFUserTextEncoding
.cups
.cursor
.DS_Store
.gitconfig
.gradle
.hawtjni
.local
.matplotlib
.npm
.nvm
.openjfx
.profile
.python_history
.redhat
.rustup
.Trash
.vnc
.vscode
.zcompdump
.zprofile
.zsh_history
.zsh_sessions
.zshenv
.zshrc
Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 579
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Message encrypted, new length: 607
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 611
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:37] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Encrypted message length: 209
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Read 209 bytes for encrypted message body
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 209
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 181
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] fromPacket: restLength = 177
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 172 (restLength=177 - 5)
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] fromPacket: checksum = -2071846254
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Executing shell command: 'cd ..' for user: tilman
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='', stderr=''
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 166
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Message encrypted, new length: 194
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 198
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:40] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Encrypted message length: 199
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Read 199 bytes for encrypted message body
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 199
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 171
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] fromPacket: restLength = 167
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 162 (restLength=167 - 5)
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] fromPacket: checksum = 2046521584
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Executing shell command: 'ls' for user: tilman
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='Shared
tilman
', stderr=''
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 182
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Message encrypted, new length: 210
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 214
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:41] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Encrypted message length: 206
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Read 206 bytes for encrypted message body
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 206
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 178
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: restLength = 174
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 169 (restLength=174 - 5)
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: checksum = 1265753041
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Executing shell command: 'cd shared' for user: tilman
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='', stderr=''
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 173
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Message encrypted, new length: 201
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 205
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Encrypted message length: 206
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Read 206 bytes for encrypted message body
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 206
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 178
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: restLength = 174
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 169 (restLength=174 - 5)
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] fromPacket: checksum = -1294409911
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Executing shell command: 'ls' for user: tilman
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='Previously Relocated Items
Previously Relocated Items 1
Previously Relocated Items 2
Relocated Items
SC Info
', stderr=''
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 287
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Message encrypted, new length: 315
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 319
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:45] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Encrypted message length: 209
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Read 209 bytes for encrypted message body
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 209
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 181
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] fromPacket: restLength = 177
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 172 (restLength=177 - 5)
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] fromPacket: checksum = 1843594573
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Executing shell command: 'ls -a' for user: tilman
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Command result: exitCode=0, stdout='.
..
.betamigrated
.localized
Previously Relocated Items
Previously Relocated Items 1
Previously Relocated Items 2
Relocated Items
SC Info
', stderr=''
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 321
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Message encrypted, new length: 349
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 353
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:32:52] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Encrypted message length: 218
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Read 218 bytes for encrypted message body
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 218
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 190
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] fromPacket: restLength = 186
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 181 (restLength=186 - 5)
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] fromPacket: checksum = -1359996585
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Executing shell command: 'cd "SC Info"' for user: tilman
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Command result: exitCode=1, stdout='', stderr='cd: no such file or directory: "SC
'
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 210
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Message encrypted, new length: 238
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 242
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Sent SHELL_RESULT message to client.
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 18:33:04] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Received encrypted message: DISCONNECT
[2025-06-23 18:33:11] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Message length: 933
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Read 933 bytes for message body (expected 933)
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: restLength = 933
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 928 (restLength=933 - 5)
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: checksum = -433943254
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1321
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Encrypted message length: 966
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Read 966 bytes for encrypted message body
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 966
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 938
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: restLength = 934
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 929 (restLength=934 - 5)
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] fromPacket: checksum = 843840684
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Authentication attempt for user: admin, type: dual
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] User existence check for 'admin': true
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] User validation passed for: admin
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: admin
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Verifying password for user: admin
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: admin
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: admin
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for admin: true
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Password authentication result for admin: true
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Dual authentication successful for user: admin
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 220
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Message encrypted, new length: 248
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 252
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 18:33:36] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Encrypted message length: 206
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Read 206 bytes for encrypted message body
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 206
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 178
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] fromPacket: restLength = 174
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 169 (restLength=174 - 5)
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] fromPacket: checksum = 1066413956
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Executing shell command: 'ls' for user: admin
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 297
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Message encrypted, new length: 325
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 329
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Sent SHELL_RESULT message to client.
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 18:33:41] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Encrypted message length: 207
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Read 207 bytes for encrypted message body
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 207
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 179
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] fromPacket: restLength = 175
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] fromPacket: checksum = 1743969420
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Executing shell command: 'hey' for user: admin
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Command result: exitCode=127, stdout='sh: hey: command not found
', stderr=''
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 203
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Message encrypted, new length: 231
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 235
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Sent SHELL_RESULT message to client.
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 18:33:45] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Encrypted message length: 213
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Read 213 bytes for encrypted message body
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 213
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 185
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] fromPacket: restLength = 181
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 176 (restLength=181 - 5)
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] fromPacket: checksum = 993653183
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Executing shell command: 'cool cool' for user: admin
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Command result: exitCode=127, stdout='sh: cool: command not found
', stderr=''
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 204
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Message encrypted, new length: 232
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 236
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Sent SHELL_RESULT message to client.
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 18:33:53] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Encrypted message length: 37
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Read 37 bytes for encrypted message body
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 37
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 9
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] fromPacket: restLength = 5
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] fromPacket: checksum = 0
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Received encrypted message: DISCONNECT
[2025-06-23 18:36:33] [INFO] [pool-1-thread-2] Protocol handler closed
