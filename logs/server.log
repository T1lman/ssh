2025-06-24 15:56:19 INFO: Logger initialized: logs/server.log
2025-06-24 15:56:19 INFO: SSHServerModel: Created new model instance
2025-06-24 15:56:19 INFO: SSH Server Starting
2025-06-24 15:56:19 INFO: Log file: logs/server.log
2025-06-24 15:56:19 INFO: SSHServerController: Starting server
2025-06-24 15:56:46 INFO: SSHServerModel: Starting server
2025-06-24 15:57:03 INFO: Server: Starting client connection handler for 127.0.0.1:51898
2025-06-24 15:57:03 INFO: Server: Initializing protocol handler
2025-06-24 15:57:03 INFO: Server: Protocol handler initialized
2025-06-24 15:57:03 INFO: Server: Starting key exchange
2025-06-24 15:57:03 INFO: Server: Received key exchange init from null
2025-06-24 15:57:03 INFO: Server: Received key exchange init from null
2025-06-24 15:57:03 INFO: Server: Initializing DH key exchange
2025-06-24 15:57:03 INFO: Server: Generated DH key pair
2025-06-24 15:57:03 INFO: Server: Set client's public key
2025-06-24 15:57:03 INFO: Server: Computing shared secret
2025-06-24 15:57:03 INFO: Server: Computed shared secret, length: 256
2025-06-24 15:57:03 INFO: Server: Initializing symmetric encryption
2025-06-24 15:57:03 INFO: Server: Initialized symmetric encryption
2025-06-24 15:57:03 INFO: Server: Creating key exchange reply message
2025-06-24 15:57:03 INFO: Server: Created reply message, signing DH public key
2025-06-24 15:57:03 INFO: Server: Starting RSA signature generation
2025-06-24 15:57:03 INFO: Server: RSA signature generated, length: 256
2025-06-24 15:57:03 INFO: Server: Sending key exchange reply
2025-06-24 15:57:03 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-24 15:57:03 INFO: Message sent successfully
2025-06-24 15:57:03 INFO: Server: Key exchange reply sent successfully
2025-06-24 15:57:03 INFO: Server: Key exchange completed successfully
2025-06-24 15:57:03 INFO: Server: Enabling encryption
2025-06-24 15:57:03 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-24 15:57:03 INFO: Encryption and HMAC enabled in protocol handler
2025-06-24 15:57:03 INFO: Server: Key exchange completed successfully
2025-06-24 15:57:03 INFO: Server: Starting authentication
2025-06-24 15:57:03 INFO: Waiting to receive message...
2025-06-24 15:57:03 INFO: Reading encrypted message...
2025-06-24 15:57:03 INFO: Read -1 bytes for encrypted message length
2025-06-24 15:57:03 INFO: Client disconnected gracefully (end of stream)
2025-06-24 15:57:03 ERROR: Server: Error handling client 127.0.0.1:51898: Client disconnected gracefully
2025-06-24 15:57:03 Exception: Client disconnected gracefully
2025-06-24 15:57:03 ERROR: Server: Error handling client 127.0.0.1:51898: Client disconnected gracefully
2025-06-24 15:57:03 INFO: Server: Cleaning up client connection for 127.0.0.1:51898
2025-06-24 15:57:03 INFO: Server: Cleaning up connection for 127.0.0.1:51898
2025-06-24 15:57:03 INFO: Protocol handler closed
2025-06-24 15:59:06 INFO: Shutdown signal received
2025-06-24 15:59:06 INFO: SSHServerController: Stopping server
2025-06-24 15:59:06 INFO: SSHServerModel: Stopping server
2025-06-24 15:59:13 INFO: Logger initialized: logs/server.log
2025-06-24 15:59:13 INFO: SSHServerModel: Created new model instance
2025-06-24 15:59:13 INFO: SSH Server Starting
2025-06-24 15:59:13 INFO: Log file: logs/server.log
2025-06-24 15:59:13 INFO: SSHServerController: Starting server
2025-06-24 15:59:19 INFO: SSHServerModel: Starting server
2025-06-24 15:59:33 INFO: Server: Starting client connection handler for 127.0.0.1:51914
2025-06-24 15:59:33 INFO: Server: Initializing protocol handler
2025-06-24 15:59:33 INFO: Server: Protocol handler initialized
2025-06-24 15:59:33 INFO: Server: Starting key exchange
2025-06-24 15:59:34 INFO: Server: Received key exchange init from null
2025-06-24 15:59:34 INFO: Server: Received key exchange init from null
2025-06-24 15:59:34 INFO: Server: Initializing DH key exchange
2025-06-24 15:59:34 INFO: Server: Generated DH key pair
2025-06-24 15:59:34 INFO: Server: Set client's public key
2025-06-24 15:59:34 INFO: Server: Computing shared secret
2025-06-24 15:59:34 INFO: Server: Computed shared secret, length: 256
2025-06-24 15:59:34 INFO: Server: Initializing symmetric encryption
2025-06-24 15:59:34 INFO: Server: Initialized symmetric encryption
2025-06-24 15:59:34 INFO: Server: Creating key exchange reply message
2025-06-24 15:59:34 INFO: Server: Created reply message, signing DH public key
2025-06-24 15:59:34 INFO: Server: Starting RSA signature generation
2025-06-24 15:59:34 INFO: Server: RSA signature generated, length: 256
2025-06-24 15:59:34 INFO: Server: Sending key exchange reply
2025-06-24 15:59:34 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-24 15:59:34 INFO: Message sent successfully
2025-06-24 15:59:34 INFO: Server: Key exchange reply sent successfully
2025-06-24 15:59:34 INFO: Server: Key exchange completed successfully
2025-06-24 15:59:34 INFO: Server: Enabling encryption
2025-06-24 15:59:34 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-24 15:59:34 INFO: Encryption and HMAC enabled in protocol handler
2025-06-24 15:59:34 INFO: Server: Key exchange completed successfully
2025-06-24 15:59:34 INFO: Server: Starting authentication
2025-06-24 15:59:34 INFO: Waiting to receive message...
2025-06-24 15:59:34 INFO: Reading encrypted message...
2025-06-24 15:59:34 INFO: Read -1 bytes for encrypted message length
2025-06-24 15:59:34 INFO: Client disconnected gracefully (end of stream)
2025-06-24 15:59:34 ERROR: Server: Error handling client 127.0.0.1:51914: Client disconnected gracefully
2025-06-24 15:59:34 Exception: Client disconnected gracefully
2025-06-24 15:59:34 ERROR: Server: Error handling client 127.0.0.1:51914: Client disconnected gracefully
2025-06-24 15:59:34 INFO: Server: Cleaning up client connection for 127.0.0.1:51914
2025-06-24 15:59:34 INFO: Server: Cleaning up connection for 127.0.0.1:51914
2025-06-24 15:59:34 INFO: Protocol handler closed
2025-06-24 16:01:50 INFO: Shutdown signal received
2025-06-24 16:01:50 INFO: SSHServerController: Stopping server
2025-06-24 16:01:50 INFO: SSHServerModel: Stopping server
2025-06-24 16:01:56 INFO: Logger initialized: logs/server.log
2025-06-24 16:01:56 INFO: SSHServerModel: Created new model instance
2025-06-24 16:01:56 INFO: SSH Server Starting
2025-06-24 16:01:56 INFO: Log file: logs/server.log
2025-06-24 16:01:56 INFO: SSHServerController: Starting server
2025-06-24 16:02:05 INFO: SSHServerModel: Starting server
2025-06-24 16:02:13 INFO: Server: Starting client connection handler for 127.0.0.1:51988
2025-06-24 16:02:13 INFO: Server: Initializing protocol handler
2025-06-24 16:02:13 INFO: Server: Protocol handler initialized
2025-06-24 16:02:13 INFO: Server: Starting key exchange
2025-06-24 16:02:14 INFO: Server: Received key exchange init from null
2025-06-24 16:02:14 INFO: Server: Received key exchange init from null
2025-06-24 16:02:14 INFO: Server: Initializing DH key exchange
2025-06-24 16:02:14 INFO: Server: Generated DH key pair
2025-06-24 16:02:14 INFO: Server: Set client's public key
2025-06-24 16:02:14 INFO: Server: Computing shared secret
2025-06-24 16:02:14 INFO: Server: Computed shared secret, length: 256
2025-06-24 16:02:14 INFO: Server: Initializing symmetric encryption
2025-06-24 16:02:14 INFO: Server: Initialized symmetric encryption
2025-06-24 16:02:14 INFO: Server: Creating key exchange reply message
2025-06-24 16:02:14 INFO: Server: Created reply message, signing DH public key
2025-06-24 16:02:14 INFO: Server: Starting RSA signature generation
2025-06-24 16:02:14 INFO: Server: RSA signature generated, length: 256
2025-06-24 16:02:14 INFO: Server: Sending key exchange reply
2025-06-24 16:02:14 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-24 16:02:14 INFO: Message sent successfully
2025-06-24 16:02:14 INFO: Server: Key exchange reply sent successfully
2025-06-24 16:02:14 INFO: Server: Key exchange completed successfully
2025-06-24 16:02:14 INFO: Server: Enabling encryption
2025-06-24 16:02:14 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-24 16:02:14 INFO: Encryption and HMAC enabled in protocol handler
2025-06-24 16:02:14 INFO: Server: Key exchange completed successfully
2025-06-24 16:02:14 INFO: Server: Starting authentication
2025-06-24 16:02:14 INFO: Waiting to receive message...
2025-06-24 16:02:14 INFO: Reading encrypted message...
2025-06-24 16:02:14 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:02:14 INFO: Encrypted message length: 1012
2025-06-24 16:02:14 INFO: Read 1012 bytes for encrypted message body
2025-06-24 16:02:14 INFO: Decrypting encrypted message, length: 1012
2025-06-24 16:02:14 INFO: Message decrypted successfully, new length: 984
2025-06-24 16:02:14 INFO: Received message: AUTH_REQUEST
2025-06-24 16:02:14 INFO: Server: Authentication request from hey3 using dual
2025-06-24 16:02:14 INFO: Authentication attempt for user: hey3, type: dual
2025-06-24 16:02:14 INFO: User existence check for 'hey3': true
2025-06-24 16:02:14 INFO: User validation passed for: hey3
2025-06-24 16:02:14 INFO: Attempting dual authentication (password + public key) for: hey3
2025-06-24 16:02:14 INFO: DualAuth: password present: true
2025-06-24 16:02:14 INFO: DualAuth: publicKey present: true
2025-06-24 16:02:14 INFO: DualAuth: signature present: true
2025-06-24 16:02:14 INFO: DualAuth: sessionData present: true
2025-06-24 16:02:14 INFO: PasswordAuth: Verifying password for user: hey3
2025-06-24 16:02:14 INFO: PasswordAuth: Checking if user exists: hey3
2025-06-24 16:02:14 INFO: PasswordAuth: User exists, verifying password for: hey3
2025-06-24 16:02:14 INFO: UserStore: Password verification for hey3 - Stored hash: fa690b82061edfd2852629aeba8a8977b57e40fcb77d1a7a28b26cba62591204, Input hash: fa690b82061edfd2852629aeba8a8977b57e40fcb77d1a7a28b26cba62591204, Matches: true
2025-06-24 16:02:14 INFO: PasswordAuth: Password verification result for hey3: true
2025-06-24 16:02:14 INFO: PasswordAuth: Password authentication result for hey3: true
2025-06-24 16:02:14 INFO: DualAuth: Password authentication succeeded for user: hey3
2025-06-24 16:02:14 INFO: PublicKeyAuth: publicKey present: true
2025-06-24 16:02:14 INFO: PublicKeyAuth: signature present: true
2025-06-24 16:02:14 INFO: PublicKeyAuth: sessionData present: true
2025-06-24 16:02:14 INFO: PublicKeyAuth: Created public key from string
2025-06-24 16:02:14 INFO: PublicKeyAuth: Decoded signature, length: 256
2025-06-24 16:02:14 INFO: PublicKeyAuth: Decoded session data, length: 36
2025-06-24 16:02:14 INFO: PublicKeyAuth: Found 1 authorized keys for user: hey3
2025-06-24 16:02:14 INFO: PublicKeyAuth: Key match found!
2025-06-24 16:02:14 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 16:02:14 INFO: PublicKeyAuth: public key auth result: true
2025-06-24 16:02:14 INFO: DualAuth: Public key authentication succeeded for user: hey3
2025-06-24 16:02:14 INFO: DualAuth: Dual authentication successful for user: hey3
2025-06-24 16:02:14 INFO: Sending message: AUTH_SUCCESS, length: 269
2025-06-24 16:02:14 INFO: Message encrypted, new length: 297
2025-06-24 16:02:14 INFO: Added length prefix for encrypted message, total length: 301
2025-06-24 16:02:14 INFO: Message sent successfully
2025-06-24 16:02:14 INFO: Server: Authentication SUCCESS for hey3: Authentication successful
2025-06-24 16:02:14 INFO: Server: Authentication completed successfully
2025-06-24 16:02:14 INFO: Server: Starting service request handling
2025-06-24 16:02:14 INFO: Waiting to receive message...
2025-06-24 16:02:14 INFO: Reading encrypted message...
2025-06-24 16:02:16 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:02:16 INFO: Encrypted message length: 186
2025-06-24 16:02:16 INFO: Read 186 bytes for encrypted message body
2025-06-24 16:02:16 INFO: Decrypting encrypted message, length: 186
2025-06-24 16:02:16 INFO: Message decrypted successfully, new length: 158
2025-06-24 16:02:16 INFO: Received message: SERVICE_REQUEST
2025-06-24 16:02:16 INFO: Server: Service request from hey3 for shell
2025-06-24 16:02:16 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-24 16:02:16 INFO: Message encrypted, new length: 185
2025-06-24 16:02:16 INFO: Added length prefix for encrypted message, total length: 189
2025-06-24 16:02:16 INFO: Message sent successfully
2025-06-24 16:02:16 INFO: Server: Service shell accepted for hey3
2025-06-24 16:02:16 INFO: Waiting to receive message...
2025-06-24 16:02:16 INFO: Reading encrypted message...
2025-06-24 16:02:19 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:02:19 INFO: Encrypted message length: 255
2025-06-24 16:02:19 INFO: Read 255 bytes for encrypted message body
2025-06-24 16:02:19 INFO: Decrypting encrypted message, length: 255
2025-06-24 16:02:19 INFO: Message decrypted successfully, new length: 227
2025-06-24 16:02:19 INFO: Received message: SHELL_COMMAND
2025-06-24 16:02:19 INFO: Server: Executing shell command: 'ls' for user: hey3
2025-06-24 16:02:19 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-24 16:02:19 INFO: Sending message: SHELL_RESULT, length: 346
2025-06-24 16:02:19 INFO: Message encrypted, new length: 374
2025-06-24 16:02:19 INFO: Added length prefix for encrypted message, total length: 378
2025-06-24 16:02:19 INFO: Message sent successfully
2025-06-24 16:02:19 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:02:19 INFO: Waiting to receive message...
2025-06-24 16:02:19 INFO: Reading encrypted message...
2025-06-24 16:02:22 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:02:22 INFO: Encrypted message length: 258
2025-06-24 16:02:22 INFO: Read 258 bytes for encrypted message body
2025-06-24 16:02:22 INFO: Decrypting encrypted message, length: 258
2025-06-24 16:02:22 INFO: Message decrypted successfully, new length: 230
2025-06-24 16:02:22 INFO: Received message: SHELL_COMMAND
2025-06-24 16:02:22 INFO: Server: Executing shell command: 'cd ..' for user: hey3
2025-06-24 16:02:22 INFO: Command result: exitCode=0, stdout='', stderr=''
2025-06-24 16:02:22 INFO: Sending message: SHELL_RESULT, length: 215
2025-06-24 16:02:22 INFO: Message encrypted, new length: 243
2025-06-24 16:02:22 INFO: Added length prefix for encrypted message, total length: 247
2025-06-24 16:02:22 INFO: Message sent successfully
2025-06-24 16:02:22 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:02:22 INFO: Waiting to receive message...
2025-06-24 16:02:22 INFO: Reading encrypted message...
2025-06-24 16:02:27 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:02:27 INFO: Encrypted message length: 69
2025-06-24 16:02:27 INFO: Read 69 bytes for encrypted message body
2025-06-24 16:02:27 INFO: Decrypting encrypted message, length: 69
2025-06-24 16:02:27 INFO: Message decrypted successfully, new length: 41
2025-06-24 16:02:27 INFO: Received message: DISCONNECT
2025-06-24 16:02:27 INFO: Server: Client 127.0.0.1:51988 disconnected cleanly.
2025-06-24 16:02:27 INFO: Server: Cleaning up client connection for 127.0.0.1:51988
2025-06-24 16:02:27 INFO: Server: Cleaning up connection for 127.0.0.1:51988 (user: hey3)
2025-06-24 16:02:27 INFO: Protocol handler closed
2025-06-24 16:04:13 INFO: Server: Starting client connection handler for 127.0.0.1:52012
2025-06-24 16:04:13 INFO: Server: Initializing protocol handler
2025-06-24 16:04:13 INFO: Server: Protocol handler initialized
2025-06-24 16:04:13 INFO: Server: Starting key exchange
2025-06-24 16:04:14 INFO: Server: Received key exchange init from null
2025-06-24 16:04:14 INFO: Server: Received key exchange init from null
2025-06-24 16:04:14 INFO: Server: Initializing DH key exchange
2025-06-24 16:04:14 INFO: Server: Generated DH key pair
2025-06-24 16:04:14 INFO: Server: Set client's public key
2025-06-24 16:04:14 INFO: Server: Computing shared secret
2025-06-24 16:04:14 INFO: Server: Computed shared secret, length: 256
2025-06-24 16:04:14 INFO: Server: Initializing symmetric encryption
2025-06-24 16:04:14 INFO: Server: Initialized symmetric encryption
2025-06-24 16:04:14 INFO: Server: Creating key exchange reply message
2025-06-24 16:04:14 INFO: Server: Created reply message, signing DH public key
2025-06-24 16:04:14 INFO: Server: Starting RSA signature generation
2025-06-24 16:04:14 INFO: Server: RSA signature generated, length: 256
2025-06-24 16:04:14 INFO: Server: Sending key exchange reply
2025-06-24 16:04:14 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-24 16:04:14 INFO: Message sent successfully
2025-06-24 16:04:14 INFO: Server: Key exchange reply sent successfully
2025-06-24 16:04:14 INFO: Server: Key exchange completed successfully
2025-06-24 16:04:14 INFO: Server: Enabling encryption
2025-06-24 16:04:14 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-24 16:04:14 INFO: Encryption and HMAC enabled in protocol handler
2025-06-24 16:04:14 INFO: Server: Key exchange completed successfully
2025-06-24 16:04:14 INFO: Server: Starting authentication
2025-06-24 16:04:14 INFO: Waiting to receive message...
2025-06-24 16:04:14 INFO: Reading encrypted message...
2025-06-24 16:04:14 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:04:14 INFO: Encrypted message length: 1012
2025-06-24 16:04:14 INFO: Read 1012 bytes for encrypted message body
2025-06-24 16:04:14 INFO: Decrypting encrypted message, length: 1012
2025-06-24 16:04:14 INFO: Message decrypted successfully, new length: 984
2025-06-24 16:04:14 INFO: Received message: AUTH_REQUEST
2025-06-24 16:04:14 INFO: Server: Authentication request from hey3 using dual
2025-06-24 16:04:14 INFO: Authentication attempt for user: hey3, type: dual
2025-06-24 16:04:14 INFO: User existence check for 'hey3': true
2025-06-24 16:04:14 INFO: User validation passed for: hey3
2025-06-24 16:04:14 INFO: Attempting dual authentication (password + public key) for: hey3
2025-06-24 16:04:14 INFO: DualAuth: password present: true
2025-06-24 16:04:14 INFO: DualAuth: publicKey present: true
2025-06-24 16:04:14 INFO: DualAuth: signature present: true
2025-06-24 16:04:14 INFO: DualAuth: sessionData present: true
2025-06-24 16:04:14 INFO: PasswordAuth: Verifying password for user: hey3
2025-06-24 16:04:14 INFO: PasswordAuth: Checking if user exists: hey3
2025-06-24 16:04:14 INFO: PasswordAuth: User exists, verifying password for: hey3
2025-06-24 16:04:14 INFO: UserStore: Password verification for hey3 - Stored hash: fa690b82061edfd2852629aeba8a8977b57e40fcb77d1a7a28b26cba62591204, Input hash: fa690b82061edfd2852629aeba8a8977b57e40fcb77d1a7a28b26cba62591204, Matches: true
2025-06-24 16:04:14 INFO: PasswordAuth: Password verification result for hey3: true
2025-06-24 16:04:14 INFO: PasswordAuth: Password authentication result for hey3: true
2025-06-24 16:04:14 INFO: DualAuth: Password authentication succeeded for user: hey3
2025-06-24 16:04:14 INFO: PublicKeyAuth: publicKey present: true
2025-06-24 16:04:14 INFO: PublicKeyAuth: signature present: true
2025-06-24 16:04:14 INFO: PublicKeyAuth: sessionData present: true
2025-06-24 16:04:14 INFO: PublicKeyAuth: Created public key from string
2025-06-24 16:04:14 INFO: PublicKeyAuth: Decoded signature, length: 256
2025-06-24 16:04:14 INFO: PublicKeyAuth: Decoded session data, length: 36
2025-06-24 16:04:14 INFO: PublicKeyAuth: Found 1 authorized keys for user: hey3
2025-06-24 16:04:14 INFO: PublicKeyAuth: Key match found!
2025-06-24 16:04:14 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 16:04:14 INFO: PublicKeyAuth: public key auth result: true
2025-06-24 16:04:14 INFO: DualAuth: Public key authentication succeeded for user: hey3
2025-06-24 16:04:14 INFO: DualAuth: Dual authentication successful for user: hey3
2025-06-24 16:04:14 INFO: Sending message: AUTH_SUCCESS, length: 269
2025-06-24 16:04:14 INFO: Message encrypted, new length: 297
2025-06-24 16:04:14 INFO: Added length prefix for encrypted message, total length: 301
2025-06-24 16:04:14 INFO: Message sent successfully
2025-06-24 16:04:14 INFO: Server: Authentication SUCCESS for hey3: Authentication successful
2025-06-24 16:04:14 INFO: Server: Authentication completed successfully
2025-06-24 16:04:14 INFO: Server: Starting service request handling
2025-06-24 16:04:14 INFO: Waiting to receive message...
2025-06-24 16:04:14 INFO: Reading encrypted message...
2025-06-24 16:04:19 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:04:19 INFO: Encrypted message length: 186
2025-06-24 16:04:19 INFO: Read 186 bytes for encrypted message body
2025-06-24 16:04:19 INFO: Decrypting encrypted message, length: 186
2025-06-24 16:04:19 INFO: Message decrypted successfully, new length: 158
2025-06-24 16:04:19 INFO: Received message: SERVICE_REQUEST
2025-06-24 16:04:19 INFO: Server: Service request from hey3 for shell
2025-06-24 16:04:19 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-24 16:04:19 INFO: Message encrypted, new length: 185
2025-06-24 16:04:19 INFO: Added length prefix for encrypted message, total length: 189
2025-06-24 16:04:19 INFO: Message sent successfully
2025-06-24 16:04:19 INFO: Server: Service shell accepted for hey3
2025-06-24 16:04:19 INFO: Waiting to receive message...
2025-06-24 16:04:19 INFO: Reading encrypted message...
2025-06-24 16:04:21 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:04:21 INFO: Encrypted message length: 256
2025-06-24 16:04:21 INFO: Read 256 bytes for encrypted message body
2025-06-24 16:04:21 INFO: Decrypting encrypted message, length: 256
2025-06-24 16:04:21 INFO: Message decrypted successfully, new length: 228
2025-06-24 16:04:21 INFO: Received message: SHELL_COMMAND
2025-06-24 16:04:21 INFO: Server: Executing shell command: 'ls ' for user: hey3
2025-06-24 16:04:21 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-24 16:04:21 INFO: Sending message: SHELL_RESULT, length: 346
2025-06-24 16:04:21 INFO: Message encrypted, new length: 374
2025-06-24 16:04:21 INFO: Added length prefix for encrypted message, total length: 378
2025-06-24 16:04:21 INFO: Message sent successfully
2025-06-24 16:04:21 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:04:21 INFO: Waiting to receive message...
2025-06-24 16:04:21 INFO: Reading encrypted message...
2025-06-24 16:06:08 INFO: Shutdown signal received
2025-06-24 16:06:08 INFO: SSHServerController: Stopping server
2025-06-24 16:06:08 INFO: SSHServerModel: Stopping server
2025-06-24 16:06:17 INFO: Logger initialized: logs/server.log
2025-06-24 16:06:17 INFO: SSHServerModel: Created new model instance
2025-06-24 16:06:17 INFO: SSH Server Starting
2025-06-24 16:06:17 INFO: Log file: logs/server.log
2025-06-24 16:06:17 INFO: SSHServerController: Starting server
2025-06-24 16:06:20 INFO: SSHServerModel: Starting server
2025-06-24 16:06:44 INFO: Server: Starting client connection handler for 127.0.0.1:52106
2025-06-24 16:06:44 INFO: Server: Initializing protocol handler
2025-06-24 16:06:44 INFO: Server: Protocol handler initialized
2025-06-24 16:06:44 INFO: Server: Starting key exchange
2025-06-24 16:06:44 INFO: Server: Received key exchange init from null
2025-06-24 16:06:44 INFO: Server: Received key exchange init from null
2025-06-24 16:06:44 INFO: Server: Initializing DH key exchange
2025-06-24 16:06:44 INFO: Server: Generated DH key pair
2025-06-24 16:06:44 INFO: Server: Set client's public key
2025-06-24 16:06:44 INFO: Server: Computing shared secret
2025-06-24 16:06:44 INFO: Server: Computed shared secret, length: 256
2025-06-24 16:06:44 INFO: Server: Initializing symmetric encryption
2025-06-24 16:06:44 INFO: Server: Initialized symmetric encryption
2025-06-24 16:06:44 INFO: Server: Creating key exchange reply message
2025-06-24 16:06:44 INFO: Server: Created reply message, signing DH public key
2025-06-24 16:06:44 INFO: Server: Starting RSA signature generation
2025-06-24 16:06:44 INFO: Server: RSA signature generated, length: 256
2025-06-24 16:06:44 INFO: Server: Sending key exchange reply
2025-06-24 16:06:44 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-24 16:06:44 INFO: Message sent successfully
2025-06-24 16:06:44 INFO: Server: Key exchange reply sent successfully
2025-06-24 16:06:44 INFO: Server: Key exchange completed successfully
2025-06-24 16:06:44 INFO: Server: Enabling encryption
2025-06-24 16:06:44 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-24 16:06:44 INFO: Encryption and HMAC enabled in protocol handler
2025-06-24 16:06:44 INFO: Server: Key exchange completed successfully
2025-06-24 16:06:44 INFO: Server: Starting authentication
2025-06-24 16:06:44 INFO: Waiting to receive message...
2025-06-24 16:06:44 INFO: Reading encrypted message...
2025-06-24 16:06:44 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:06:44 INFO: Encrypted message length: 1015
2025-06-24 16:06:44 INFO: Read 1015 bytes for encrypted message body
2025-06-24 16:06:44 INFO: Decrypting encrypted message, length: 1015
2025-06-24 16:06:44 INFO: Message decrypted successfully, new length: 987
2025-06-24 16:06:44 INFO: Received message: AUTH_REQUEST
2025-06-24 16:06:44 INFO: Server: Authentication request from admin using dual
2025-06-24 16:06:44 INFO: Authentication attempt for user: admin, type: dual
2025-06-24 16:06:44 INFO: User existence check for 'admin': true
2025-06-24 16:06:44 INFO: User validation passed for: admin
2025-06-24 16:06:44 INFO: Attempting dual authentication (password + public key) for: admin
2025-06-24 16:06:44 INFO: DualAuth: password present: true
2025-06-24 16:06:44 INFO: DualAuth: publicKey present: true
2025-06-24 16:06:44 INFO: DualAuth: signature present: true
2025-06-24 16:06:44 INFO: DualAuth: sessionData present: true
2025-06-24 16:06:44 INFO: PasswordAuth: Verifying password for user: admin
2025-06-24 16:06:44 INFO: PasswordAuth: Checking if user exists: admin
2025-06-24 16:06:44 INFO: PasswordAuth: User exists, verifying password for: admin
2025-06-24 16:06:44 INFO: UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
2025-06-24 16:06:44 INFO: PasswordAuth: Password verification result for admin: true
2025-06-24 16:06:44 INFO: PasswordAuth: Password authentication result for admin: true
2025-06-24 16:06:44 INFO: DualAuth: Password authentication succeeded for user: admin
2025-06-24 16:06:44 INFO: PublicKeyAuth: publicKey present: true
2025-06-24 16:06:44 INFO: PublicKeyAuth: signature present: true
2025-06-24 16:06:44 INFO: PublicKeyAuth: sessionData present: true
2025-06-24 16:06:44 INFO: PublicKeyAuth: Created public key from string
2025-06-24 16:06:44 INFO: PublicKeyAuth: Decoded signature, length: 256
2025-06-24 16:06:44 INFO: PublicKeyAuth: Decoded session data, length: 36
2025-06-24 16:06:44 INFO: PublicKeyAuth: Found 4 authorized keys for user: admin
2025-06-24 16:06:44 INFO: PublicKeyAuth: Key match found!
2025-06-24 16:06:44 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 16:06:44 INFO: PublicKeyAuth: public key auth result: true
2025-06-24 16:06:44 INFO: DualAuth: Public key authentication succeeded for user: admin
2025-06-24 16:06:44 INFO: DualAuth: Dual authentication successful for user: admin
2025-06-24 16:06:44 INFO: Sending message: AUTH_SUCCESS, length: 269
2025-06-24 16:06:44 INFO: Message encrypted, new length: 297
2025-06-24 16:06:44 INFO: Added length prefix for encrypted message, total length: 301
2025-06-24 16:06:44 INFO: Message sent successfully
2025-06-24 16:06:44 INFO: Server: Authentication SUCCESS for admin: Authentication successful
2025-06-24 16:06:44 INFO: Server: Authentication completed successfully
2025-06-24 16:06:44 INFO: Server: Starting service request handling
2025-06-24 16:06:44 INFO: Waiting to receive message...
2025-06-24 16:06:44 INFO: Reading encrypted message...
2025-06-24 16:06:47 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:06:47 INFO: Encrypted message length: 186
2025-06-24 16:06:47 INFO: Read 186 bytes for encrypted message body
2025-06-24 16:06:47 INFO: Decrypting encrypted message, length: 186
2025-06-24 16:06:47 INFO: Message decrypted successfully, new length: 158
2025-06-24 16:06:47 INFO: Received message: SERVICE_REQUEST
2025-06-24 16:06:47 INFO: Server: Service request from admin for shell
2025-06-24 16:06:47 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-24 16:06:47 INFO: Message encrypted, new length: 185
2025-06-24 16:06:47 INFO: Added length prefix for encrypted message, total length: 189
2025-06-24 16:06:47 INFO: Message sent successfully
2025-06-24 16:06:47 INFO: Server: Service shell accepted for admin
2025-06-24 16:06:47 INFO: Waiting to receive message...
2025-06-24 16:06:47 INFO: Reading encrypted message...
2025-06-24 16:16:37 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:16:37 INFO: Encrypted message length: 186
2025-06-24 16:16:37 INFO: Read 186 bytes for encrypted message body
2025-06-24 16:16:37 INFO: Decrypting encrypted message, length: 186
2025-06-24 16:16:37 INFO: Message decrypted successfully, new length: 158
2025-06-24 16:16:37 INFO: Received message: SERVICE_REQUEST
2025-06-24 16:16:37 INFO: Server: Service request from admin for shell
2025-06-24 16:16:37 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-24 16:16:37 INFO: Message encrypted, new length: 185
2025-06-24 16:16:37 INFO: Added length prefix for encrypted message, total length: 189
2025-06-24 16:16:37 INFO: Message sent successfully
2025-06-24 16:16:37 INFO: Server: Service shell accepted for admin
2025-06-24 16:16:37 INFO: Waiting to receive message...
2025-06-24 16:16:37 INFO: Reading encrypted message...
2025-06-24 16:16:41 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:16:41 INFO: Encrypted message length: 69
2025-06-24 16:16:41 INFO: Read 69 bytes for encrypted message body
2025-06-24 16:16:41 INFO: Decrypting encrypted message, length: 69
2025-06-24 16:16:41 INFO: Message decrypted successfully, new length: 41
2025-06-24 16:16:41 INFO: Received message: DISCONNECT
2025-06-24 16:16:41 INFO: Server: Client 127.0.0.1:52106 disconnected cleanly.
2025-06-24 16:16:41 INFO: Server: Cleaning up client connection for 127.0.0.1:52106
2025-06-24 16:16:41 INFO: Server: Cleaning up connection for 127.0.0.1:52106 (user: admin)
2025-06-24 16:16:41 INFO: Protocol handler closed
2025-06-24 16:17:02 INFO: Server: Starting client connection handler for 127.0.0.1:52168
2025-06-24 16:17:02 INFO: Server: Initializing protocol handler
2025-06-24 16:17:02 INFO: Server: Protocol handler initialized
2025-06-24 16:17:02 INFO: Server: Starting key exchange
2025-06-24 16:17:03 INFO: Server: Received key exchange init from null
2025-06-24 16:17:03 INFO: Server: Received key exchange init from null
2025-06-24 16:17:03 INFO: Server: Initializing DH key exchange
2025-06-24 16:17:03 INFO: Server: Generated DH key pair
2025-06-24 16:17:03 INFO: Server: Set client's public key
2025-06-24 16:17:03 INFO: Server: Computing shared secret
2025-06-24 16:17:03 INFO: Server: Computed shared secret, length: 256
2025-06-24 16:17:03 INFO: Server: Initializing symmetric encryption
2025-06-24 16:17:03 INFO: Server: Initialized symmetric encryption
2025-06-24 16:17:03 INFO: Server: Creating key exchange reply message
2025-06-24 16:17:03 INFO: Server: Created reply message, signing DH public key
2025-06-24 16:17:03 INFO: Server: Starting RSA signature generation
2025-06-24 16:17:03 INFO: Server: RSA signature generated, length: 256
2025-06-24 16:17:03 INFO: Server: Sending key exchange reply
2025-06-24 16:17:03 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-24 16:17:03 INFO: Message sent successfully
2025-06-24 16:17:03 INFO: Server: Key exchange reply sent successfully
2025-06-24 16:17:03 INFO: Server: Key exchange completed successfully
2025-06-24 16:17:03 INFO: Server: Enabling encryption
2025-06-24 16:17:03 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-24 16:17:03 INFO: Encryption and HMAC enabled in protocol handler
2025-06-24 16:17:03 INFO: Server: Key exchange completed successfully
2025-06-24 16:17:03 INFO: Server: Starting authentication
2025-06-24 16:17:03 INFO: Waiting to receive message...
2025-06-24 16:17:03 INFO: Reading encrypted message...
2025-06-24 16:17:03 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:03 INFO: Encrypted message length: 1014
2025-06-24 16:17:03 INFO: Read 1014 bytes for encrypted message body
2025-06-24 16:17:03 INFO: Decrypting encrypted message, length: 1014
2025-06-24 16:17:03 INFO: Message decrypted successfully, new length: 986
2025-06-24 16:17:03 INFO: Received message: AUTH_REQUEST
2025-06-24 16:17:03 INFO: Server: Authentication request from tilman using dual
2025-06-24 16:17:03 INFO: Authentication attempt for user: tilman, type: dual
2025-06-24 16:17:03 INFO: User existence check for 'tilman': true
2025-06-24 16:17:03 INFO: User validation passed for: tilman
2025-06-24 16:17:03 INFO: Attempting dual authentication (password + public key) for: tilman
2025-06-24 16:17:03 INFO: DualAuth: password present: true
2025-06-24 16:17:03 INFO: DualAuth: publicKey present: true
2025-06-24 16:17:03 INFO: DualAuth: signature present: true
2025-06-24 16:17:03 INFO: DualAuth: sessionData present: true
2025-06-24 16:17:03 INFO: PasswordAuth: Verifying password for user: tilman
2025-06-24 16:17:03 INFO: PasswordAuth: Checking if user exists: tilman
2025-06-24 16:17:03 INFO: PasswordAuth: User exists, verifying password for: tilman
2025-06-24 16:17:03 INFO: UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
2025-06-24 16:17:03 INFO: PasswordAuth: Password verification result for tilman: true
2025-06-24 16:17:03 INFO: PasswordAuth: Password authentication result for tilman: true
2025-06-24 16:17:03 INFO: DualAuth: Password authentication succeeded for user: tilman
2025-06-24 16:17:03 INFO: PublicKeyAuth: publicKey present: true
2025-06-24 16:17:03 INFO: PublicKeyAuth: signature present: true
2025-06-24 16:17:03 INFO: PublicKeyAuth: sessionData present: true
2025-06-24 16:17:03 INFO: PublicKeyAuth: Created public key from string
2025-06-24 16:17:03 INFO: PublicKeyAuth: Decoded signature, length: 256
2025-06-24 16:17:03 INFO: PublicKeyAuth: Decoded session data, length: 36
2025-06-24 16:17:03 INFO: PublicKeyAuth: Found 1 authorized keys for user: tilman
2025-06-24 16:17:03 INFO: PublicKeyAuth: Key match found!
2025-06-24 16:17:03 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 16:17:03 INFO: PublicKeyAuth: public key auth result: true
2025-06-24 16:17:03 INFO: DualAuth: Public key authentication succeeded for user: tilman
2025-06-24 16:17:03 INFO: DualAuth: Dual authentication successful for user: tilman
2025-06-24 16:17:03 INFO: Sending message: AUTH_SUCCESS, length: 269
2025-06-24 16:17:03 INFO: Message encrypted, new length: 297
2025-06-24 16:17:03 INFO: Added length prefix for encrypted message, total length: 301
2025-06-24 16:17:03 INFO: Message sent successfully
2025-06-24 16:17:03 INFO: Server: Authentication SUCCESS for tilman: Authentication successful
2025-06-24 16:17:03 INFO: Server: Authentication completed successfully
2025-06-24 16:17:03 INFO: Server: Starting service request handling
2025-06-24 16:17:03 INFO: Waiting to receive message...
2025-06-24 16:17:03 INFO: Reading encrypted message...
2025-06-24 16:17:03 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:03 INFO: Encrypted message length: 186
2025-06-24 16:17:03 INFO: Read 186 bytes for encrypted message body
2025-06-24 16:17:03 INFO: Decrypting encrypted message, length: 186
2025-06-24 16:17:03 INFO: Message decrypted successfully, new length: 158
2025-06-24 16:17:03 INFO: Received message: SERVICE_REQUEST
2025-06-24 16:17:03 INFO: Server: Service request from tilman for shell
2025-06-24 16:17:03 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-24 16:17:03 INFO: Message encrypted, new length: 185
2025-06-24 16:17:03 INFO: Added length prefix for encrypted message, total length: 189
2025-06-24 16:17:03 INFO: Message sent successfully
2025-06-24 16:17:03 INFO: Server: Service shell accepted for tilman
2025-06-24 16:17:03 INFO: Waiting to receive message...
2025-06-24 16:17:03 INFO: Reading encrypted message...
2025-06-24 16:17:37 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:37 INFO: Encrypted message length: 258
2025-06-24 16:17:37 INFO: Read 258 bytes for encrypted message body
2025-06-24 16:17:37 INFO: Decrypting encrypted message, length: 258
2025-06-24 16:17:37 INFO: Message decrypted successfully, new length: 230
2025-06-24 16:17:37 INFO: Received message: SHELL_COMMAND
2025-06-24 16:17:37 INFO: Server: Executing shell command: 'cd ..' for user: tilman
2025-06-24 16:17:37 INFO: Command result: exitCode=0, stdout='', stderr=''
2025-06-24 16:17:37 INFO: Sending message: SHELL_RESULT, length: 215
2025-06-24 16:17:37 INFO: Message encrypted, new length: 243
2025-06-24 16:17:37 INFO: Added length prefix for encrypted message, total length: 247
2025-06-24 16:17:37 INFO: Message sent successfully
2025-06-24 16:17:37 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:17:37 INFO: Waiting to receive message...
2025-06-24 16:17:37 INFO: Reading encrypted message...
2025-06-24 16:17:40 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:40 INFO: Encrypted message length: 248
2025-06-24 16:17:40 INFO: Read 248 bytes for encrypted message body
2025-06-24 16:17:40 INFO: Decrypting encrypted message, length: 248
2025-06-24 16:17:40 INFO: Message decrypted successfully, new length: 220
2025-06-24 16:17:40 INFO: Received message: SHELL_COMMAND
2025-06-24 16:17:40 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 16:17:40 INFO: Command result: exitCode=0, stdout='Shared
tilman
', stderr=''
2025-06-24 16:17:40 INFO: Sending message: SHELL_RESULT, length: 231
2025-06-24 16:17:40 INFO: Message encrypted, new length: 259
2025-06-24 16:17:40 INFO: Added length prefix for encrypted message, total length: 263
2025-06-24 16:17:40 INFO: Message sent successfully
2025-06-24 16:17:40 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:17:40 INFO: Waiting to receive message...
2025-06-24 16:17:40 INFO: Reading encrypted message...
2025-06-24 16:17:43 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:43 INFO: Encrypted message length: 251
2025-06-24 16:17:43 INFO: Read 251 bytes for encrypted message body
2025-06-24 16:17:43 INFO: Decrypting encrypted message, length: 251
2025-06-24 16:17:43 INFO: Message decrypted successfully, new length: 223
2025-06-24 16:17:43 INFO: Received message: SHELL_COMMAND
2025-06-24 16:17:43 INFO: Server: Executing shell command: 'cd ..' for user: tilman
2025-06-24 16:17:43 INFO: Command result: exitCode=0, stdout='', stderr=''
2025-06-24 16:17:43 INFO: Sending message: SHELL_RESULT, length: 210
2025-06-24 16:17:43 INFO: Message encrypted, new length: 238
2025-06-24 16:17:43 INFO: Added length prefix for encrypted message, total length: 242
2025-06-24 16:17:43 INFO: Message sent successfully
2025-06-24 16:17:43 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:17:43 INFO: Waiting to receive message...
2025-06-24 16:17:43 INFO: Reading encrypted message...
2025-06-24 16:17:44 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:44 INFO: Encrypted message length: 243
2025-06-24 16:17:44 INFO: Read 243 bytes for encrypted message body
2025-06-24 16:17:44 INFO: Decrypting encrypted message, length: 243
2025-06-24 16:17:44 INFO: Message decrypted successfully, new length: 215
2025-06-24 16:17:44 INFO: Received message: SHELL_COMMAND
2025-06-24 16:17:44 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 16:17:44 INFO: Command result: exitCode=0, stdout='Applications
bin
cores
dev
etc
home
Library
opt
private
sbin
System
tmp
Users
usr
var
Volumes
', stderr=''
2025-06-24 16:17:44 INFO: Sending message: SHELL_RESULT, length: 320
2025-06-24 16:17:44 INFO: Message encrypted, new length: 348
2025-06-24 16:17:44 INFO: Added length prefix for encrypted message, total length: 352
2025-06-24 16:17:44 INFO: Message sent successfully
2025-06-24 16:17:44 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:17:44 INFO: Waiting to receive message...
2025-06-24 16:17:44 INFO: Reading encrypted message...
2025-06-24 16:17:57 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:57 INFO: Encrypted message length: 250
2025-06-24 16:17:57 INFO: Read 250 bytes for encrypted message body
2025-06-24 16:17:57 INFO: Decrypting encrypted message, length: 250
2025-06-24 16:17:57 INFO: Message decrypted successfully, new length: 222
2025-06-24 16:17:57 INFO: Received message: SHELL_COMMAND
2025-06-24 16:17:57 INFO: Server: Executing shell command: 'cd System' for user: tilman
2025-06-24 16:17:57 INFO: Command result: exitCode=0, stdout='', stderr=''
2025-06-24 16:17:57 INFO: Sending message: SHELL_RESULT, length: 216
2025-06-24 16:17:57 INFO: Message encrypted, new length: 244
2025-06-24 16:17:57 INFO: Added length prefix for encrypted message, total length: 248
2025-06-24 16:17:57 INFO: Message sent successfully
2025-06-24 16:17:57 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:17:57 INFO: Waiting to receive message...
2025-06-24 16:17:57 INFO: Reading encrypted message...
2025-06-24 16:17:58 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:17:58 INFO: Encrypted message length: 249
2025-06-24 16:17:58 INFO: Read 249 bytes for encrypted message body
2025-06-24 16:17:58 INFO: Decrypting encrypted message, length: 249
2025-06-24 16:17:58 INFO: Message decrypted successfully, new length: 221
2025-06-24 16:17:58 INFO: Received message: SHELL_COMMAND
2025-06-24 16:17:58 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 16:17:58 INFO: Command result: exitCode=0, stdout='Applications
Cryptexes
Developer
DriverKit
iOSSupport
Library
Volumes
', stderr=''
2025-06-24 16:17:58 INFO: Sending message: SHELL_RESULT, length: 293
2025-06-24 16:17:58 INFO: Message encrypted, new length: 321
2025-06-24 16:17:58 INFO: Added length prefix for encrypted message, total length: 325
2025-06-24 16:17:58 INFO: Message sent successfully
2025-06-24 16:17:58 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:17:58 INFO: Waiting to receive message...
2025-06-24 16:17:58 INFO: Reading encrypted message...
2025-06-24 16:18:10 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:18:10 INFO: Encrypted message length: 263
2025-06-24 16:18:10 INFO: Read 263 bytes for encrypted message body
2025-06-24 16:18:10 INFO: Decrypting encrypted message, length: 263
2025-06-24 16:18:10 INFO: Message decrypted successfully, new length: 235
2025-06-24 16:18:10 INFO: Received message: SHELL_COMMAND
2025-06-24 16:18:10 INFO: Server: Executing shell command: 'cd /Users/Tilman' for user: tilman
2025-06-24 16:18:10 INFO: Command result: exitCode=0, stdout='', stderr=''
2025-06-24 16:18:10 INFO: Sending message: SHELL_RESULT, length: 222
2025-06-24 16:18:10 INFO: Message encrypted, new length: 250
2025-06-24 16:18:10 INFO: Added length prefix for encrypted message, total length: 254
2025-06-24 16:18:10 INFO: Message sent successfully
2025-06-24 16:18:10 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:18:10 INFO: Waiting to receive message...
2025-06-24 16:18:10 INFO: Reading encrypted message...
2025-06-24 16:18:12 INFO: Read 4 bytes for encrypted message length
2025-06-24 16:18:12 INFO: Encrypted message length: 255
2025-06-24 16:18:12 INFO: Read 255 bytes for encrypted message body
2025-06-24 16:18:12 INFO: Decrypting encrypted message, length: 255
2025-06-24 16:18:12 INFO: Message decrypted successfully, new length: 227
2025-06-24 16:18:12 INFO: Received message: SHELL_COMMAND
2025-06-24 16:18:12 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 16:18:12 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-24 16:18:12 INFO: Sending message: SHELL_RESULT, length: 346
2025-06-24 16:18:12 INFO: Message encrypted, new length: 374
2025-06-24 16:18:12 INFO: Added length prefix for encrypted message, total length: 378
2025-06-24 16:18:12 INFO: Message sent successfully
2025-06-24 16:18:12 INFO: Sent SHELL_RESULT message to client.
2025-06-24 16:18:12 INFO: Waiting to receive message...
2025-06-24 16:18:12 INFO: Reading encrypted message...
2025-06-24 16:18:36 INFO: Read -1 bytes for encrypted message length
2025-06-24 16:18:36 INFO: Client disconnected gracefully (end of stream)
2025-06-24 16:18:36 INFO: Server: Client 127.0.0.1:52168 disconnected gracefully
2025-06-24 16:18:36 INFO: Server: Cleaning up client connection for 127.0.0.1:52168
2025-06-24 16:18:36 INFO: Server: Cleaning up connection for 127.0.0.1:52168 (user: tilman)
2025-06-24 16:18:36 INFO: Protocol handler closed
