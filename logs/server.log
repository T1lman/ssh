[2025-06-22 18:59:06] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: checksum = 1002214975
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Encrypted message length: 88
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Read 88 bytes for encrypted message body
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 88
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 60
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: restLength = 56
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 51 (restLength=56 - 5)
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] fromPacket: checksum = 1743321437
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Authentication attempt for user: user1, type: password
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] User existence check for 'user1': true
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] User validation passed for: user1
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Attempting password authentication for: user1
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] Verifying password for user: user1
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: user1
[2025-06-22 18:59:15] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: user1
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] UserStore: Password verification for user1 - Stored hash: 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8, Input hash: 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8, Matches: true
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for user1: true
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Password authentication result for user1: true
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:59:16] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:01:03] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-22 19:01:03] [ERROR] [pool-1-thread-1] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 19:01:03] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: checksum = 424534207
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Encrypted message length: 85
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Read 85 bytes for encrypted message body
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 85
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 57
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: restLength = 53
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: checksum = -1075446496
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Authentication attempt for user: admin, type: password
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] User existence check for 'admin': true
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] User validation passed for: admin
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Attempting password authentication for: admin
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Verifying password for user: admin
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: admin
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: admin
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for admin: true
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Password authentication result for admin: true
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 19:01:09] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Encrypted message length: 73
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Read 73 bytes for encrypted message body
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 73
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 45
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] fromPacket: restLength = 41
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] fromPacket: parsed message type = FILE_DOWNLOAD_REQUEST
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 36 (restLength=41 - 5)
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] fromPacket: checksum = 1862792598
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Received encrypted message: FILE_DOWNLOAD_REQUEST
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] File download request from admin for: lel.txt
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Sending file: lel.txt (43 bytes)
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Sending message: FILE_DATA, length: 134
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Message encrypted, new length: 162
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 166
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 19:01:25] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-22 19:04:50] [ERROR] [pool-1-thread-2] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 19:04:50] [ERROR] [pool-1-thread-2] File download failed for user admin: Failed to read encrypted message length
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Sending message: ERROR, length: 62
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Message encrypted, new length: 90
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 94
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-22 19:04:50] [ERROR] [pool-1-thread-2] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 19:04:50] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-22 19:04:50] [INFO] [Thread-0] Shutdown signal received
[2025-06-22 19:05:25] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: checksum = -1539970467
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:05:43] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Encrypted message length: 73
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Read 73 bytes for encrypted message body
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 73
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 45
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: restLength = 41
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: parsed message type = FILE_DOWNLOAD_REQUEST
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 36 (restLength=41 - 5)
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: checksum = 1862792598
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Received encrypted message: FILE_DOWNLOAD_REQUEST
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] File download request from admin for: lel.txt
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Sending file: lel.txt (43 bytes)
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Sending message: FILE_DATA, length: 134
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Message encrypted, new length: 162
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 166
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Encrypted message length: 116
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Read 116 bytes for encrypted message body
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 116
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 88
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: restLength = 84
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: parsed message type = FILE_ACK
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 79 (restLength=84 - 5)
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] fromPacket: checksum = 1609910521
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Received encrypted message: FILE_ACK
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] File download completed for admin: lel.txt
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:05:57] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:33:12] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-22 19:33:12] [ERROR] [pool-1-thread-1] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 19:33:12] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 19:33:12] [INFO] [Thread-0] Shutdown signal received
