2025-06-24 01:05:36 INFO: Logger initialized: logs/server.log
2025-06-24 01:05:36 INFO: SSHServerModel: Created new model instance
2025-06-24 01:05:36 INFO: SSH Server Starting
2025-06-24 01:05:36 INFO: Log file: logs/server.log
2025-06-24 01:05:36 INFO: SSHServerController: Starting server
2025-06-24 01:05:40 INFO: SSHServerModel: Starting server
2025-06-24 01:05:55 INFO: Server: Starting client connection handler for 127.0.0.1:62562
2025-06-24 01:05:55 INFO: Server: Initializing protocol handler
2025-06-24 01:05:55 INFO: Server: Protocol handler initialized
2025-06-24 01:05:55 INFO: Server: Starting key exchange
2025-06-24 01:05:55 INFO: Waiting to receive message...
2025-06-24 01:05:55 INFO: Read 4 bytes for message length
2025-06-24 01:05:55 INFO: Message length: 920
2025-06-24 01:05:55 INFO: Read 920 bytes for message body (expected 920)
2025-06-24 01:05:55 INFO: Message body (first 20 bytes): 01 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
2025-06-24 01:05:55 INFO: Raw message type byte: 1
2025-06-24 01:05:55 INFO: Parsed message type: KEY_EXCHANGE_INIT
2025-06-24 01:05:55 INFO: fromPacket: restLength = 920
2025-06-24 01:05:55 INFO: fromPacket: parsed message type = KEY_EXCHANGE_INIT
2025-06-24 01:05:55 INFO: fromPacket: payloadLength = 915 (restLength=920 - 5)
2025-06-24 01:05:55 INFO: fromPacket: checksum = 890922862
2025-06-24 01:05:55 INFO: Received message: KEY_EXCHANGE_INIT
2025-06-24 01:05:55 INFO: Server: Received key exchange init from null
2025-06-24 01:05:55 INFO: Server: Received key exchange init from null
2025-06-24 01:05:55 INFO: Server: Initializing DH key exchange
2025-06-24 01:05:55 INFO: Server: Generated DH key pair
2025-06-24 01:05:55 INFO: Server: Set client's public key
2025-06-24 01:05:55 INFO: Server: Computing shared secret
2025-06-24 01:05:55 INFO: Server: Computed shared secret, length: 256
2025-06-24 01:05:55 INFO: Server: Initializing symmetric encryption
2025-06-24 01:05:55 INFO: Server: Initialized symmetric encryption
2025-06-24 01:05:55 INFO: Server: Creating key exchange reply message
2025-06-24 01:05:55 INFO: Server: Created reply message, signing DH public key
2025-06-24 01:05:55 INFO: Server: Starting RSA signature generation
2025-06-24 01:05:55 INFO: Server: RSA signature generated, length: 256
2025-06-24 01:05:55 INFO: Server: Sending key exchange reply
2025-06-24 01:05:55 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1321
2025-06-24 01:05:55 INFO: Message sent successfully
2025-06-24 01:05:55 INFO: Server: Key exchange reply sent successfully
2025-06-24 01:05:55 INFO: Server: Key exchange completed successfully
2025-06-24 01:05:55 INFO: Server: Enabling encryption
2025-06-24 01:05:55 INFO: Encryption enabled - subsequent messages will be encrypted/decrypted
2025-06-24 01:05:55 INFO: Server: Encryption enabled
2025-06-24 01:05:55 INFO: Server: Key exchange completed successfully
2025-06-24 01:05:55 INFO: Server: Starting authentication
2025-06-24 01:05:55 INFO: Waiting to receive message...
2025-06-24 01:05:55 INFO: Reading encrypted message...
2025-06-24 01:05:55 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:05:55 INFO: Encrypted message length: 965
2025-06-24 01:05:55 INFO: Read 965 bytes for encrypted message body
2025-06-24 01:05:55 INFO: Decrypting encrypted message, length: 965
2025-06-24 01:05:55 INFO: Message decrypted successfully, new length: 937
2025-06-24 01:05:55 INFO: fromPacket: restLength = 933
2025-06-24 01:05:55 INFO: fromPacket: parsed message type = AUTH_REQUEST
2025-06-24 01:05:55 INFO: fromPacket: payloadLength = 928 (restLength=933 - 5)
2025-06-24 01:05:55 INFO: fromPacket: checksum = -1926432596
2025-06-24 01:05:55 INFO: Received encrypted message: AUTH_REQUEST
2025-06-24 01:05:55 INFO: Server: Authentication request from tilman using dual
2025-06-24 01:05:55 INFO: Authentication attempt for user: tilman, type: dual
2025-06-24 01:05:55 INFO: User existence check for 'tilman': true
2025-06-24 01:05:55 INFO: User validation passed for: tilman
2025-06-24 01:05:55 INFO: Attempting dual authentication (password + public key) for: tilman
2025-06-24 01:05:55 INFO: Verifying password for user: tilman
2025-06-24 01:05:55 INFO: PasswordAuth: Checking if user exists: tilman
2025-06-24 01:05:55 INFO: PasswordAuth: User exists, verifying password for: tilman
2025-06-24 01:05:55 INFO: UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
2025-06-24 01:05:55 INFO: PasswordAuth: Password verification result for tilman: true
2025-06-24 01:05:55 INFO: Password authentication result for tilman: true
2025-06-24 01:05:55 INFO: PublicKeyAuth: Found 1 authorized keys for user: tilman
2025-06-24 01:05:55 INFO: PublicKeyAuth: Key match found!
2025-06-24 01:05:55 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 01:05:55 INFO: Dual authentication successful for user: tilman
2025-06-24 01:05:55 INFO: Sending message: AUTH_SUCCESS, length: 220
2025-06-24 01:05:55 INFO: Message encrypted, new length: 248
2025-06-24 01:05:55 INFO: Added length prefix for encrypted message, total length: 252
2025-06-24 01:05:55 INFO: Message sent successfully
2025-06-24 01:05:55 INFO: Server: Authentication SUCCESS for tilman: Authentication successful
2025-06-24 01:05:55 INFO: Server: Authentication completed successfully
2025-06-24 01:05:55 INFO: Server: Starting service request handling
2025-06-24 01:05:55 INFO: Waiting to receive message...
2025-06-24 01:05:55 INFO: Reading encrypted message...
2025-06-24 01:05:55 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:05:55 INFO: Encrypted message length: 137
2025-06-24 01:05:55 INFO: Read 137 bytes for encrypted message body
2025-06-24 01:05:55 INFO: Decrypting encrypted message, length: 137
2025-06-24 01:05:55 INFO: Message decrypted successfully, new length: 109
2025-06-24 01:05:55 INFO: fromPacket: restLength = 105
2025-06-24 01:05:55 INFO: fromPacket: parsed message type = SERVICE_REQUEST
2025-06-24 01:05:55 INFO: fromPacket: payloadLength = 100 (restLength=105 - 5)
2025-06-24 01:05:55 INFO: fromPacket: checksum = -1107515802
2025-06-24 01:05:55 INFO: Received encrypted message: SERVICE_REQUEST
2025-06-24 01:05:55 INFO: Server: Service request from tilman for shell
2025-06-24 01:05:55 INFO: Sending message: SERVICE_ACCEPT, length: 108
2025-06-24 01:05:55 INFO: Message encrypted, new length: 136
2025-06-24 01:05:55 INFO: Added length prefix for encrypted message, total length: 140
2025-06-24 01:05:55 INFO: Message sent successfully
2025-06-24 01:05:55 INFO: Server: Service shell accepted for tilman
2025-06-24 01:05:55 INFO: Waiting to receive message...
2025-06-24 01:05:55 INFO: Reading encrypted message...
2025-06-24 01:05:58 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:05:58 INFO: Encrypted message length: 206
2025-06-24 01:05:58 INFO: Read 206 bytes for encrypted message body
2025-06-24 01:05:58 INFO: Decrypting encrypted message, length: 206
2025-06-24 01:05:58 INFO: Message decrypted successfully, new length: 178
2025-06-24 01:05:58 INFO: fromPacket: restLength = 174
2025-06-24 01:05:58 INFO: fromPacket: parsed message type = SHELL_COMMAND
2025-06-24 01:05:58 INFO: fromPacket: payloadLength = 169 (restLength=174 - 5)
2025-06-24 01:05:58 INFO: fromPacket: checksum = 1066413956
2025-06-24 01:05:58 INFO: Received encrypted message: SHELL_COMMAND
2025-06-24 01:05:58 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 01:05:58 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-24 01:05:58 INFO: Sending message: SHELL_RESULT, length: 297
2025-06-24 01:05:58 INFO: Message encrypted, new length: 325
2025-06-24 01:05:58 INFO: Added length prefix for encrypted message, total length: 329
2025-06-24 01:05:58 INFO: Message sent successfully
2025-06-24 01:05:58 INFO: Sent SHELL_RESULT message to client.
2025-06-24 01:05:58 INFO: Waiting to receive message...
2025-06-24 01:05:58 INFO: Reading encrypted message...
2025-06-24 01:11:13 INFO: Shutdown signal received
2025-06-24 01:11:13 INFO: SSHServerController: Stopping server
2025-06-24 01:11:13 INFO: SSHServerModel: Stopping server
2025-06-24 01:11:22 INFO: Logger initialized: logs/server.log
2025-06-24 01:11:22 INFO: SSHServerModel: Created new model instance
2025-06-24 01:11:22 INFO: SSH Server Starting
2025-06-24 01:11:22 INFO: Log file: logs/server.log
2025-06-24 01:11:22 INFO: SSHServerController: Starting server
2025-06-24 01:11:26 INFO: SSHServerModel: Starting server
2025-06-24 01:11:43 INFO: Server: Starting client connection handler for 127.0.0.1:62674
2025-06-24 01:11:43 INFO: Server: Initializing protocol handler
2025-06-24 01:11:43 INFO: Server: Protocol handler initialized
2025-06-24 01:11:43 INFO: Server: Starting key exchange
2025-06-24 01:11:43 INFO: Waiting to receive message...
2025-06-24 01:11:43 INFO: Read 4 bytes for message length
2025-06-24 01:11:43 INFO: Message length: 920
2025-06-24 01:11:43 INFO: Read 920 bytes for message body (expected 920)
2025-06-24 01:11:43 INFO: Message body (first 20 bytes): 01 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
2025-06-24 01:11:43 INFO: Raw message type byte: 1
2025-06-24 01:11:43 INFO: Parsed message type: KEY_EXCHANGE_INIT
2025-06-24 01:11:44 INFO: fromPacket: restLength = 920
2025-06-24 01:11:44 INFO: fromPacket: parsed message type = KEY_EXCHANGE_INIT
2025-06-24 01:11:44 INFO: fromPacket: payloadLength = 915 (restLength=920 - 5)
2025-06-24 01:11:44 INFO: fromPacket: checksum = -518536978
2025-06-24 01:11:44 INFO: Received message: KEY_EXCHANGE_INIT
2025-06-24 01:11:44 INFO: Server: Received key exchange init from null
2025-06-24 01:11:44 INFO: Server: Received key exchange init from null
2025-06-24 01:11:44 INFO: Server: Initializing DH key exchange
2025-06-24 01:11:44 INFO: Server: Generated DH key pair
2025-06-24 01:11:44 INFO: Server: Set client's public key
2025-06-24 01:11:44 INFO: Server: Computing shared secret
2025-06-24 01:11:44 INFO: Server: Computed shared secret, length: 256
2025-06-24 01:11:44 INFO: Server: Initializing symmetric encryption
2025-06-24 01:11:44 INFO: Server: Initialized symmetric encryption
2025-06-24 01:11:44 INFO: Server: Creating key exchange reply message
2025-06-24 01:11:44 INFO: Server: Created reply message, signing DH public key
2025-06-24 01:11:44 INFO: Server: Starting RSA signature generation
2025-06-24 01:11:44 INFO: Server: RSA signature generated, length: 256
2025-06-24 01:11:44 INFO: Server: Sending key exchange reply
2025-06-24 01:11:44 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1321
2025-06-24 01:11:44 INFO: Message sent successfully
2025-06-24 01:11:44 INFO: Server: Key exchange reply sent successfully
2025-06-24 01:11:44 INFO: Server: Key exchange completed successfully
2025-06-24 01:11:44 INFO: Server: Enabling encryption
2025-06-24 01:11:44 INFO: Encryption enabled - subsequent messages will be encrypted/decrypted
2025-06-24 01:11:44 INFO: Server: Encryption enabled
2025-06-24 01:11:44 INFO: Server: Key exchange completed successfully
2025-06-24 01:11:44 INFO: Server: Starting authentication
2025-06-24 01:11:44 INFO: Waiting to receive message...
2025-06-24 01:11:44 INFO: Reading encrypted message...
2025-06-24 01:11:44 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:11:44 INFO: Encrypted message length: 965
2025-06-24 01:11:44 INFO: Read 965 bytes for encrypted message body
2025-06-24 01:11:44 INFO: Decrypting encrypted message, length: 965
2025-06-24 01:11:44 INFO: Message decrypted successfully, new length: 937
2025-06-24 01:11:44 INFO: fromPacket: restLength = 933
2025-06-24 01:11:44 INFO: fromPacket: parsed message type = AUTH_REQUEST
2025-06-24 01:11:44 INFO: fromPacket: payloadLength = 928 (restLength=933 - 5)
2025-06-24 01:11:44 INFO: fromPacket: checksum = 1351946270
2025-06-24 01:11:44 INFO: Received encrypted message: AUTH_REQUEST
2025-06-24 01:11:44 INFO: Server: Authentication request from tilman using dual
2025-06-24 01:11:44 INFO: Authentication attempt for user: tilman, type: dual
2025-06-24 01:11:44 INFO: User existence check for 'tilman': true
2025-06-24 01:11:44 INFO: User validation passed for: tilman
2025-06-24 01:11:44 INFO: Attempting dual authentication (password + public key) for: tilman
2025-06-24 01:11:44 INFO: Verifying password for user: tilman
2025-06-24 01:11:44 INFO: PasswordAuth: Checking if user exists: tilman
2025-06-24 01:11:44 INFO: PasswordAuth: User exists, verifying password for: tilman
2025-06-24 01:11:44 INFO: UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
2025-06-24 01:11:44 INFO: PasswordAuth: Password verification result for tilman: true
2025-06-24 01:11:44 INFO: Password authentication result for tilman: true
2025-06-24 01:11:44 INFO: PublicKeyAuth: Found 1 authorized keys for user: tilman
2025-06-24 01:11:44 INFO: PublicKeyAuth: Key match found!
2025-06-24 01:11:44 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 01:11:44 INFO: Dual authentication successful for user: tilman
2025-06-24 01:11:44 INFO: Sending message: AUTH_SUCCESS, length: 220
2025-06-24 01:11:44 INFO: Message encrypted, new length: 248
2025-06-24 01:11:44 INFO: Added length prefix for encrypted message, total length: 252
2025-06-24 01:11:44 INFO: Message sent successfully
2025-06-24 01:11:44 INFO: Server: Authentication SUCCESS for tilman: Authentication successful
2025-06-24 01:11:44 INFO: Server: Authentication completed successfully
2025-06-24 01:11:44 INFO: Server: Starting service request handling
2025-06-24 01:11:44 INFO: Waiting to receive message...
2025-06-24 01:11:44 INFO: Reading encrypted message...
2025-06-24 01:11:44 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:11:44 INFO: Encrypted message length: 137
2025-06-24 01:11:44 INFO: Read 137 bytes for encrypted message body
2025-06-24 01:11:44 INFO: Decrypting encrypted message, length: 137
2025-06-24 01:11:44 INFO: Message decrypted successfully, new length: 109
2025-06-24 01:11:44 INFO: fromPacket: restLength = 105
2025-06-24 01:11:44 INFO: fromPacket: parsed message type = SERVICE_REQUEST
2025-06-24 01:11:44 INFO: fromPacket: payloadLength = 100 (restLength=105 - 5)
2025-06-24 01:11:44 INFO: fromPacket: checksum = -1107515802
2025-06-24 01:11:44 INFO: Received encrypted message: SERVICE_REQUEST
2025-06-24 01:11:44 INFO: Server: Service request from tilman for shell
2025-06-24 01:11:44 INFO: Sending message: SERVICE_ACCEPT, length: 108
2025-06-24 01:11:44 INFO: Message encrypted, new length: 136
2025-06-24 01:11:44 INFO: Added length prefix for encrypted message, total length: 140
2025-06-24 01:11:44 INFO: Message sent successfully
2025-06-24 01:11:44 INFO: Server: Service shell accepted for tilman
2025-06-24 01:11:44 INFO: Waiting to receive message...
2025-06-24 01:11:44 INFO: Reading encrypted message...
2025-06-24 01:11:47 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:11:47 INFO: Encrypted message length: 206
2025-06-24 01:11:47 INFO: Read 206 bytes for encrypted message body
2025-06-24 01:11:47 INFO: Decrypting encrypted message, length: 206
2025-06-24 01:11:47 INFO: Message decrypted successfully, new length: 178
2025-06-24 01:11:47 INFO: fromPacket: restLength = 174
2025-06-24 01:11:47 INFO: fromPacket: parsed message type = SHELL_COMMAND
2025-06-24 01:11:47 INFO: fromPacket: payloadLength = 169 (restLength=174 - 5)
2025-06-24 01:11:47 INFO: fromPacket: checksum = 1066413956
2025-06-24 01:11:47 INFO: Received encrypted message: SHELL_COMMAND
2025-06-24 01:11:47 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 01:11:47 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-24 01:11:47 INFO: Sending message: SHELL_RESULT, length: 297
2025-06-24 01:11:47 INFO: Message encrypted, new length: 325
2025-06-24 01:11:47 INFO: Added length prefix for encrypted message, total length: 329
2025-06-24 01:11:47 INFO: Message sent successfully
2025-06-24 01:11:47 INFO: Sent SHELL_RESULT message to client.
2025-06-24 01:11:47 INFO: Waiting to receive message...
2025-06-24 01:11:47 INFO: Reading encrypted message...
2025-06-24 01:14:58 INFO: Read -1 bytes for encrypted message length
2025-06-24 01:14:58 INFO: Client disconnected gracefully (end of stream)
2025-06-24 01:14:58 INFO: Server: Client 127.0.0.1:62674 disconnected gracefully
2025-06-24 01:14:58 INFO: Server: Cleaning up client connection for 127.0.0.1:62674
2025-06-24 01:14:58 INFO: Server: Cleaning up connection for 127.0.0.1:62674 (user: tilman)
2025-06-24 01:14:58 INFO: Protocol handler closed
2025-06-24 01:16:12 INFO: Server: Starting client connection handler for 127.0.0.1:62819
2025-06-24 01:16:12 INFO: Server: Initializing protocol handler
2025-06-24 01:16:12 INFO: Server: Protocol handler initialized
2025-06-24 01:16:12 INFO: Server: Starting key exchange
2025-06-24 01:16:12 INFO: Waiting to receive message...
2025-06-24 01:16:12 INFO: Read 4 bytes for message length
2025-06-24 01:16:12 INFO: Message length: 920
2025-06-24 01:16:12 INFO: Read 920 bytes for message body (expected 920)
2025-06-24 01:16:12 INFO: Message body (first 20 bytes): 01 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
2025-06-24 01:16:12 INFO: Raw message type byte: 1
2025-06-24 01:16:12 INFO: Parsed message type: KEY_EXCHANGE_INIT
2025-06-24 01:16:12 INFO: fromPacket: restLength = 920
2025-06-24 01:16:12 INFO: fromPacket: parsed message type = KEY_EXCHANGE_INIT
2025-06-24 01:16:12 INFO: fromPacket: payloadLength = 915 (restLength=920 - 5)
2025-06-24 01:16:12 INFO: fromPacket: checksum = -881423190
2025-06-24 01:16:12 INFO: Received message: KEY_EXCHANGE_INIT
2025-06-24 01:16:12 INFO: Server: Received key exchange init from null
2025-06-24 01:16:12 INFO: Server: Received key exchange init from null
2025-06-24 01:16:12 INFO: Server: Initializing DH key exchange
2025-06-24 01:16:12 INFO: Server: Generated DH key pair
2025-06-24 01:16:12 INFO: Server: Set client's public key
2025-06-24 01:16:12 INFO: Server: Computing shared secret
2025-06-24 01:16:12 INFO: Server: Computed shared secret, length: 256
2025-06-24 01:16:12 INFO: Server: Initializing symmetric encryption
2025-06-24 01:16:12 INFO: Server: Initialized symmetric encryption
2025-06-24 01:16:12 INFO: Server: Creating key exchange reply message
2025-06-24 01:16:12 INFO: Server: Created reply message, signing DH public key
2025-06-24 01:16:12 INFO: Server: Starting RSA signature generation
2025-06-24 01:16:12 INFO: Server: RSA signature generated, length: 256
2025-06-24 01:16:12 INFO: Server: Sending key exchange reply
2025-06-24 01:16:12 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1321
2025-06-24 01:16:12 INFO: Message sent successfully
2025-06-24 01:16:12 INFO: Server: Key exchange reply sent successfully
2025-06-24 01:16:12 INFO: Server: Key exchange completed successfully
2025-06-24 01:16:12 INFO: Server: Enabling encryption
2025-06-24 01:16:12 INFO: Encryption enabled - subsequent messages will be encrypted/decrypted
2025-06-24 01:16:12 INFO: Server: Encryption enabled
2025-06-24 01:16:12 INFO: Server: Key exchange completed successfully
2025-06-24 01:16:12 INFO: Server: Starting authentication
2025-06-24 01:16:12 INFO: Waiting to receive message...
2025-06-24 01:16:12 INFO: Reading encrypted message...
2025-06-24 01:16:12 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:16:12 INFO: Encrypted message length: 965
2025-06-24 01:16:12 INFO: Read 965 bytes for encrypted message body
2025-06-24 01:16:12 INFO: Decrypting encrypted message, length: 965
2025-06-24 01:16:12 INFO: Message decrypted successfully, new length: 937
2025-06-24 01:16:12 INFO: fromPacket: restLength = 933
2025-06-24 01:16:12 INFO: fromPacket: parsed message type = AUTH_REQUEST
2025-06-24 01:16:12 INFO: fromPacket: payloadLength = 928 (restLength=933 - 5)
2025-06-24 01:16:12 INFO: fromPacket: checksum = 418383826
2025-06-24 01:16:12 INFO: Received encrypted message: AUTH_REQUEST
2025-06-24 01:16:12 INFO: Server: Authentication request from tilman using dual
2025-06-24 01:16:12 INFO: Authentication attempt for user: tilman, type: dual
2025-06-24 01:16:12 INFO: User existence check for 'tilman': true
2025-06-24 01:16:12 INFO: User validation passed for: tilman
2025-06-24 01:16:12 INFO: Attempting dual authentication (password + public key) for: tilman
2025-06-24 01:16:12 INFO: Verifying password for user: tilman
2025-06-24 01:16:12 INFO: PasswordAuth: Checking if user exists: tilman
2025-06-24 01:16:12 INFO: PasswordAuth: User exists, verifying password for: tilman
2025-06-24 01:16:12 INFO: UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
2025-06-24 01:16:12 INFO: PasswordAuth: Password verification result for tilman: true
2025-06-24 01:16:12 INFO: Password authentication result for tilman: true
2025-06-24 01:16:12 INFO: PublicKeyAuth: Found 1 authorized keys for user: tilman
2025-06-24 01:16:12 INFO: PublicKeyAuth: Key match found!
2025-06-24 01:16:12 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 01:16:12 INFO: Dual authentication successful for user: tilman
2025-06-24 01:16:12 INFO: Sending message: AUTH_SUCCESS, length: 220
2025-06-24 01:16:12 INFO: Message encrypted, new length: 248
2025-06-24 01:16:12 INFO: Added length prefix for encrypted message, total length: 252
2025-06-24 01:16:12 INFO: Message sent successfully
2025-06-24 01:16:12 INFO: Server: Authentication SUCCESS for tilman: Authentication successful
2025-06-24 01:16:12 INFO: Server: Authentication completed successfully
2025-06-24 01:16:12 INFO: Server: Starting service request handling
2025-06-24 01:16:12 INFO: Waiting to receive message...
2025-06-24 01:16:12 INFO: Reading encrypted message...
2025-06-24 01:16:12 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:16:12 INFO: Encrypted message length: 137
2025-06-24 01:16:12 INFO: Read 137 bytes for encrypted message body
2025-06-24 01:16:12 INFO: Decrypting encrypted message, length: 137
2025-06-24 01:16:12 INFO: Message decrypted successfully, new length: 109
2025-06-24 01:16:12 INFO: fromPacket: restLength = 105
2025-06-24 01:16:12 INFO: fromPacket: parsed message type = SERVICE_REQUEST
2025-06-24 01:16:12 INFO: fromPacket: payloadLength = 100 (restLength=105 - 5)
2025-06-24 01:16:12 INFO: fromPacket: checksum = -1107515802
2025-06-24 01:16:12 INFO: Received encrypted message: SERVICE_REQUEST
2025-06-24 01:16:12 INFO: Server: Service request from tilman for shell
2025-06-24 01:16:12 INFO: Sending message: SERVICE_ACCEPT, length: 108
2025-06-24 01:16:12 INFO: Message encrypted, new length: 136
2025-06-24 01:16:12 INFO: Added length prefix for encrypted message, total length: 140
2025-06-24 01:16:12 INFO: Message sent successfully
2025-06-24 01:16:12 INFO: Server: Service shell accepted for tilman
2025-06-24 01:16:12 INFO: Waiting to receive message...
2025-06-24 01:16:12 INFO: Reading encrypted message...
2025-06-24 01:16:50 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:16:50 INFO: Encrypted message length: 206
2025-06-24 01:16:50 INFO: Read 206 bytes for encrypted message body
2025-06-24 01:16:50 INFO: Decrypting encrypted message, length: 206
2025-06-24 01:16:50 INFO: Message decrypted successfully, new length: 178
2025-06-24 01:16:50 INFO: fromPacket: restLength = 174
2025-06-24 01:16:50 INFO: fromPacket: parsed message type = SHELL_COMMAND
2025-06-24 01:16:50 INFO: fromPacket: payloadLength = 169 (restLength=174 - 5)
2025-06-24 01:16:50 INFO: fromPacket: checksum = 1066413956
2025-06-24 01:16:50 INFO: Received encrypted message: SHELL_COMMAND
2025-06-24 01:16:50 INFO: Server: Executing shell command: 'ls' for user: tilman
2025-06-24 01:16:50 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-24 01:16:50 INFO: Sending message: SHELL_RESULT, length: 297
2025-06-24 01:16:50 INFO: Message encrypted, new length: 325
2025-06-24 01:16:50 INFO: Added length prefix for encrypted message, total length: 329
2025-06-24 01:16:50 INFO: Message sent successfully
2025-06-24 01:16:50 INFO: Sent SHELL_RESULT message to client.
2025-06-24 01:16:50 INFO: Waiting to receive message...
2025-06-24 01:16:50 INFO: Reading encrypted message...
2025-06-24 01:18:04 INFO: Read -1 bytes for encrypted message length
2025-06-24 01:18:04 INFO: Client disconnected gracefully (end of stream)
2025-06-24 01:18:04 INFO: Server: Client 127.0.0.1:62819 disconnected gracefully
2025-06-24 01:18:04 INFO: Server: Cleaning up client connection for 127.0.0.1:62819
2025-06-24 01:18:04 INFO: Server: Cleaning up connection for 127.0.0.1:62819 (user: tilman)
2025-06-24 01:18:04 INFO: Protocol handler closed
2025-06-24 01:19:04 INFO: Shutdown signal received
2025-06-24 01:19:04 INFO: SSHServerController: Stopping server
2025-06-24 01:19:04 INFO: SSHServerModel: Stopping server
2025-06-24 01:19:10 INFO: Logger initialized: logs/server.log
2025-06-24 01:19:10 INFO: SSHServerModel: Created new model instance
2025-06-24 01:19:10 INFO: SSH Server Starting
2025-06-24 01:19:10 INFO: Log file: logs/server.log
2025-06-24 01:19:10 INFO: SSHServerController: Starting server
2025-06-24 01:19:15 INFO: SSHServerModel: Starting server
2025-06-24 01:19:33 INFO: Server: Starting client connection handler for 127.0.0.1:62977
2025-06-24 01:19:33 INFO: Server: Initializing protocol handler
2025-06-24 01:19:33 INFO: Server: Protocol handler initialized
2025-06-24 01:19:33 INFO: Server: Starting key exchange
2025-06-24 01:19:33 INFO: Waiting to receive message...
2025-06-24 01:19:34 INFO: Read 4 bytes for message length
2025-06-24 01:19:34 INFO: Message length: 920
2025-06-24 01:19:34 INFO: Read 920 bytes for message body (expected 920)
2025-06-24 01:19:34 INFO: Message body (first 20 bytes): 01 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
2025-06-24 01:19:34 INFO: Raw message type byte: 1
2025-06-24 01:19:34 INFO: Parsed message type: KEY_EXCHANGE_INIT
2025-06-24 01:19:34 INFO: fromPacket: restLength = 920
2025-06-24 01:19:34 INFO: fromPacket: parsed message type = KEY_EXCHANGE_INIT
2025-06-24 01:19:34 INFO: fromPacket: payloadLength = 915 (restLength=920 - 5)
2025-06-24 01:19:34 INFO: fromPacket: checksum = 1626778782
2025-06-24 01:19:34 INFO: Received message: KEY_EXCHANGE_INIT
2025-06-24 01:19:34 INFO: Server: Received key exchange init from null
2025-06-24 01:19:34 INFO: Server: Received key exchange init from null
2025-06-24 01:19:34 INFO: Server: Initializing DH key exchange
2025-06-24 01:19:34 INFO: Server: Generated DH key pair
2025-06-24 01:19:34 INFO: Server: Set client's public key
2025-06-24 01:19:34 INFO: Server: Computing shared secret
2025-06-24 01:19:34 INFO: Server: Computed shared secret, length: 256
2025-06-24 01:19:34 INFO: Server: Initializing symmetric encryption
2025-06-24 01:19:34 INFO: Server: Initialized symmetric encryption
2025-06-24 01:19:34 INFO: Server: Creating key exchange reply message
2025-06-24 01:19:34 INFO: Server: Created reply message, signing DH public key
2025-06-24 01:19:34 INFO: Server: Starting RSA signature generation
2025-06-24 01:19:34 INFO: Server: RSA signature generated, length: 256
2025-06-24 01:19:34 INFO: Server: Sending key exchange reply
2025-06-24 01:19:34 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1321
2025-06-24 01:19:34 INFO: Message sent successfully
2025-06-24 01:19:34 INFO: Server: Key exchange reply sent successfully
2025-06-24 01:19:34 INFO: Server: Key exchange completed successfully
2025-06-24 01:19:34 INFO: Server: Enabling encryption
2025-06-24 01:19:34 INFO: Encryption enabled - subsequent messages will be encrypted/decrypted
2025-06-24 01:19:34 INFO: Server: Encryption enabled
2025-06-24 01:19:34 INFO: Server: Key exchange completed successfully
2025-06-24 01:19:34 INFO: Server: Starting authentication
2025-06-24 01:19:34 INFO: Waiting to receive message...
2025-06-24 01:19:34 INFO: Reading encrypted message...
2025-06-24 01:19:34 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:19:34 INFO: Encrypted message length: 965
2025-06-24 01:19:34 INFO: Read 965 bytes for encrypted message body
2025-06-24 01:19:34 INFO: Decrypting encrypted message, length: 965
2025-06-24 01:19:34 INFO: Message decrypted successfully, new length: 937
2025-06-24 01:19:34 INFO: fromPacket: restLength = 933
2025-06-24 01:19:34 INFO: fromPacket: parsed message type = AUTH_REQUEST
2025-06-24 01:19:34 INFO: fromPacket: payloadLength = 928 (restLength=933 - 5)
2025-06-24 01:19:34 INFO: fromPacket: checksum = -931355163
2025-06-24 01:19:34 INFO: Received encrypted message: AUTH_REQUEST
2025-06-24 01:19:34 INFO: Server: Authentication request from tilman using dual
2025-06-24 01:19:34 INFO: Authentication attempt for user: tilman, type: dual
2025-06-24 01:19:34 INFO: User existence check for 'tilman': true
2025-06-24 01:19:34 INFO: User validation passed for: tilman
2025-06-24 01:19:34 INFO: Attempting dual authentication (password + public key) for: tilman
2025-06-24 01:19:34 INFO: Verifying password for user: tilman
2025-06-24 01:19:34 INFO: PasswordAuth: Checking if user exists: tilman
2025-06-24 01:19:34 INFO: PasswordAuth: User exists, verifying password for: tilman
2025-06-24 01:19:34 INFO: UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
2025-06-24 01:19:34 INFO: PasswordAuth: Password verification result for tilman: true
2025-06-24 01:19:34 INFO: Password authentication result for tilman: true
2025-06-24 01:19:34 INFO: PublicKeyAuth: Found 1 authorized keys for user: tilman
2025-06-24 01:19:34 INFO: PublicKeyAuth: Key match found!
2025-06-24 01:19:34 INFO: PublicKeyAuth: Signature verification result: true
2025-06-24 01:19:34 INFO: Dual authentication successful for user: tilman
2025-06-24 01:19:34 INFO: Sending message: AUTH_SUCCESS, length: 220
2025-06-24 01:19:34 INFO: Message encrypted, new length: 248
2025-06-24 01:19:34 INFO: Added length prefix for encrypted message, total length: 252
2025-06-24 01:19:34 INFO: Message sent successfully
2025-06-24 01:19:34 INFO: Server: Authentication SUCCESS for tilman: Authentication successful
2025-06-24 01:19:34 INFO: Server: Authentication completed successfully
2025-06-24 01:19:34 INFO: Server: Starting service request handling
2025-06-24 01:19:34 INFO: Waiting to receive message...
2025-06-24 01:19:34 INFO: Reading encrypted message...
2025-06-24 01:19:34 INFO: Read 4 bytes for encrypted message length
2025-06-24 01:19:34 INFO: Encrypted message length: 137
2025-06-24 01:19:34 INFO: Read 137 bytes for encrypted message body
2025-06-24 01:19:34 INFO: Decrypting encrypted message, length: 137
2025-06-24 01:19:34 INFO: Message decrypted successfully, new length: 109
2025-06-24 01:19:34 INFO: fromPacket: restLength = 105
2025-06-24 01:19:34 INFO: fromPacket: parsed message type = SERVICE_REQUEST
2025-06-24 01:19:34 INFO: fromPacket: payloadLength = 100 (restLength=105 - 5)
2025-06-24 01:19:34 INFO: fromPacket: checksum = -1107515802
2025-06-24 01:19:34 INFO: Received encrypted message: SERVICE_REQUEST
2025-06-24 01:19:34 INFO: Server: Service request from tilman for shell
2025-06-24 01:19:34 INFO: Sending message: SERVICE_ACCEPT, length: 108
2025-06-24 01:19:34 INFO: Message encrypted, new length: 136
2025-06-24 01:19:34 INFO: Added length prefix for encrypted message, total length: 140
2025-06-24 01:19:34 INFO: Message sent successfully
2025-06-24 01:19:34 INFO: Server: Service shell accepted for tilman
2025-06-24 01:19:34 INFO: Waiting to receive message...
2025-06-24 01:19:34 INFO: Reading encrypted message...
2025-06-24 01:20:42 INFO: Read -1 bytes for encrypted message length
2025-06-24 01:20:42 INFO: Client disconnected gracefully (end of stream)
2025-06-24 01:20:42 INFO: Server: Client 127.0.0.1:62977 disconnected gracefully
2025-06-24 01:20:42 INFO: Server: Cleaning up client connection for 127.0.0.1:62977
2025-06-24 01:20:42 INFO: Server: Cleaning up connection for 127.0.0.1:62977 (user: tilman)
2025-06-24 01:20:42 INFO: Protocol handler closed
2025-06-24 01:20:50 INFO: Shutdown signal received
2025-06-24 01:20:50 INFO: SSHServerController: Stopping server
2025-06-24 01:20:50 INFO: SSHServerModel: Stopping server
