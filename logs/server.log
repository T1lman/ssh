2025-06-25 17:40:47 INFO: Logger initialized: logs/server.log
2025-06-25 17:40:47 INFO: SSHServerModel: Created new model instance
2025-06-25 17:40:47 INFO: SSH Server Starting
2025-06-25 17:40:47 INFO: Log file: logs/server.log
2025-06-25 17:40:47 INFO: SSHServerController: Starting server
2025-06-25 17:41:46 INFO: SSHServerModel: Starting server
2025-06-25 17:41:57 INFO: Server: Starting client connection handler for 127.0.0.1:49575
2025-06-25 17:41:57 INFO: Server: Initializing protocol handler
2025-06-25 17:41:57 INFO: Server: Protocol handler initialized
2025-06-25 17:41:57 INFO: Server: Starting key exchange
2025-06-25 17:41:57 INFO: Server: Received key exchange init from null
2025-06-25 17:41:57 INFO: Server: Received key exchange init from null
2025-06-25 17:41:57 INFO: Server: Initializing DH key exchange
2025-06-25 17:41:57 INFO: Server: Generated DH key pair
2025-06-25 17:41:57 INFO: Server: Set client's public key
2025-06-25 17:41:57 INFO: Server: Computing shared secret
2025-06-25 17:41:57 INFO: Server: Computed shared secret, length: 256
2025-06-25 17:41:57 INFO: Server: Initializing symmetric encryption
2025-06-25 17:41:57 INFO: Server: Initialized symmetric encryption
2025-06-25 17:41:57 INFO: Server: Creating key exchange reply message
2025-06-25 17:41:57 INFO: Server: Created reply message, signing DH public key
2025-06-25 17:41:57 INFO: Server: Starting RSA signature generation
2025-06-25 17:41:57 INFO: Server: RSA signature generated, length: 256
2025-06-25 17:41:57 INFO: Server: Sending key exchange reply
2025-06-25 17:41:57 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-25 17:41:57 INFO: Message sent successfully
2025-06-25 17:41:57 INFO: Server: Key exchange reply sent successfully
2025-06-25 17:41:57 INFO: Server: Key exchange completed successfully
2025-06-25 17:41:57 INFO: Server: Enabling encryption
2025-06-25 17:41:57 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-25 17:41:57 INFO: Encryption and HMAC enabled in protocol handler
2025-06-25 17:41:57 INFO: Server: Key exchange completed successfully
2025-06-25 17:41:57 INFO: Server: Starting authentication
2025-06-25 17:41:57 INFO: Received message: AUTH_REQUEST
2025-06-25 17:41:57 INFO: Server: Authentication request from admin using dual
2025-06-25 17:41:57 INFO: Authentication attempt for user: admin, type: dual
2025-06-25 17:41:57 INFO: User existence check for 'admin': true
2025-06-25 17:41:57 INFO: User validation passed for: admin
2025-06-25 17:41:57 INFO: Attempting dual authentication (password + public key) for: admin
2025-06-25 17:41:57 INFO: DualAuth: password present: true
2025-06-25 17:41:57 INFO: DualAuth: publicKey present: true
2025-06-25 17:41:57 INFO: DualAuth: signature present: true
2025-06-25 17:41:57 INFO: DualAuth: sessionData present: true
2025-06-25 17:41:57 INFO: PasswordAuth: Verifying password for user: admin
2025-06-25 17:41:57 INFO: PasswordAuth: Checking if user exists: admin
2025-06-25 17:41:57 INFO: PasswordAuth: User exists, verifying password for: admin
2025-06-25 17:41:57 INFO: UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
2025-06-25 17:41:57 INFO: PasswordAuth: Password verification result for admin: true
2025-06-25 17:41:57 INFO: PasswordAuth: Password authentication result for admin: true
2025-06-25 17:41:57 INFO: DualAuth: Password authentication succeeded for user: admin
2025-06-25 17:41:57 INFO: PublicKeyAuth: publicKey present: true
2025-06-25 17:41:57 INFO: PublicKeyAuth: signature present: true
2025-06-25 17:41:57 INFO: PublicKeyAuth: sessionData present: true
2025-06-25 17:41:57 INFO: PublicKeyAuth: Created public key from string
2025-06-25 17:41:57 INFO: PublicKeyAuth: Decoded signature, length: 256
2025-06-25 17:41:57 INFO: PublicKeyAuth: Decoded session data, length: 36
2025-06-25 17:41:57 INFO: PublicKeyAuth: Found 4 authorized keys for user: admin
2025-06-25 17:41:57 INFO: PublicKeyAuth: Key match found!
2025-06-25 17:41:57 INFO: PublicKeyAuth: Signature verification result: true
2025-06-25 17:41:57 INFO: PublicKeyAuth: public key auth result: true
2025-06-25 17:41:57 INFO: DualAuth: Public key authentication succeeded for user: admin
2025-06-25 17:41:57 INFO: DualAuth: Dual authentication successful for user: admin
2025-06-25 17:41:57 INFO: Sending message: AUTH_SUCCESS, length: 269
2025-06-25 17:41:57 INFO: Message encrypted, new length: 297
2025-06-25 17:41:57 INFO: Added length prefix for encrypted message, total length: 301
2025-06-25 17:41:57 INFO: Message sent successfully
2025-06-25 17:41:57 INFO: Server: Authentication SUCCESS for admin: Authentication successful
2025-06-25 17:41:57 INFO: Server: Authentication completed successfully
2025-06-25 17:41:57 INFO: Server: Starting service request handling
2025-06-25 17:41:57 INFO: Received message: SERVICE_REQUEST
2025-06-25 17:41:57 INFO: Server: Service request from admin for shell
2025-06-25 17:41:57 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-25 17:41:57 INFO: Message encrypted, new length: 185
2025-06-25 17:41:57 INFO: Added length prefix for encrypted message, total length: 189
2025-06-25 17:41:57 INFO: Message sent successfully
2025-06-25 17:41:57 INFO: Server: Service shell accepted for admin
2025-06-25 17:42:00 INFO: Received message: SHELL_COMMAND
2025-06-25 17:42:00 INFO: Server: Executing shell command: 'ls' for user: admin
2025-06-25 17:42:00 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-25 17:42:00 INFO: Sending message: SHELL_RESULT, length: 397
2025-06-25 17:42:00 INFO: Message encrypted, new length: 425
2025-06-25 17:42:00 INFO: Added length prefix for encrypted message, total length: 429
2025-06-25 17:42:00 INFO: Message sent successfully
2025-06-25 17:42:00 INFO: Sent SHELL_RESULT message to client.
2025-06-25 17:42:04 INFO: Received message: SHELL_COMMAND
2025-06-25 17:42:04 INFO: Server: Executing shell command: 'pwd' for user: admin
2025-06-25 17:42:04 INFO: Command result: exitCode=0, stdout='/Users/tilman
', stderr=''
2025-06-25 17:42:04 INFO: Sending message: SHELL_RESULT, length: 288
2025-06-25 17:42:04 INFO: Message encrypted, new length: 316
2025-06-25 17:42:04 INFO: Added length prefix for encrypted message, total length: 320
2025-06-25 17:42:04 INFO: Message sent successfully
2025-06-25 17:42:04 INFO: Sent SHELL_RESULT message to client.
2025-06-25 17:44:04 INFO: Server: Starting client connection handler for 127.0.0.1:49590
2025-06-25 17:44:04 INFO: Server: Initializing protocol handler
2025-06-25 17:44:04 INFO: Server: Protocol handler initialized
2025-06-25 17:44:04 INFO: Server: Starting key exchange
2025-06-25 17:44:04 INFO: Server: Received key exchange init from null
2025-06-25 17:44:04 INFO: Server: Received key exchange init from null
2025-06-25 17:44:04 INFO: Server: Initializing DH key exchange
2025-06-25 17:44:04 INFO: Server: Generated DH key pair
2025-06-25 17:44:04 INFO: Server: Set client's public key
2025-06-25 17:44:04 INFO: Server: Computing shared secret
2025-06-25 17:44:04 INFO: Server: Computed shared secret, length: 256
2025-06-25 17:44:04 INFO: Server: Initializing symmetric encryption
2025-06-25 17:44:04 INFO: Server: Initialized symmetric encryption
2025-06-25 17:44:04 INFO: Server: Creating key exchange reply message
2025-06-25 17:44:04 INFO: Server: Created reply message, signing DH public key
2025-06-25 17:44:04 INFO: Server: Starting RSA signature generation
2025-06-25 17:44:04 INFO: Server: RSA signature generated, length: 256
2025-06-25 17:44:04 INFO: Server: Sending key exchange reply
2025-06-25 17:44:04 INFO: Sending message: KEY_EXCHANGE_REPLY, length: 1783
2025-06-25 17:44:04 INFO: Message sent successfully
2025-06-25 17:44:04 INFO: Server: Key exchange reply sent successfully
2025-06-25 17:44:04 INFO: Server: Key exchange completed successfully
2025-06-25 17:44:04 INFO: Server: Enabling encryption
2025-06-25 17:44:04 INFO: Encryption and HMAC enabled - subsequent messages will be encrypted/decrypted and authenticated
2025-06-25 17:44:04 INFO: Encryption and HMAC enabled in protocol handler
2025-06-25 17:44:04 INFO: Server: Key exchange completed successfully
2025-06-25 17:44:04 INFO: Server: Starting authentication
2025-06-25 17:44:04 INFO: Received message: AUTH_REQUEST
2025-06-25 17:44:04 INFO: Server: Authentication request from admin using dual
2025-06-25 17:44:04 INFO: Authentication attempt for user: admin, type: dual
2025-06-25 17:44:04 INFO: User existence check for 'admin': true
2025-06-25 17:44:04 INFO: User validation passed for: admin
2025-06-25 17:44:04 INFO: Attempting dual authentication (password + public key) for: admin
2025-06-25 17:44:04 INFO: DualAuth: password present: true
2025-06-25 17:44:04 INFO: DualAuth: publicKey present: true
2025-06-25 17:44:04 INFO: DualAuth: signature present: true
2025-06-25 17:44:04 INFO: DualAuth: sessionData present: true
2025-06-25 17:44:04 INFO: PasswordAuth: Verifying password for user: admin
2025-06-25 17:44:04 INFO: PasswordAuth: Checking if user exists: admin
2025-06-25 17:44:04 INFO: PasswordAuth: User exists, verifying password for: admin
2025-06-25 17:44:04 INFO: UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
2025-06-25 17:44:04 INFO: PasswordAuth: Password verification result for admin: true
2025-06-25 17:44:04 INFO: PasswordAuth: Password authentication result for admin: true
2025-06-25 17:44:04 INFO: DualAuth: Password authentication succeeded for user: admin
2025-06-25 17:44:04 INFO: PublicKeyAuth: publicKey present: true
2025-06-25 17:44:04 INFO: PublicKeyAuth: signature present: true
2025-06-25 17:44:04 INFO: PublicKeyAuth: sessionData present: true
2025-06-25 17:44:04 INFO: PublicKeyAuth: Created public key from string
2025-06-25 17:44:04 INFO: PublicKeyAuth: Decoded signature, length: 256
2025-06-25 17:44:04 INFO: PublicKeyAuth: Decoded session data, length: 36
2025-06-25 17:44:04 INFO: PublicKeyAuth: Found 4 authorized keys for user: admin
2025-06-25 17:44:04 INFO: PublicKeyAuth: Key match found!
2025-06-25 17:44:04 INFO: PublicKeyAuth: Signature verification result: true
2025-06-25 17:44:04 INFO: PublicKeyAuth: public key auth result: true
2025-06-25 17:44:04 INFO: DualAuth: Public key authentication succeeded for user: admin
2025-06-25 17:44:04 INFO: DualAuth: Dual authentication successful for user: admin
2025-06-25 17:44:04 INFO: Sending message: AUTH_SUCCESS, length: 269
2025-06-25 17:44:04 INFO: Message encrypted, new length: 297
2025-06-25 17:44:04 INFO: Added length prefix for encrypted message, total length: 301
2025-06-25 17:44:04 INFO: Message sent successfully
2025-06-25 17:44:04 INFO: Server: Authentication SUCCESS for admin: Authentication successful
2025-06-25 17:44:04 INFO: Server: Authentication completed successfully
2025-06-25 17:44:04 INFO: Server: Starting service request handling
2025-06-25 17:44:11 INFO: Received message: SERVICE_REQUEST
2025-06-25 17:44:11 INFO: Server: Service request from admin for shell
2025-06-25 17:44:11 INFO: Sending message: SERVICE_ACCEPT, length: 157
2025-06-25 17:44:11 INFO: Message encrypted, new length: 185
2025-06-25 17:44:11 INFO: Added length prefix for encrypted message, total length: 189
2025-06-25 17:44:11 INFO: Message sent successfully
2025-06-25 17:44:11 INFO: Server: Service shell accepted for admin
2025-06-25 17:44:13 INFO: Received message: SHELL_COMMAND
2025-06-25 17:44:13 INFO: Server: Executing shell command: 'ls' for user: admin
2025-06-25 17:44:13 INFO: Command result: exitCode=0, stdout='Applications
com~apple~CloudDocs
Desktop
Documents
Downloads
iCloud
Library
Movies
Music
Pictures
Public
Zotero
', stderr=''
2025-06-25 17:44:13 INFO: Sending message: SHELL_RESULT, length: 397
2025-06-25 17:44:13 INFO: Message encrypted, new length: 425
2025-06-25 17:44:13 INFO: Added length prefix for encrypted message, total length: 429
2025-06-25 17:44:13 INFO: Message sent successfully
2025-06-25 17:44:13 INFO: Sent SHELL_RESULT message to client.
2025-06-25 17:44:19 INFO: Received message: SHELL_COMMAND
2025-06-25 17:44:19 INFO: Server: Executing shell command: 'pwd' for user: admin
2025-06-25 17:44:19 INFO: Command result: exitCode=0, stdout='/Users/tilman
', stderr=''
2025-06-25 17:44:19 INFO: Sending message: SHELL_RESULT, length: 288
2025-06-25 17:44:19 INFO: Message encrypted, new length: 316
2025-06-25 17:44:19 INFO: Added length prefix for encrypted message, total length: 320
2025-06-25 17:44:19 INFO: Message sent successfully
2025-06-25 17:44:19 INFO: Sent SHELL_RESULT message to client.
2025-06-25 17:56:11 INFO: Client disconnected gracefully (end of stream)
2025-06-25 17:56:11 ERROR: Error in handleServiceRequests: Client disconnected gracefully
2025-06-25 17:56:11 INFO: Server: Cleaning up client connection for 127.0.0.1:49590
2025-06-25 17:56:11 INFO: Server: Cleaning up connection for 127.0.0.1:49590 (user: admin)
2025-06-25 17:56:11 INFO: Protocol handler closed
2025-06-25 23:59:29 INFO: Shutdown signal received
2025-06-25 23:59:29 INFO: SSHServerController: Stopping server
2025-06-25 23:59:29 INFO: SSHServerModel: Stopping server
