[2025-06-23 11:58:01] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] fromPacket: checksum = -1299791380
[2025-06-23 11:58:24] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Encrypted message length: 838
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Read 838 bytes for encrypted message body
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 838
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 810
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] fromPacket: restLength = 806
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] fromPacket: checksum = -1279952034
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Authentication attempt for user: tilman, type: dual
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] User existence check for 'tilman': true
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] User validation passed for: tilman
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Verifying password for user: tilman
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: tilman
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for tilman: true
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Password authentication result for tilman: true
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Dual authentication successful for user: tilman
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 11:58:25] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 12:04:36] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-23 12:04:36] [INFO] [pool-1-thread-1] Client disconnected gracefully (end of stream)
[2025-06-23 12:04:36] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: checksum = 1658573650
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Encrypted message length: 838
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Read 838 bytes for encrypted message body
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 838
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 810
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: restLength = 806
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] fromPacket: checksum = -908108324
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Authentication attempt for user: tilman, type: dual
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] User existence check for 'tilman': true
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] User validation passed for: tilman
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Verifying password for user: tilman
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: tilman
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for tilman: true
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Password authentication result for tilman: true
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Dual authentication successful for user: tilman
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 12:04:54] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Encrypted message length: 99
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Read 99 bytes for encrypted message body
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 99
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 71
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: restLength = 67
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 62 (restLength=67 - 5)
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: checksum = 60332742
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] File upload request from tilman: lel_lel.txt (43 bytes)
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Sending message: FILE_ACK, length: 82
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Message encrypted, new length: 110
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 114
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Encrypted message length: 153
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Read 153 bytes for encrypted message body
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 153
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 125
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: restLength = 121
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: parsed message type = FILE_DATA
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 116 (restLength=121 - 5)
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] fromPacket: checksum = -1480177218
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Received encrypted message: FILE_DATA
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Received chunk 1 from tilman, bytes: 43/43, last: true
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Sending message: FILE_ACK, length: 97
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Message encrypted, new length: 125
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 129
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] File upload completed for tilman: lel_lel.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/tilman/lel_lel_downi.txt
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 12:05:11] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 12:09:49] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-23 12:09:49] [INFO] [pool-1-thread-2] Client disconnected gracefully (end of stream)
[2025-06-23 12:09:49] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: checksum = 547815170
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Encrypted message length: 838
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Read 838 bytes for encrypted message body
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 838
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 810
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: restLength = 806
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] fromPacket: checksum = 1006106292
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Authentication attempt for user: tilman, type: dual
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] User existence check for 'tilman': true
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] User validation passed for: tilman
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Verifying password for user: tilman
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] PasswordAuth: Checking if user exists: tilman
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] PasswordAuth: Password verification result for tilman: true
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Password authentication result for tilman: true
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Dual authentication successful for user: tilman
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Message encrypted, new length: 84
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 88
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 12:10:09] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 12:13:18] [INFO] [pool-1-thread-3] Read -1 bytes for encrypted message length
[2025-06-23 12:13:18] [INFO] [pool-1-thread-3] Client disconnected gracefully (end of stream)
[2025-06-23 12:13:18] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Read 4 bytes for message length
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Message length: 787
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Read 787 bytes for message body (expected 787)
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Raw message type byte: 1
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] fromPacket: restLength = 787
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] fromPacket: checksum = 1484300317
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Received message: KEY_EXCHANGE_INIT
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 12:13:35] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Encrypted message length: 838
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Read 838 bytes for encrypted message body
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 838
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 810
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] fromPacket: restLength = 806
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] fromPacket: checksum = -343322332
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Received encrypted message: AUTH_REQUEST
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Authentication attempt for user: tilman, type: dual
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] User existence check for 'tilman': true
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] User validation passed for: tilman
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Verifying password for user: tilman
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] PasswordAuth: Checking if user exists: tilman
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] PasswordAuth: Password verification result for tilman: true
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Password authentication result for tilman: true
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Dual authentication successful for user: tilman
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Message encrypted, new length: 84
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 88
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 12:13:36] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Encrypted message length: 105
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Read 105 bytes for encrypted message body
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 105
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 77
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: restLength = 73
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 68 (restLength=73 - 5)
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: checksum = 1592938662
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] File upload request from tilman: test_lel.txt (35 bytes)
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Sending message: FILE_ACK, length: 83
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Message encrypted, new length: 111
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 115
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Encrypted message length: 142
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Read 142 bytes for encrypted message body
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 142
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 114
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: restLength = 110
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: parsed message type = FILE_DATA
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 105 (restLength=110 - 5)
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] fromPacket: checksum = 278226739
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Received encrypted message: FILE_DATA
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Received chunk 1 from tilman, bytes: 35/35, last: true
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Sending message: FILE_ACK, length: 98
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Message encrypted, new length: 126
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 130
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] File upload completed for tilman: test_lel.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/tilman/test_lel_downieeee.txt
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 12:13:48] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 12:17:26] [INFO] [pool-1-thread-4] Read -1 bytes for encrypted message length
[2025-06-23 12:17:26] [INFO] [pool-1-thread-4] Client disconnected gracefully (end of stream)
[2025-06-23 12:17:26] [INFO] [pool-1-thread-4] Protocol handler closed
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Read 4 bytes for message length
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Message length: 787
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Read 787 bytes for message body (expected 787)
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Raw message type byte: 1
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: restLength = 787
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: checksum = -285731406
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Received message: KEY_EXCHANGE_INIT
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Encrypted message length: 838
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Read 838 bytes for encrypted message body
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 838
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 810
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: restLength = 806
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] fromPacket: checksum = -2018780756
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Received encrypted message: AUTH_REQUEST
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Authentication attempt for user: tilman, type: dual
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] User existence check for 'tilman': true
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] User validation passed for: tilman
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Verifying password for user: tilman
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] PasswordAuth: Checking if user exists: tilman
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] PasswordAuth: Password verification result for tilman: true
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Password authentication result for tilman: true
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Dual authentication successful for user: tilman
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Message encrypted, new length: 84
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 88
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 12:17:40] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Encrypted message length: 98
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Read 98 bytes for encrypted message body
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 98
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 70
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: restLength = 66
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 61 (restLength=66 - 5)
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: checksum = 969358964
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] File upload request from tilman: test_lel.txt (35 bytes)
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Sending message: FILE_ACK, length: 83
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Message encrypted, new length: 111
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 115
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Encrypted message length: 142
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Read 142 bytes for encrypted message body
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 142
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 114
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: restLength = 110
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: parsed message type = FILE_DATA
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 105 (restLength=110 - 5)
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] fromPacket: checksum = 278226739
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Received encrypted message: FILE_DATA
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Received chunk 1 from tilman, bytes: 35/35, last: true
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Sending message: FILE_ACK, length: 98
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Message encrypted, new length: 126
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 130
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] File upload completed for tilman: test_lel.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/tilman/test_lelHey.txt
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 12:17:51] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 12:21:55] [INFO] [pool-1-thread-5] Read -1 bytes for encrypted message length
[2025-06-23 12:21:55] [INFO] [pool-1-thread-5] Client disconnected gracefully (end of stream)
[2025-06-23 12:21:55] [INFO] [pool-1-thread-5] Protocol handler closed
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Read 4 bytes for message length
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Message length: 787
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Read 787 bytes for message body (expected 787)
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Raw message type byte: 1
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] fromPacket: restLength = 787
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] fromPacket: checksum = 1164315754
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Received message: KEY_EXCHANGE_INIT
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 12:22:11] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Encrypted message length: 838
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Read 838 bytes for encrypted message body
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 838
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 810
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] fromPacket: restLength = 806
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] fromPacket: checksum = -980736318
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Received encrypted message: AUTH_REQUEST
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Authentication attempt for user: tilman, type: dual
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] User existence check for 'tilman': true
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] User validation passed for: tilman
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Verifying password for user: tilman
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] PasswordAuth: Checking if user exists: tilman
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] PasswordAuth: Password verification result for tilman: true
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Password authentication result for tilman: true
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Dual authentication successful for user: tilman
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Message encrypted, new length: 84
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 88
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 12:22:12] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Encrypted message length: 94
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Read 94 bytes for encrypted message body
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 94
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 66
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: restLength = 62
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 57 (restLength=62 - 5)
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: checksum = -1203475956
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] File upload request from tilman: test_lelHey.txt (35 bytes)
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Sending message: FILE_ACK, length: 86
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Message encrypted, new length: 114
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 118
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Encrypted message length: 145
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Read 145 bytes for encrypted message body
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 145
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 117
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: restLength = 113
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: parsed message type = FILE_DATA
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 108 (restLength=113 - 5)
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] fromPacket: checksum = -412718759
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Received encrypted message: FILE_DATA
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Received chunk 1 from tilman, bytes: 35/35, last: true
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Sending message: FILE_ACK, length: 101
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Message encrypted, new length: 129
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 133
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] File upload completed for tilman: test_lelHey.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/tilman/test.txt
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 12:22:23] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Encrypted message length: 37
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Read 37 bytes for encrypted message body
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 37
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 9
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] fromPacket: restLength = 5
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] fromPacket: checksum = 0
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Received encrypted message: RELOAD_USERS
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Reloading user database...
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] User database reloaded successfully
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Message encrypted, new length: 49
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 53
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 12:23:33] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 12:43:28] [INFO] [pool-1-thread-6] Read -1 bytes for encrypted message length
[2025-06-23 12:43:28] [INFO] [pool-1-thread-6] Client disconnected gracefully (end of stream)
[2025-06-23 12:43:28] [INFO] [pool-1-thread-6] Protocol handler closed
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Read 4 bytes for message length
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Message length: 787
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Read 787 bytes for message body (expected 787)
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Raw message type byte: 1
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: restLength = 787
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: checksum = -822043663
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Received message: KEY_EXCHANGE_INIT
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Encrypted message length: 838
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Read 838 bytes for encrypted message body
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 838
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 810
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: restLength = 806
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] fromPacket: checksum = 233628557
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Received encrypted message: AUTH_REQUEST
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Authentication attempt for user: tilman, type: dual
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] User existence check for 'tilman': true
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] User validation passed for: tilman
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Verifying password for user: tilman
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] PasswordAuth: Checking if user exists: tilman
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] PasswordAuth: Password verification result for tilman: true
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Password authentication result for tilman: true
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Dual authentication successful for user: tilman
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Message encrypted, new length: 84
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Added length prefix for encrypted message, total length: 88
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 12:43:46] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Encrypted message length: 37
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Read 37 bytes for encrypted message body
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 37
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 9
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] fromPacket: restLength = 5
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] fromPacket: checksum = 0
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Received encrypted message: RELOAD_USERS
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Reloading user database...
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] User database reloaded successfully
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Message encrypted, new length: 49
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Added length prefix for encrypted message, total length: 53
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 12:43:59] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Encrypted message length: 37
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Read 37 bytes for encrypted message body
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 37
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 9
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] fromPacket: restLength = 5
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] fromPacket: checksum = 0
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Received encrypted message: RELOAD_USERS
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Reloading user database...
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] User database reloaded successfully
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Message encrypted, new length: 49
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Added length prefix for encrypted message, total length: 53
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 12:44:32] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Encrypted message length: 37
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Read 37 bytes for encrypted message body
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 37
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 9
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] fromPacket: restLength = 5
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] fromPacket: checksum = 0
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Received encrypted message: RELOAD_USERS
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Reloading user database...
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] User database reloaded successfully
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Message encrypted, new length: 49
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Added length prefix for encrypted message, total length: 53
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 12:44:42] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 12:44:55] [INFO] [pool-1-thread-7] Read -1 bytes for encrypted message length
[2025-06-23 12:44:55] [INFO] [pool-1-thread-7] Client disconnected gracefully (end of stream)
[2025-06-23 12:44:55] [INFO] [pool-1-thread-7] Protocol handler closed
