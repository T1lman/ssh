[2025-06-22 19:58:43] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message length: 783
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Read 783 bytes for message body (expected 783)
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4A 6A 43 
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: restLength = 783
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 778 (restLength=783 - 5)
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: checksum = -235143285
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Encrypted message length: 83
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Read 83 bytes for encrypted message body
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 83
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 55
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: restLength = 51
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: checksum = -1986542933
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Authentication attempt for user: test, type: password
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] User existence check for 'test': true
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] User validation passed for: test
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Attempting password authentication for: test
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Verifying password for user: test
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: test
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: test
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for test: true
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Password authentication result for test: true
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Encrypted message length: 79
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Read 79 bytes for encrypted message body
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 79
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 51
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] fromPacket: restLength = 47
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] fromPacket: checksum = 1807766422
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 19:59:50] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 19:59:52] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-22 19:59:52] [ERROR] [pool-1-thread-1] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 19:59:52] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 19:59:53] [INFO] [Thread-0] Shutdown signal received
