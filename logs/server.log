[2025-06-23 00:47:55] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: checksum = 1545894742
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Encrypted message length: 837
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Read 837 bytes for encrypted message body
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 837
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 809
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: restLength = 805
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] fromPacket: checksum = -261366724
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Authentication attempt for user: test, type: dual
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] User existence check for 'test': true
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] User validation passed for: test
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: test
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Verifying password for user: test
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: test
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: test
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for test: true
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Password authentication result for test: true
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Dual authentication successful for user: test
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:48:21] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Encrypted message length: 80
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Read 80 bytes for encrypted message body
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 80
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 52
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] fromPacket: restLength = 48
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 43 (restLength=48 - 5)
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] fromPacket: checksum = 984364393
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:48:26] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Encrypted message length: 80
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Read 80 bytes for encrypted message body
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 80
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 52
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] fromPacket: restLength = 48
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 43 (restLength=48 - 5)
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] fromPacket: checksum = -1350269221
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 81
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Message encrypted, new length: 109
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 113
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:48:29] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:48:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:48:34] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-23 00:48:34] [INFO] [pool-1-thread-1] Client disconnected gracefully (end of stream)
[2025-06-23 00:48:34] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 00:49:30] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: checksum = 841879741
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Encrypted message length: 837
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Read 837 bytes for encrypted message body
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 837
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 809
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: restLength = 805
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] fromPacket: checksum = -273164842
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: dual
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: test
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Dual authentication successful for user: test
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:49:31] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] Encrypted message length: 79
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] Read 79 bytes for encrypted message body
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 79
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 51
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] fromPacket: restLength = 47
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] fromPacket: checksum = 1807766422
[2025-06-23 00:49:41] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:49:42] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 179
[2025-06-23 00:49:42] [INFO] [pool-1-thread-2] Message encrypted, new length: 207
[2025-06-23 00:49:42] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 211
[2025-06-23 00:49:42] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:49:42] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:49:42] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Encrypted message length: 89
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Read 89 bytes for encrypted message body
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 89
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 61
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 57
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 52 (restLength=57 - 5)
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -1584015345
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 77
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 105
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 109
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:49:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] Encrypted message length: 89
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] Read 89 bytes for encrypted message body
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 89
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 61
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] fromPacket: restLength = 57
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 52 (restLength=57 - 5)
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] fromPacket: checksum = -45720414
[2025-06-23 00:49:57] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:49:59] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 407
[2025-06-23 00:49:59] [INFO] [pool-1-thread-2] Message encrypted, new length: 435
[2025-06-23 00:49:59] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 439
[2025-06-23 00:49:59] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:49:59] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:49:59] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Encrypted message length: 92
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Read 92 bytes for encrypted message body
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 92
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 64
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] fromPacket: restLength = 60
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 55 (restLength=60 - 5)
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] fromPacket: checksum = -1816395058
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 67
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Message encrypted, new length: 95
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 99
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:50:09] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Encrypted message length: 79
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Read 79 bytes for encrypted message body
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 79
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 51
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] fromPacket: restLength = 47
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] fromPacket: checksum = 1807766422
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 179
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Message encrypted, new length: 207
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 211
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:50:15] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Encrypted message length: 79
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Read 79 bytes for encrypted message body
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 79
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 51
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] fromPacket: restLength = 47
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] fromPacket: checksum = 1807766422
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 179
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Message encrypted, new length: 207
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 211
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:50:23] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Encrypted message length: 37
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Read 37 bytes for encrypted message body
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 37
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 9
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: restLength = 5
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: checksum = 0
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Received encrypted message: ERROR
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Encrypted message length: 37
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Read 37 bytes for encrypted message body
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 37
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 9
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: restLength = 5
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] fromPacket: checksum = 0
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Received encrypted message: ERROR
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Client disconnected gracefully (end of stream)
[2025-06-23 00:50:31] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 00:50:50] [INFO] [Thread-0] Shutdown signal received
[2025-06-23 00:51:38] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: checksum = 1460153648
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Encrypted message length: 839
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Read 839 bytes for encrypted message body
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 839
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 811
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: restLength = 807
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 802 (restLength=807 - 5)
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] fromPacket: checksum = -501962751
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: dual
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: admin
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Dual authentication successful for user: admin
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:52:07] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Received encrypted message: DISCONNECT
[2025-06-23 00:52:17] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: checksum = 1116171319
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Encrypted message length: 837
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Read 837 bytes for encrypted message body
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 837
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 809
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: restLength = 805
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] fromPacket: checksum = 60957905
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: dual
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: test
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Dual authentication successful for user: test
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:52:38] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Encrypted message length: 37
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Read 37 bytes for encrypted message body
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 37
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 9
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] fromPacket: restLength = 5
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] fromPacket: checksum = 0
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Received encrypted message: DISCONNECT
[2025-06-23 00:52:42] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: checksum = -13474324
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Encrypted message length: 837
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Read 837 bytes for encrypted message body
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 837
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 809
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: restLength = 805
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] fromPacket: checksum = -250718583
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Authentication attempt for user: test, type: dual
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] User existence check for 'test': true
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] User validation passed for: test
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Attempting dual authentication (password + public key) for: test
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Verifying password for user: test
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] PasswordAuth: Checking if user exists: test
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] PasswordAuth: User exists, verifying password for: test
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] PasswordAuth: Password verification result for test: true
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Password authentication result for test: true
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Dual authentication successful for user: test
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Message encrypted, new length: 84
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 00:53:11] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Encrypted message length: 37
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Read 37 bytes for encrypted message body
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 37
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 9
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] fromPacket: restLength = 5
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] fromPacket: checksum = 0
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Received encrypted message: DISCONNECT
[2025-06-23 00:54:24] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-23 00:54:40] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Read 4 bytes for message length
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Message length: 787
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Read 787 bytes for message body (expected 787)
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Raw message type byte: 1
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: restLength = 787
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: checksum = -1978092134
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Encrypted message length: 838
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Read 838 bytes for encrypted message body
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 838
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 810
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: restLength = 806
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] fromPacket: checksum = -1972130158
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Authentication attempt for user: tilman, type: dual
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] User existence check for 'tilman': false
[2025-06-23 00:54:41] [ERROR] [pool-1-thread-4] User validation failed for: tilman
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Sending message: AUTH_FAILURE, length: 53
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Message encrypted, new length: 81
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 85
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 00:54:41] [INFO] [pool-1-thread-4] Protocol handler closed
[2025-06-23 00:55:19] [INFO] [Thread-0] Shutdown signal received
[2025-06-23 00:55:34] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: checksum = 822530412
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Encrypted message length: 838
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Read 838 bytes for encrypted message body
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 838
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 810
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: restLength = 806
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] fromPacket: checksum = 225854167
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Authentication attempt for user: tilman, type: dual
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] User existence check for 'tilman': true
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] User validation passed for: tilman
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Verifying password for user: tilman
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: tilman
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for tilman: true
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Password authentication result for tilman: true
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Dual authentication successful for user: tilman
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:56:01] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Encrypted message length: 79
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Read 79 bytes for encrypted message body
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 79
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 51
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] fromPacket: restLength = 47
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] fromPacket: checksum = 1807766422
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 00:56:09] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Received encrypted message: DISCONNECT
[2025-06-23 00:56:16] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: checksum = -1427833581
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Encrypted message length: 838
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Read 838 bytes for encrypted message body
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 838
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 810
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: restLength = 806
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] fromPacket: checksum = 1961771936
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Authentication attempt for user: tilman, type: dual
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] User existence check for 'tilman': true
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] User validation passed for: tilman
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Verifying password for user: tilman
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: tilman
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for tilman: true
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Password authentication result for tilman: true
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Dual authentication successful for user: tilman
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 00:56:35] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 00:56:39] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-23 00:56:39] [INFO] [pool-1-thread-2] Client disconnected gracefully (end of stream)
[2025-06-23 00:56:39] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 01:01:48] [INFO] [Thread-0] Shutdown signal received
[2025-06-23 01:01:56] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: checksum = -2133133693
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Encrypted message length: 837
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Read 837 bytes for encrypted message body
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 837
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 809
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: restLength = 805
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] fromPacket: checksum = -1429851048
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Authentication attempt for user: test, type: dual
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] User existence check for 'test': true
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] User validation passed for: test
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Verifying password for user: test
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: test
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for test: true
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Password authentication result for test: true
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Dual authentication successful for user: test
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:02:20] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Received encrypted message: RELOAD_USERS
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Reloading user database...
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] User database reloaded successfully
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Message encrypted, new length: 49
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:02:30] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Received encrypted message: DISCONNECT
[2025-06-23 01:02:41] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: checksum = 2063467935
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Encrypted message length: 835
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Read 835 bytes for encrypted message body
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 835
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 807
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: restLength = 803
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 798 (restLength=803 - 5)
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] fromPacket: checksum = 736598424
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Authentication attempt for user: lel, type: dual
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] User existence check for 'lel': true
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] User validation passed for: lel
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: lel
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Verifying password for user: lel
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: lel
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: lel
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] UserStore: Password verification for lel - Stored hash: aa0be1cfae626f5d8b03825011df6261e282ae8f3725725e886d190eef148841, Input hash: aa0be1cfae626f5d8b03825011df6261e282ae8f3725725e886d190eef148841, Matches: true
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for lel: true
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Password authentication result for lel: true
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Dual authentication successful for user: lel
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:03:01] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Encrypted message length: 86
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Read 86 bytes for encrypted message body
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 86
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 58
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] fromPacket: restLength = 54
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 49 (restLength=54 - 5)
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] fromPacket: checksum = -829166184
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 72
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Message encrypted, new length: 100
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 104
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:03:07] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Encrypted message length: 37
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Read 37 bytes for encrypted message body
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 37
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 9
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] fromPacket: restLength = 5
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] fromPacket: checksum = 0
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Received encrypted message: DISCONNECT
[2025-06-23 01:05:29] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: checksum = 725798621
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Encrypted message length: 837
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Read 837 bytes for encrypted message body
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 837
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 809
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: restLength = 805
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] fromPacket: checksum = -406317957
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Authentication attempt for user: test, type: dual
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] User existence check for 'test': true
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] User validation passed for: test
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Verifying password for user: test
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] PasswordAuth: Checking if user exists: test
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] PasswordAuth: Password verification result for test: true
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Password authentication result for test: true
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Dual authentication successful for user: test
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Message encrypted, new length: 84
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:05:48] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Encrypted message length: 37
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Read 37 bytes for encrypted message body
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 37
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 9
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] fromPacket: restLength = 5
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] fromPacket: checksum = 0
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Received encrypted message: RELOAD_USERS
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Reloading user database...
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] User database reloaded successfully
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Message encrypted, new length: 49
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:06:00] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Encrypted message length: 37
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Read 37 bytes for encrypted message body
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 37
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 9
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] fromPacket: restLength = 5
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] fromPacket: checksum = 0
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Received encrypted message: DISCONNECT
[2025-06-23 01:06:19] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-23 01:10:37] [INFO] [Thread-0] Shutdown signal received
[2025-06-23 01:10:45] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 01:11:10] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: checksum = 1618601917
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Encrypted message length: 839
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Read 839 bytes for encrypted message body
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 839
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 811
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 807
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 802 (restLength=807 - 5)
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] fromPacket: checksum = -455439535
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Authentication attempt for user: test3, type: dual
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] User existence check for 'test3': true
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] User validation passed for: test3
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: test3
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Verifying password for user: test3
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: test3
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: test3
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] UserStore: Password verification for test3 - Stored hash: fd61a03af4f77d870fc21e05e7e80678095c92d808cfb3b5c279ee04c74aca13, Input hash: fd61a03af4f77d870fc21e05e7e80678095c92d808cfb3b5c279ee04c74aca13, Matches: true
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for test3: true
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Password authentication result for test3: true
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Dual authentication successful for user: test3
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:11:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Received encrypted message: RELOAD_USERS
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Reloading user database...
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] User database reloaded successfully
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Message encrypted, new length: 49
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:11:54] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Received encrypted message: RELOAD_USERS
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Reloading user database...
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] User database reloaded successfully
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Message encrypted, new length: 49
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:12:05] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:12:29] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-23 01:12:29] [INFO] [pool-1-thread-1] Client disconnected gracefully (end of stream)
[2025-06-23 01:12:29] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: checksum = -571338451
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Encrypted message length: 837
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Read 837 bytes for encrypted message body
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 837
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 809
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: restLength = 805
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] fromPacket: checksum = 750748037
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: dual
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Dual authentication successful for user: test
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:13:57] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 01:14:07] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-23 01:14:07] [INFO] [pool-1-thread-2] Client disconnected gracefully (end of stream)
[2025-06-23 01:14:07] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: checksum = 958283905
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Encrypted message length: 837
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Read 837 bytes for encrypted message body
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 837
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 809
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 805
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] fromPacket: checksum = -1123205102
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Authentication attempt for user: test, type: dual
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] User existence check for 'test': true
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] User validation passed for: test
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Verifying password for user: test
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] PasswordAuth: Checking if user exists: test
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] PasswordAuth: Password verification result for test: true
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Password authentication result for test: true
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Dual authentication successful for user: test
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Message encrypted, new length: 84
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:14:36] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:14:48] [INFO] [pool-1-thread-3] Read -1 bytes for encrypted message length
[2025-06-23 01:14:48] [INFO] [pool-1-thread-3] Client disconnected gracefully (end of stream)
[2025-06-23 01:14:48] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Read 4 bytes for message length
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Message length: 787
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Read 787 bytes for message body (expected 787)
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Raw message type byte: 1
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: restLength = 787
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: checksum = 2046549835
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Encrypted message length: 837
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Read 837 bytes for encrypted message body
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 837
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 809
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: restLength = 805
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] fromPacket: checksum = -639471713
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Authentication attempt for user: test, type: dual
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] User existence check for 'test': true
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] User validation passed for: test
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Verifying password for user: test
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] PasswordAuth: Checking if user exists: test
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] PasswordAuth: Password verification result for test: true
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Password authentication result for test: true
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Dual authentication successful for user: test
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Message encrypted, new length: 84
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 01:16:27] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 01:17:23] [INFO] [pool-1-thread-4] Read -1 bytes for encrypted message length
[2025-06-23 01:17:23] [INFO] [pool-1-thread-4] Client disconnected gracefully (end of stream)
[2025-06-23 01:17:23] [INFO] [pool-1-thread-4] Protocol handler closed
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Read 4 bytes for message length
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Message length: 787
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Read 787 bytes for message body (expected 787)
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Raw message type byte: 1
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: restLength = 787
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: checksum = -783652202
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Encrypted message length: 837
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Read 837 bytes for encrypted message body
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 837
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 809
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: restLength = 805
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] fromPacket: checksum = 351207999
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Authentication attempt for user: test, type: dual
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] User existence check for 'test': true
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] User validation passed for: test
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Verifying password for user: test
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] PasswordAuth: Checking if user exists: test
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] PasswordAuth: Password verification result for test: true
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Password authentication result for test: true
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Dual authentication successful for user: test
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Message encrypted, new length: 84
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:17:52] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 01:17:58] [INFO] [pool-1-thread-5] Read -1 bytes for encrypted message length
[2025-06-23 01:17:58] [INFO] [pool-1-thread-5] Client disconnected gracefully (end of stream)
[2025-06-23 01:17:58] [INFO] [pool-1-thread-5] Protocol handler closed
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Read 4 bytes for message length
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Message length: 787
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Read 787 bytes for message body (expected 787)
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Raw message type byte: 1
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: restLength = 787
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: checksum = 2112576981
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Encrypted message length: 837
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Read 837 bytes for encrypted message body
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 837
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 809
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: restLength = 805
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] fromPacket: checksum = -1731658240
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Authentication attempt for user: test, type: dual
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] User existence check for 'test': true
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] User validation passed for: test
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Verifying password for user: test
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] PasswordAuth: Checking if user exists: test
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] PasswordAuth: Password verification result for test: true
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Password authentication result for test: true
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Dual authentication successful for user: test
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Message encrypted, new length: 84
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:18:42] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Encrypted message length: 37
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Read 37 bytes for encrypted message body
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 37
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 9
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] fromPacket: restLength = 5
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] fromPacket: checksum = 0
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Received encrypted message: DISCONNECT
[2025-06-23 01:18:48] [INFO] [pool-1-thread-6] Protocol handler closed
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Read 4 bytes for message length
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Message length: 787
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Read 787 bytes for message body (expected 787)
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Raw message type byte: 1
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: restLength = 787
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: checksum = -711112905
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Encrypted message length: 837
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Read 837 bytes for encrypted message body
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 837
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 809
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: restLength = 805
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] fromPacket: checksum = 409758779
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Authentication attempt for user: test, type: dual
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] User existence check for 'test': true
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] User validation passed for: test
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Verifying password for user: test
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] PasswordAuth: Checking if user exists: test
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] PasswordAuth: Password verification result for test: true
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Password authentication result for test: true
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Dual authentication successful for user: test
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Message encrypted, new length: 84
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 01:21:03] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 01:21:11] [INFO] [pool-1-thread-7] Read -1 bytes for encrypted message length
[2025-06-23 01:21:11] [INFO] [pool-1-thread-7] Client disconnected gracefully (end of stream)
[2025-06-23 01:21:11] [INFO] [pool-1-thread-7] Protocol handler closed
[2025-06-23 01:24:51] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Read 4 bytes for message length
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Message length: 787
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Read 787 bytes for message body (expected 787)
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Raw message type byte: 1
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: restLength = 787
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: checksum = 397675081
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Message sent successfully
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Reading encrypted message...
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Read 4 bytes for encrypted message length
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Encrypted message length: 837
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Read 837 bytes for encrypted message body
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Decrypting encrypted message, length: 837
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Message decrypted successfully, new length: 809
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: restLength = 805
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] fromPacket: checksum = -1066721096
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Authentication attempt for user: test, type: dual
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] User existence check for 'test': true
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] User validation passed for: test
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Verifying password for user: test
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] PasswordAuth: Checking if user exists: test
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] PasswordAuth: Password verification result for test: true
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Password authentication result for test: true
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Dual authentication successful for user: test
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Message encrypted, new length: 84
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Message sent successfully
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:24:52] [INFO] [pool-1-thread-8] Reading encrypted message...
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Read 4 bytes for encrypted message length
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Encrypted message length: 94
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Read 94 bytes for encrypted message body
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Decrypting encrypted message, length: 94
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Message decrypted successfully, new length: 66
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: restLength = 62
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 57 (restLength=62 - 5)
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: checksum = -1434304531
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] File upload request from test: lel.txt (43 bytes)
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Sending message: FILE_ACK, length: 78
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Message encrypted, new length: 106
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Added length prefix for encrypted message, total length: 110
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Message sent successfully
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Reading encrypted message...
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Read 4 bytes for encrypted message length
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Encrypted message length: 149
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Read 149 bytes for encrypted message body
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Decrypting encrypted message, length: 149
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Message decrypted successfully, new length: 121
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: restLength = 117
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: parsed message type = FILE_DATA
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] fromPacket: checksum = 2038719637
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Received encrypted message: FILE_DATA
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Received chunk 1 from test, bytes: 43/43, last: true
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Sending message: FILE_ACK, length: 93
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Message encrypted, new length: 121
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Added length prefix for encrypted message, total length: 125
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Message sent successfully
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] File upload completed for test: lel.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/test/lel_download.txt
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:25:52] [INFO] [pool-1-thread-8] Reading encrypted message...
[2025-06-23 01:28:48] [INFO] [pool-1-thread-8] Read -1 bytes for encrypted message length
[2025-06-23 01:28:48] [INFO] [pool-1-thread-8] Client disconnected gracefully (end of stream)
[2025-06-23 01:28:48] [INFO] [pool-1-thread-8] Protocol handler closed
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Read 4 bytes for message length
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Message length: 787
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Read 787 bytes for message body (expected 787)
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Raw message type byte: 1
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: restLength = 787
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: checksum = 2136914665
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Message sent successfully
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Reading encrypted message...
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Read 4 bytes for encrypted message length
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Encrypted message length: 838
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Read 838 bytes for encrypted message body
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Decrypting encrypted message, length: 838
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Message decrypted successfully, new length: 810
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: restLength = 806
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] fromPacket: checksum = 1585513903
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Authentication attempt for user: tilman, type: dual
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] User existence check for 'tilman': true
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] User validation passed for: tilman
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Verifying password for user: tilman
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] PasswordAuth: Checking if user exists: tilman
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] PasswordAuth: Password verification result for tilman: true
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Password authentication result for tilman: true
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Dual authentication successful for user: tilman
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Message encrypted, new length: 84
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Message sent successfully
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 01:29:18] [INFO] [pool-1-thread-9] Reading encrypted message...
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Read 4 bytes for encrypted message length
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Encrypted message length: 92
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Read 92 bytes for encrypted message body
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Decrypting encrypted message, length: 92
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Message decrypted successfully, new length: 64
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: restLength = 60
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 55 (restLength=60 - 5)
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: checksum = -1171466678
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] File upload request from tilman: lel.txt (43 bytes)
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Sending message: FILE_ACK, length: 78
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Message encrypted, new length: 106
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Added length prefix for encrypted message, total length: 110
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Message sent successfully
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Reading encrypted message...
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Read 4 bytes for encrypted message length
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Encrypted message length: 149
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Read 149 bytes for encrypted message body
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Decrypting encrypted message, length: 149
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Message decrypted successfully, new length: 121
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: restLength = 117
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: parsed message type = FILE_DATA
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] fromPacket: checksum = 2038719637
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Received encrypted message: FILE_DATA
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Received chunk 1 from tilman, bytes: 43/43, last: true
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Sending message: FILE_ACK, length: 93
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Message encrypted, new length: 121
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Added length prefix for encrypted message, total length: 125
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Message sent successfully
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] File upload completed for tilman: lel.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/tilman/lel_tilman.txt
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 01:29:33] [INFO] [pool-1-thread-9] Reading encrypted message...
[2025-06-23 01:33:09] [INFO] [pool-1-thread-9] Read -1 bytes for encrypted message length
[2025-06-23 01:33:09] [INFO] [pool-1-thread-9] Client disconnected gracefully (end of stream)
[2025-06-23 01:33:09] [INFO] [pool-1-thread-9] Protocol handler closed
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Read 4 bytes for message length
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Message length: 787
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Read 787 bytes for message body (expected 787)
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Raw message type byte: 1
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: restLength = 787
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: checksum = -264455932
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Encrypted message length: 838
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Read 838 bytes for encrypted message body
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 838
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 810
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: restLength = 806
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] fromPacket: checksum = 647552222
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Authentication attempt for user: tilman, type: dual
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] User existence check for 'tilman': true
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] User validation passed for: tilman
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Verifying password for user: tilman
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] PasswordAuth: Checking if user exists: tilman
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] PasswordAuth: Password verification result for tilman: true
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Password authentication result for tilman: true
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Dual authentication successful for user: tilman
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Message encrypted, new length: 84
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 01:33:29] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Encrypted message length: 89
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Read 89 bytes for encrypted message body
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 89
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 61
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: restLength = 57
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: parsed message type = FILE_UPLOAD_REQUEST
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 52 (restLength=57 - 5)
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: checksum = -2035739975
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Received encrypted message: FILE_UPLOAD_REQUEST
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] File upload request from tilman: lel.txt (43 bytes)
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Sending message: FILE_ACK, length: 78
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Message encrypted, new length: 106
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 110
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Encrypted message length: 149
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Read 149 bytes for encrypted message body
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 149
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 121
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: restLength = 117
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: parsed message type = FILE_DATA
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] fromPacket: checksum = 2038719637
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Received encrypted message: FILE_DATA
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Received chunk 1 from tilman, bytes: 43/43, last: true
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Sending message: FILE_ACK, length: 93
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Message encrypted, new length: 121
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 125
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] File upload completed for tilman: lel.txt -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/server/files/tilman/lel_lel.txt
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 01:33:50] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 01:34:04] [INFO] [pool-1-thread-10] Read -1 bytes for encrypted message length
[2025-06-23 01:34:04] [INFO] [pool-1-thread-10] Client disconnected gracefully (end of stream)
[2025-06-23 01:34:04] [INFO] [pool-1-thread-10] Protocol handler closed
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: checksum = -54719133
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Encrypted message length: 837
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Read 837 bytes for encrypted message body
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 837
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 809
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: restLength = 805
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 800 (restLength=805 - 5)
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] fromPacket: checksum = -235900829
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Authentication attempt for user: test, type: dual
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] User existence check for 'test': true
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] User validation passed for: test
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: test
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Verifying password for user: test
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: test
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: test
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for test: true
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Password authentication result for test: true
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Dual authentication successful for user: test
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:36:56] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:37:02] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-23 01:37:02] [INFO] [pool-1-thread-1] Client disconnected gracefully (end of stream)
[2025-06-23 01:37:02] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 01:42:02] [INFO] [Thread-0] Shutdown signal received
[2025-06-23 01:42:13] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: checksum = 1453784540
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Encrypted message length: 838
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Read 838 bytes for encrypted message body
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 838
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 810
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: restLength = 806
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] fromPacket: checksum = -1005259933
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Authentication attempt for user: tilman, type: dual
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] User existence check for 'tilman': true
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] User validation passed for: tilman
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Verifying password for user: tilman
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: tilman
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for tilman: true
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Password authentication result for tilman: true
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Dual authentication successful for user: tilman
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:45:59] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Encrypted message length: 79
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Read 79 bytes for encrypted message body
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 79
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 51
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] fromPacket: restLength = 47
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] fromPacket: checksum = 1807766422
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:46:08] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Encrypted message length: 88
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Read 88 bytes for encrypted message body
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 88
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 60
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] fromPacket: restLength = 56
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 51 (restLength=56 - 5)
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] fromPacket: checksum = 572268494
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 73
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Message encrypted, new length: 101
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 105
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-23 01:46:13] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Encrypted message length: 37
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Read 37 bytes for encrypted message body
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 37
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 9
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] fromPacket: restLength = 5
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] fromPacket: checksum = 0
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Received encrypted message: DISCONNECT
[2025-06-23 01:46:30] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: checksum = -859368919
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Encrypted message length: 838
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Read 838 bytes for encrypted message body
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 838
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 810
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: restLength = 806
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] fromPacket: checksum = 1780306831
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Authentication attempt for user: user1, type: dual
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] User existence check for 'user1': true
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] User validation passed for: user1
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Attempting dual authentication (password + public key) for: user1
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Verifying password for user: user1
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: user1
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: user1
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] UserStore: Password verification for user1 - Stored hash: 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: false
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for user1: false
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Password authentication result for user1: false
[2025-06-23 01:49:14] [ERROR] [pool-1-thread-2] Password authentication failed for dual auth
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Sending message: AUTH_FAILURE, length: 53
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Message encrypted, new length: 81
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 85
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-23 01:49:14] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] fromPacket: checksum = 2098861318
[2025-06-23 01:51:51] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Encrypted message length: 838
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Read 838 bytes for encrypted message body
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 838
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 810
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] fromPacket: restLength = 806
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] fromPacket: checksum = -1405747751
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Authentication attempt for user: tilman, type: dual
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] User existence check for 'tilman': true
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] User validation passed for: tilman
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Verifying password for user: tilman
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] PasswordAuth: Checking if user exists: tilman
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] PasswordAuth: Password verification result for tilman: true
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Password authentication result for tilman: true
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Dual authentication successful for user: tilman
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Message encrypted, new length: 84
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:51:52] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Encrypted message length: 37
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Read 37 bytes for encrypted message body
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 37
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 9
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] fromPacket: restLength = 5
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] fromPacket: checksum = 0
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Received encrypted message: RELOAD_USERS
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Reloading user database...
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] User database reloaded successfully
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Message encrypted, new length: 49
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-23 01:52:06] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Encrypted message length: 37
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Read 37 bytes for encrypted message body
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 37
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 9
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] fromPacket: restLength = 5
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] fromPacket: checksum = 0
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Received encrypted message: DISCONNECT
[2025-06-23 01:52:26] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Read 4 bytes for message length
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Message length: 787
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Read 787 bytes for message body (expected 787)
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Raw message type byte: 1
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] fromPacket: restLength = 787
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] fromPacket: checksum = 2030016016
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-23 01:52:57] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-23 01:53:00] [INFO] [pool-1-thread-4] Read -1 bytes for encrypted message length
[2025-06-23 01:53:00] [INFO] [pool-1-thread-4] Client disconnected gracefully (end of stream)
[2025-06-23 01:53:00] [INFO] [pool-1-thread-4] Protocol handler closed
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Read 4 bytes for message length
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Message length: 787
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Read 787 bytes for message body (expected 787)
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Raw message type byte: 1
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: restLength = 787
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: checksum = 2068000955
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Encrypted message length: 839
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Read 839 bytes for encrypted message body
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 839
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 811
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: restLength = 807
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 802 (restLength=807 - 5)
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] fromPacket: checksum = -380966140
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Authentication attempt for user: admin, type: dual
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] User existence check for 'admin': true
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] User validation passed for: admin
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Attempting dual authentication (password + public key) for: admin
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Verifying password for user: admin
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] PasswordAuth: Checking if user exists: admin
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] PasswordAuth: User exists, verifying password for: admin
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] PasswordAuth: Password verification result for admin: true
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Password authentication result for admin: true
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Dual authentication successful for user: admin
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Message encrypted, new length: 84
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:54:37] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Encrypted message length: 87
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Read 87 bytes for encrypted message body
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 87
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 59
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] fromPacket: restLength = 55
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 50 (restLength=55 - 5)
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] fromPacket: checksum = 1823310657
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Received encrypted message: SHELL_COMMAND
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Sending message: SHELL_RESULT, length: 73
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Message encrypted, new length: 101
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 105
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:54:43] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Encrypted message length: 37
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Read 37 bytes for encrypted message body
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 37
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 9
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] fromPacket: restLength = 5
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] fromPacket: checksum = 0
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Received encrypted message: RELOAD_USERS
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Reloading user database...
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] User database reloaded successfully
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Message encrypted, new length: 49
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Message sent successfully
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Waiting to receive message...
[2025-06-23 01:54:53] [INFO] [pool-1-thread-5] Reading encrypted message...
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Read 4 bytes for encrypted message length
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Encrypted message length: 37
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Read 37 bytes for encrypted message body
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Decrypting encrypted message, length: 37
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Message decrypted successfully, new length: 9
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] fromPacket: restLength = 5
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] fromPacket: checksum = 0
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Received encrypted message: DISCONNECT
[2025-06-23 01:55:03] [INFO] [pool-1-thread-5] Protocol handler closed
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Read 4 bytes for message length
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Message length: 787
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Read 787 bytes for message body (expected 787)
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Raw message type byte: 1
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: restLength = 787
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: checksum = -792815210
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Encrypted message length: 839
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Read 839 bytes for encrypted message body
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 839
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 811
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: restLength = 807
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 802 (restLength=807 - 5)
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] fromPacket: checksum = -1993804227
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Authentication attempt for user: admin, type: dual
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] User existence check for 'admin': true
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] User validation passed for: admin
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Attempting dual authentication (password + public key) for: admin
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Verifying password for user: admin
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] PasswordAuth: Checking if user exists: admin
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] PasswordAuth: User exists, verifying password for: admin
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] PasswordAuth: Password verification result for admin: true
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Password authentication result for admin: true
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Dual authentication successful for user: admin
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Message encrypted, new length: 84
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:55:31] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Encrypted message length: 37
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Read 37 bytes for encrypted message body
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 37
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 9
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] fromPacket: restLength = 5
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] fromPacket: checksum = 0
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Received encrypted message: RELOAD_USERS
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Reloading user database...
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] User database reloaded successfully
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Message encrypted, new length: 49
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Added length prefix for encrypted message, total length: 53
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Message sent successfully
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Waiting to receive message...
[2025-06-23 01:55:37] [INFO] [pool-1-thread-6] Reading encrypted message...
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Read 4 bytes for encrypted message length
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Encrypted message length: 37
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Read 37 bytes for encrypted message body
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Decrypting encrypted message, length: 37
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Message decrypted successfully, new length: 9
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] fromPacket: restLength = 5
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] fromPacket: checksum = 0
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Received encrypted message: DISCONNECT
[2025-06-23 01:55:45] [INFO] [pool-1-thread-6] Protocol handler closed
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Read 4 bytes for message length
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Message length: 787
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Read 787 bytes for message body (expected 787)
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Raw message type byte: 1
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: restLength = 787
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: checksum = 238426922
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Encrypted message length: 838
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Read 838 bytes for encrypted message body
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 838
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 810
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: restLength = 806
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] fromPacket: checksum = -1349096758
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Authentication attempt for user: tilman, type: dual
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] User existence check for 'tilman': true
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] User validation passed for: tilman
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Verifying password for user: tilman
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] PasswordAuth: Checking if user exists: tilman
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] PasswordAuth: Password verification result for tilman: true
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Password authentication result for tilman: true
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Dual authentication successful for user: tilman
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Message encrypted, new length: 84
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Message sent successfully
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Waiting to receive message...
[2025-06-23 01:58:49] [INFO] [pool-1-thread-7] Reading encrypted message...
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Read 4 bytes for encrypted message length
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Encrypted message length: 37
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Read 37 bytes for encrypted message body
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Decrypting encrypted message, length: 37
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Message decrypted successfully, new length: 9
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] fromPacket: restLength = 5
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] fromPacket: checksum = 0
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Received encrypted message: DISCONNECT
[2025-06-23 01:58:52] [INFO] [pool-1-thread-7] Protocol handler closed
[2025-06-23 01:59:26] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Read 4 bytes for message length
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Message length: 787
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Read 787 bytes for message body (expected 787)
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Raw message type byte: 1
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: restLength = 787
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: checksum = -590464628
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Received message: KEY_EXCHANGE_INIT
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Message sent successfully
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Reading encrypted message...
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Read 4 bytes for encrypted message length
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Encrypted message length: 839
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Read 839 bytes for encrypted message body
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Decrypting encrypted message, length: 839
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Message decrypted successfully, new length: 811
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: restLength = 807
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 802 (restLength=807 - 5)
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] fromPacket: checksum = -78120228
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Received encrypted message: AUTH_REQUEST
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Authentication attempt for user: admin, type: dual
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] User existence check for 'admin': true
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] User validation passed for: admin
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Attempting dual authentication (password + public key) for: admin
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Verifying password for user: admin
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] PasswordAuth: Checking if user exists: admin
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] PasswordAuth: User exists, verifying password for: admin
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] PasswordAuth: Password verification result for admin: true
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Password authentication result for admin: true
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Dual authentication successful for user: admin
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Message encrypted, new length: 84
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Added length prefix for encrypted message, total length: 88
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Message sent successfully
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Waiting to receive message...
[2025-06-23 01:59:27] [INFO] [pool-1-thread-8] Reading encrypted message...
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Read 4 bytes for encrypted message length
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Encrypted message length: 37
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Read 37 bytes for encrypted message body
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Decrypting encrypted message, length: 37
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Message decrypted successfully, new length: 9
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] fromPacket: restLength = 5
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] fromPacket: parsed message type = DISCONNECT
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] fromPacket: checksum = 0
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Received encrypted message: DISCONNECT
[2025-06-23 01:59:29] [INFO] [pool-1-thread-8] Protocol handler closed
[2025-06-23 02:00:53] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Read 4 bytes for message length
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Message length: 787
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Read 787 bytes for message body (expected 787)
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Raw message type byte: 1
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: restLength = 787
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: checksum = -973262390
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Received message: KEY_EXCHANGE_INIT
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Message sent successfully
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Reading encrypted message...
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Read 4 bytes for encrypted message length
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Encrypted message length: 838
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Read 838 bytes for encrypted message body
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Decrypting encrypted message, length: 838
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Message decrypted successfully, new length: 810
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: restLength = 806
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 801 (restLength=806 - 5)
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] fromPacket: checksum = 1610814861
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Received encrypted message: AUTH_REQUEST
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Authentication attempt for user: tilman, type: dual
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] User existence check for 'tilman': true
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] User validation passed for: tilman
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Attempting dual authentication (password + public key) for: tilman
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Verifying password for user: tilman
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] PasswordAuth: Checking if user exists: tilman
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] PasswordAuth: User exists, verifying password for: tilman
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] UserStore: Password verification for tilman - Stored hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Input hash: 571d5b2882b8df135b9f3b50ab4fb722ba82b1f6bebe7b91163ab3208291f0ca, Matches: true
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] PasswordAuth: Password verification result for tilman: true
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Password authentication result for tilman: true
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Dual authentication successful for user: tilman
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Message encrypted, new length: 84
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Added length prefix for encrypted message, total length: 88
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Message sent successfully
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Waiting to receive message...
[2025-06-23 02:00:54] [INFO] [pool-1-thread-9] Reading encrypted message...
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Read 4 bytes for encrypted message length
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Encrypted message length: 37
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Read 37 bytes for encrypted message body
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Decrypting encrypted message, length: 37
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Message decrypted successfully, new length: 9
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] fromPacket: restLength = 5
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] fromPacket: parsed message type = DISCONNECT
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] fromPacket: checksum = 0
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Received encrypted message: DISCONNECT
[2025-06-23 02:01:05] [INFO] [pool-1-thread-9] Protocol handler closed
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Read 4 bytes for message length
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Message length: 787
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Read 787 bytes for message body (expected 787)
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Raw message type byte: 1
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: restLength = 787
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: checksum = -1783207442
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Received message: KEY_EXCHANGE_INIT
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Sending message: KEY_EXCHANGE_REPLY, length: 1200
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Encrypted message length: 839
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Read 839 bytes for encrypted message body
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 839
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 811
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: restLength = 807
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 802 (restLength=807 - 5)
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] fromPacket: checksum = 1676805930
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Received encrypted message: AUTH_REQUEST
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Authentication attempt for user: admin, type: dual
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] User existence check for 'admin': true
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] User validation passed for: admin
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Attempting dual authentication (password + public key) for: admin
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Verifying password for user: admin
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] PasswordAuth: Checking if user exists: admin
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] PasswordAuth: User exists, verifying password for: admin
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] PasswordAuth: Password verification result for admin: true
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Password authentication result for admin: true
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Dual authentication successful for user: admin
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Sending message: AUTH_SUCCESS, length: 56
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Message encrypted, new length: 84
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 88
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 02:02:46] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Encrypted message length: 37
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Read 37 bytes for encrypted message body
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 37
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 9
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] fromPacket: restLength = 5
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] fromPacket: parsed message type = RELOAD_USERS
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] fromPacket: checksum = 0
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Received encrypted message: RELOAD_USERS
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Reloading user database...
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] User database reloaded successfully
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Sending message: SERVICE_ACCEPT, length: 21
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Message encrypted, new length: 49
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 53
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 02:02:56] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Encrypted message length: 87
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Read 87 bytes for encrypted message body
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 87
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 59
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] fromPacket: restLength = 55
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 50 (restLength=55 - 5)
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] fromPacket: checksum = 1823310657
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Received encrypted message: SHELL_COMMAND
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Sending message: SHELL_RESULT, length: 73
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Message encrypted, new length: 101
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 105
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 02:03:03] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Encrypted message length: 79
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Read 79 bytes for encrypted message body
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 79
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 51
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] fromPacket: restLength = 47
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] fromPacket: checksum = 1807766422
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Received encrypted message: SHELL_COMMAND
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Sending message: SHELL_RESULT, length: 179
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Message encrypted, new length: 207
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Added length prefix for encrypted message, total length: 211
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Message sent successfully
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Waiting to receive message...
[2025-06-23 02:03:04] [INFO] [pool-1-thread-10] Reading encrypted message...
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Read 4 bytes for encrypted message length
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Encrypted message length: 37
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Read 37 bytes for encrypted message body
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Decrypting encrypted message, length: 37
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Message decrypted successfully, new length: 9
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] fromPacket: restLength = 5
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] fromPacket: parsed message type = DISCONNECT
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] fromPacket: payloadLength = 0 (restLength=5 - 5)
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] fromPacket: checksum = 0
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Received encrypted message: DISCONNECT
[2025-06-23 02:03:09] [INFO] [pool-1-thread-10] Protocol handler closed
