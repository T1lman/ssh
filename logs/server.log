[2025-06-21 15:37:44] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: checksum = 867412670
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Encrypted message length: 149
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Read 149 bytes for encrypted message body
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 149
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 121
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] fromPacket: restLength = 117
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] fromPacket: checksum = 951573390
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 310
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Message encrypted, new length: 338
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 342
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:14] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Encrypted message length: 152
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Read 152 bytes for encrypted message body
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 152
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 124
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] fromPacket: restLength = 120
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 115 (restLength=120 - 5)
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] fromPacket: checksum = -1104783174
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 168
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Message encrypted, new length: 196
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 200
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:28] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:36] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Encrypted message length: 150
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Read 150 bytes for encrypted message body
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 150
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 122
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] fromPacket: restLength = 118
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 113 (restLength=118 - 5)
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] fromPacket: checksum = 54420839
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 166
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Message encrypted, new length: 194
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 198
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:40] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Encrypted message length: 155
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Read 155 bytes for encrypted message body
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 155
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 127
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] fromPacket: restLength = 123
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 118 (restLength=123 - 5)
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] fromPacket: checksum = -1677408393
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 141
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Message encrypted, new length: 169
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 173
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:38:44] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:39:14] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: checksum = -921066695
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Encrypted message length: 85
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 85 bytes for encrypted message body
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 85
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 57
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: restLength = 53
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: checksum = -1075446496
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Encrypted message length: 157
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Read 157 bytes for encrypted message body
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 157
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 129
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: restLength = 125
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] fromPacket: checksum = -868477163
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message encrypted, new length: 171
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] Encrypted message length: 71
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] Read 71 bytes for encrypted message body
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 71
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 43
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] fromPacket: restLength = 39
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] fromPacket: checksum = -1860683713
[2025-06-21 15:43:02] [ERROR] [pool-1-thread-2] Failed to decrypt payload: Unsupported message type: DISCONNECT
[2025-06-21 15:43:02] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: checksum = 1964609533
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Encrypted message length: 85
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Read 85 bytes for encrypted message body
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 85
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 57
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: restLength = 53
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] fromPacket: checksum = -2061111560
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Sending message: AUTH_FAILURE, length: 53
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Message encrypted, new length: 81
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 85
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-21 15:43:06] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Read 4 bytes for message length
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Message length: 787
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Read 787 bytes for message body (expected 787)
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Raw message type byte: 1
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: restLength = 787
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: checksum = 858297686
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Encrypted message length: 84
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Read 84 bytes for encrypted message body
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 84
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 56
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: restLength = 52
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] fromPacket: checksum = 789309453
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Sending message: AUTH_FAILURE, length: 53
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Message encrypted, new length: 81
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 85
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-21 15:43:10] [INFO] [pool-1-thread-4] Protocol handler closed
[2025-06-21 15:45:34] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 15:45:34] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 15:45:49] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 15:46:16] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: checksum = 1918500359
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-21 15:46:28] [ERROR] [pool-1-thread-1] Failed to decrypt payload: Unsupported message type: DISCONNECT
[2025-06-21 15:46:28] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: checksum = -2099100725
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Encrypted message length: 85
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 85 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 85
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 57
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: restLength = 53
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: checksum = -1075446496
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Authentication attempt for user: admin, type: password
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] User existence check for 'admin': true
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] User validation passed for: admin
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Attempting password authentication for: admin
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Verifying password for user: admin
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: admin
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for admin: true
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Password authentication result for admin: true
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Encrypted message length: 157
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 157 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 157
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 129
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: restLength = 125
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: checksum = -868477163
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message encrypted, new length: 171
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Encrypted message length: 71
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Read 71 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 71
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 43
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: restLength = 39
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] fromPacket: checksum = -1860683713
[2025-06-21 15:46:51] [ERROR] [pool-1-thread-2] Failed to decrypt payload: Unsupported message type: DISCONNECT
[2025-06-21 15:46:51] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-21 15:47:35] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 15:48:36] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 15:48:44] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 15:49:12] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: checksum = -269173502
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Encrypted message length: 88
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 88 bytes for encrypted message body
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 88
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 60
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: restLength = 56
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 51 (restLength=56 - 5)
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: checksum = 1743321437
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Authentication attempt for user: user1, type: password
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] User existence check for 'user1': true
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] User validation passed for: user1
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Attempting password authentication for: user1
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Verifying password for user: user1
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: user1
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: user1
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] UserStore: Password verification for user1 - Stored hash: 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8, Input hash: 5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8, Matches: true
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for user1: true
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Password authentication result for user1: true
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-21 15:49:51] [ERROR] [pool-1-thread-1] Failed to decrypt payload: Unsupported message type: DISCONNECT
[2025-06-21 15:49:51] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-21 15:49:54] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -1262233071
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Encrypted message length: 83
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 83 bytes for encrypted message body
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 83
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 55
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 51
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -1986542933
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: password
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Attempting password authentication for: test
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Encrypted message length: 157
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Read 157 bytes for encrypted message body
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 157
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 129
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 125
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -868477163
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 143
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 171
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 175
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Encrypted message length: 149
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Read 149 bytes for encrypted message body
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 149
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 121
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] fromPacket: restLength = 117
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] fromPacket: checksum = 951573390
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 310
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Message encrypted, new length: 338
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 342
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 15:50:03] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 15:50:33] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-21 17:01:33] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 17:01:33] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 4 bytes for message length
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message length: 787
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 787 bytes for message body (expected 787)
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Raw message type byte: 1
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 787
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: checksum = -2011976869
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Received message: KEY_EXCHANGE_INIT
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Encrypted message length: 85
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 85 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 85
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 57
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 53
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: checksum = -1075446496
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Received encrypted message: AUTH_REQUEST
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Authentication attempt for user: admin, type: password
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] User existence check for 'admin': true
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] User validation passed for: admin
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Attempting password authentication for: admin
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Verifying password for user: admin
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] PasswordAuth: Checking if user exists: admin
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] PasswordAuth: Password verification result for admin: true
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Password authentication result for admin: true
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message encrypted, new length: 84
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 88
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Encrypted message length: 42
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 42 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 42
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 14
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 10
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: checksum = 1167241981
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Received encrypted message: SERVICE_REQUEST
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message encrypted, new length: 42
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Encrypted message length: 157
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 157 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 157
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 129
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 125
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: checksum = -868477163
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Received encrypted message: SHELL_COMMAND
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Sending message: SHELL_RESULT, length: 143
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message encrypted, new length: 171
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Added length prefix for encrypted message, total length: 175
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message sent successfully
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Encrypted message length: 71
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Read 71 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Decrypting encrypted message, length: 71
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Message decrypted successfully, new length: 43
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: restLength = 39
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: parsed message type = DISCONNECT
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] fromPacket: checksum = -1860683713
[2025-06-21 17:01:36] [ERROR] [pool-1-thread-3] Failed to decrypt payload: Unsupported message type: DISCONNECT
[2025-06-21 17:01:36] [INFO] [pool-1-thread-3] Protocol handler closed
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 4 bytes for message length
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message length: 787
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 787 bytes for message body (expected 787)
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Raw message type byte: 1
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: restLength = 787
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: checksum = 323054591
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Received message: KEY_EXCHANGE_INIT
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Encrypted message length: 85
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 85 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 85
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 57
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: restLength = 53
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: checksum = -1075446496
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Received encrypted message: AUTH_REQUEST
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Authentication attempt for user: admin, type: password
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] User existence check for 'admin': true
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] User validation passed for: admin
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Attempting password authentication for: admin
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Verifying password for user: admin
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] PasswordAuth: Checking if user exists: admin
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] PasswordAuth: Password verification result for admin: true
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Password authentication result for admin: true
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message encrypted, new length: 84
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 88
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Encrypted message length: 42
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 42 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 42
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 14
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: restLength = 10
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: checksum = 1167241981
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Received encrypted message: SERVICE_REQUEST
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message encrypted, new length: 42
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Encrypted message length: 157
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 157 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 157
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 129
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: restLength = 125
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: checksum = -868477163
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Received encrypted message: SHELL_COMMAND
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Sending message: SHELL_RESULT, length: 143
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message encrypted, new length: 171
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Added length prefix for encrypted message, total length: 175
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message sent successfully
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Encrypted message length: 71
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Read 71 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Decrypting encrypted message, length: 71
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Message decrypted successfully, new length: 43
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: restLength = 39
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: parsed message type = DISCONNECT
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] fromPacket: checksum = -1860683713
[2025-06-21 17:01:38] [ERROR] [pool-1-thread-4] Failed to decrypt payload: Unsupported message type: DISCONNECT
[2025-06-21 17:01:38] [INFO] [pool-1-thread-4] Protocol handler closed
[2025-06-21 17:07:35] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 17:09:48] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 17:09:48] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 17:09:56] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 17:10:04] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: checksum = -1030124728
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:10:44] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -1558493345
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Encrypted message length: 83
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 83 bytes for encrypted message body
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 83
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 55
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 51
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -1986542933
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: password
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Attempting password authentication for: test
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Encrypted message length: 157
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Read 157 bytes for encrypted message body
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 157
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 129
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: restLength = 125
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] fromPacket: checksum = -868477163
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 143
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message encrypted, new length: 171
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 175
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-21 17:13:25] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-21 17:16:09] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 17:16:48] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: checksum = 2143027839
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:17:19] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-21 17:18:13] [INFO] [Thread-0] Shutdown signal received
[2025-06-21 17:20:33] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: checksum = 752943653
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-21 17:21:28] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 17:18:26] [INFO] [Thread-0] Shutdown signal received
[2025-06-22 17:35:22] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: checksum = -2094671873
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-22 17:35:40] [ERROR] [pool-1-thread-1] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 17:35:40] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 17:37:45] [INFO] [Thread-0] Shutdown signal received
[2025-06-22 17:37:54] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: checksum = -542171381
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Encrypted message length: 157
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 157 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 157
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 129
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 125
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 120 (restLength=125 - 5)
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: checksum = -868477163
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 143
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message encrypted, new length: 171
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 175
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Encrypted message length: 71
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Read 71 bytes for encrypted message body
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 71
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 43
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: restLength = 39
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] fromPacket: checksum = -1860683713
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Received encrypted message: ERROR
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-22 17:37:59] [ERROR] [pool-1-thread-1] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 17:37:59] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 17:42:21] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 17:42:22] [INFO] [Thread-0] Shutdown signal received
[2025-06-22 17:43:19] [INFO] [Thread-0] Shutdown signal received
[2025-06-22 17:43:22] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: checksum = 725987656
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 17:43:36] [INFO] [pool-1-thread-1] Read -1 bytes for encrypted message length
[2025-06-22 17:43:36] [ERROR] [pool-1-thread-1] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 17:43:36] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] fromPacket: checksum = -686143720
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:20] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Encrypted message length: 83
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Read 83 bytes for encrypted message body
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 83
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 55
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: restLength = 51
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: checksum = -1986542933
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: password
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Attempting password authentication for: test
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:21] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Encrypted message length: 149
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Read 149 bytes for encrypted message body
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 149
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 121
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] fromPacket: restLength = 117
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] fromPacket: checksum = 951573390
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 279
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Message encrypted, new length: 307
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 311
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:34] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Encrypted message length: 153
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Read 153 bytes for encrypted message body
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 153
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 125
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] fromPacket: restLength = 121
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 116 (restLength=121 - 5)
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] fromPacket: checksum = -1606466417
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 137
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Message encrypted, new length: 165
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 169
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:39] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Encrypted message length: 149
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Read 149 bytes for encrypted message body
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 149
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 121
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] fromPacket: restLength = 117
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 112 (restLength=117 - 5)
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] fromPacket: checksum = 951573390
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 279
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Message encrypted, new length: 307
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 311
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:41] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Encrypted message length: 71
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Read 71 bytes for encrypted message body
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 71
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 43
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: restLength = 39
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: checksum = -1860683713
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Received encrypted message: ERROR
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Encrypted message length: 71
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Read 71 bytes for encrypted message body
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 71
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 43
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: restLength = 39
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: parsed message type = DISCONNECT
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 34 (restLength=39 - 5)
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] fromPacket: checksum = -1860683713
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Received encrypted message: ERROR
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Read -1 bytes for encrypted message length
[2025-06-22 17:48:48] [ERROR] [pool-1-thread-2] Failed to read encrypted message length. Expected 4 bytes, got -1
[2025-06-22 17:48:48] [INFO] [pool-1-thread-2] Protocol handler closed
[2025-06-22 17:49:27] [INFO] [Thread-0] Shutdown signal received
[2025-06-22 18:02:56] [INFO] [main] Logger initialized - logging to: logs/server.log
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Read 4 bytes for message length
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message length: 787
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Read 787 bytes for message body (expected 787)
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Raw message type byte: 1
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: restLength = 787
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: checksum = -1920777339
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Received message: KEY_EXCHANGE_INIT
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Encrypted message length: 85
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Read 85 bytes for encrypted message body
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 85
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 57
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: restLength = 53
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 48 (restLength=53 - 5)
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: checksum = -1075446496
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Received encrypted message: AUTH_REQUEST
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Authentication attempt for user: admin, type: password
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] User existence check for 'admin': true
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] User validation passed for: admin
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Attempting password authentication for: admin
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Verifying password for user: admin
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] PasswordAuth: Checking if user exists: admin
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] PasswordAuth: User exists, verifying password for: admin
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] UserStore: Password verification for admin - Stored hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Input hash: 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918, Matches: true
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] PasswordAuth: Password verification result for admin: true
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Password authentication result for admin: true
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message encrypted, new length: 84
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 88
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Encrypted message length: 42
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Read 42 bytes for encrypted message body
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 42
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 14
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: restLength = 10
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] fromPacket: checksum = 1167241981
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Received encrypted message: SERVICE_REQUEST
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message encrypted, new length: 42
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 46
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Encrypted message length: 83
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Read 83 bytes for encrypted message body
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 83
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 55
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] fromPacket: restLength = 51
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] fromPacket: checksum = -1905571915
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 102
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Message encrypted, new length: 130
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 134
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:24] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Encrypted message length: 79
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Read 79 bytes for encrypted message body
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 79
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 51
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] fromPacket: restLength = 47
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] fromPacket: checksum = 1807766422
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:27] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Encrypted message length: 86
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Read 86 bytes for encrypted message body
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 86
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 58
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] fromPacket: restLength = 54
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 49 (restLength=54 - 5)
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] fromPacket: checksum = 1901291938
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 74
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Message encrypted, new length: 102
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 106
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:36] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Encrypted message length: 86
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Read 86 bytes for encrypted message body
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 86
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 58
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] fromPacket: restLength = 54
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 49 (restLength=54 - 5)
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] fromPacket: checksum = 734307790
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 2063
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Message encrypted, new length: 2091
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 2095
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:39] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Encrypted message length: 93
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Read 93 bytes for encrypted message body
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 93
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 65
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] fromPacket: restLength = 61
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 56 (restLength=61 - 5)
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] fromPacket: checksum = -978443832
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 112
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Message encrypted, new length: 140
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 144
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:41] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Encrypted message length: 89
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Read 89 bytes for encrypted message body
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 89
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 61
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] fromPacket: restLength = 57
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 52 (restLength=57 - 5)
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] fromPacket: checksum = -819971350
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 67
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Message encrypted, new length: 95
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 99
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:45] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Encrypted message length: 83
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Read 83 bytes for encrypted message body
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 83
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 55
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] fromPacket: restLength = 51
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] fromPacket: checksum = 72862676
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 99
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Message encrypted, new length: 127
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 131
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:50] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Encrypted message length: 79
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Read 79 bytes for encrypted message body
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 79
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 51
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] fromPacket: restLength = 47
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] fromPacket: checksum = 1807766422
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:51] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Encrypted message length: 86
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Read 86 bytes for encrypted message body
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 86
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 58
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] fromPacket: restLength = 54
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 49 (restLength=54 - 5)
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] fromPacket: checksum = 854834904
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 105
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Message encrypted, new length: 133
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 137
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:03:55] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Encrypted message length: 86
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Read 86 bytes for encrypted message body
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 86
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 58
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] fromPacket: restLength = 54
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 49 (restLength=54 - 5)
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] fromPacket: checksum = 1901291938
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 74
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Message encrypted, new length: 102
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 106
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:04:19] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Encrypted message length: 86
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Read 86 bytes for encrypted message body
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 86
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 58
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] fromPacket: restLength = 54
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 49 (restLength=54 - 5)
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] fromPacket: checksum = 734307790
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 2063
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Message encrypted, new length: 2091
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 2095
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:04:21] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Encrypted message length: 93
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Read 93 bytes for encrypted message body
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 93
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 65
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] fromPacket: restLength = 61
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 56 (restLength=61 - 5)
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] fromPacket: checksum = -978443832
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 112
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Message encrypted, new length: 140
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 144
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:04:30] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Encrypted message length: 89
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Read 89 bytes for encrypted message body
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 89
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 61
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] fromPacket: restLength = 57
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 52 (restLength=57 - 5)
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] fromPacket: checksum = -819971350
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 67
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Message encrypted, new length: 95
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 99
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:04:33] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Read 4 bytes for encrypted message length
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Encrypted message length: 79
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Read 79 bytes for encrypted message body
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Decrypting encrypted message, length: 79
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Message decrypted successfully, new length: 51
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] fromPacket: restLength = 47
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] fromPacket: checksum = 1807766422
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Sending message: SHELL_RESULT, length: 179
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Message encrypted, new length: 207
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Added length prefix for encrypted message, total length: 211
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Message sent successfully
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Waiting to receive message...
[2025-06-22 18:04:35] [INFO] [pool-1-thread-1] Reading encrypted message...
[2025-06-22 18:05:05] [INFO] [pool-1-thread-1] Protocol handler closed
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Read 4 bytes for message length
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message length: 787
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Read 787 bytes for message body (expected 787)
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message body (first 20 bytes): 01 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Raw message type byte: 1
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Parsed message type: KEY_EXCHANGE_INIT
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: restLength = 787
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: parsed message type = KEY_EXCHANGE_INIT
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 782 (restLength=787 - 5)
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: checksum = 1441968483
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Received message: KEY_EXCHANGE_INIT
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Sending message: KEY_EXCHANGE_REPLY, length: 1153
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Encrypted message length: 83
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Read 83 bytes for encrypted message body
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 83
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 55
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: restLength = 51
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: parsed message type = AUTH_REQUEST
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: checksum = -1986542933
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Received encrypted message: AUTH_REQUEST
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Authentication attempt for user: test, type: password
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] User existence check for 'test': true
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] User validation passed for: test
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Attempting password authentication for: test
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Verifying password for user: test
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] PasswordAuth: Checking if user exists: test
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] PasswordAuth: User exists, verifying password for: test
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] UserStore: Password verification for test - Stored hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Input hash: 9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08, Matches: true
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] PasswordAuth: Password verification result for test: true
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Password authentication result for test: true
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Sending message: AUTH_SUCCESS, length: 56
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message encrypted, new length: 84
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 88
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Encrypted message length: 42
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Read 42 bytes for encrypted message body
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 42
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 14
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: restLength = 10
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SERVICE_REQUEST
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] fromPacket: checksum = 1167241981
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Received encrypted message: SERVICE_REQUEST
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Sending message: SERVICE_ACCEPT, length: 14
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message encrypted, new length: 42
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 46
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Encrypted message length: 82
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Read 82 bytes for encrypted message body
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 82
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 54
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] fromPacket: restLength = 50
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 45 (restLength=50 - 5)
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] fromPacket: checksum = -1949576749
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 60
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Message encrypted, new length: 88
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 92
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:07] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Encrypted message length: 73
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Read 73 bytes for encrypted message body
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 73
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 45
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] fromPacket: restLength = 41
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 36 (restLength=41 - 5)
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] fromPacket: checksum = 246320449
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 96
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Message encrypted, new length: 124
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 128
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:09] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Encrypted message length: 72
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Read 72 bytes for encrypted message body
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 72
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 44
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] fromPacket: restLength = 40
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 35 (restLength=40 - 5)
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] fromPacket: checksum = 1883284585
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 74
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Message encrypted, new length: 102
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 106
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:11] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Encrypted message length: 79
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Read 79 bytes for encrypted message body
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 79
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 51
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] fromPacket: restLength = 47
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] fromPacket: checksum = -154055748
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 67
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Message encrypted, new length: 95
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 99
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:18] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Encrypted message length: 79
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Read 79 bytes for encrypted message body
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 79
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 51
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] fromPacket: restLength = 47
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] fromPacket: checksum = 1807766422
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 179
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Message encrypted, new length: 207
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 211
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:21] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Encrypted message length: 83
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Read 83 bytes for encrypted message body
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 83
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 55
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] fromPacket: restLength = 51
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 46 (restLength=51 - 5)
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] fromPacket: checksum = 72862676
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 99
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Message encrypted, new length: 127
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 131
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:26] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Read 4 bytes for encrypted message length
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Encrypted message length: 79
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Read 79 bytes for encrypted message body
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Decrypting encrypted message, length: 79
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Message decrypted successfully, new length: 51
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] fromPacket: restLength = 47
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] fromPacket: parsed message type = SHELL_COMMAND
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] fromPacket: payloadLength = 42 (restLength=47 - 5)
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] fromPacket: checksum = 1807766422
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Received encrypted message: SHELL_COMMAND
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Sending message: SHELL_RESULT, length: 179
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Message encrypted, new length: 207
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Added length prefix for encrypted message, total length: 211
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Message sent successfully
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Waiting to receive message...
[2025-06-22 18:06:27] [INFO] [pool-1-thread-2] Reading encrypted message...
[2025-06-22 18:06:57] [INFO] [pool-1-thread-2] Protocol handler closed
