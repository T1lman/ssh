[2025-06-23 20:19:47] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-23 20:19:47] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:20:10] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:20:10] [INFO] [main] resolvePath: data/client/client_keys/admin_rsa -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa
[2025-06-23 20:20:10] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:20:10] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:20:10] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa
[2025-06-23 20:20:10] [INFO] [main] resolvePath: data/client/client_keys/admin_rsa.pub -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa.pub
[2025-06-23 20:20:10] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:20:10] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:20:10] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa.pub
[2025-06-23 20:20:10] [INFO] [main] ClientConnection constructor called
[2025-06-23 20:20:10] [ERROR] [main] Error during cleanup: Cannot invoke "ssh.client.view.ClientUI.showConnectionStatus(boolean)" because "this.ui" is null
[2025-06-23 20:20:10] [ERROR] [main] Failed to start console client: Cannot invoke "ssh.client.view.ClientUI.displayError(String)" because "this.ui" is null
[2025-06-23 20:23:18] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-23 20:23:18] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:23:27] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:23:27] [INFO] [main] resolvePath: data/client/client_keys/admin_rsa -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa
[2025-06-23 20:23:27] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:27] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:27] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa
[2025-06-23 20:23:27] [INFO] [main] resolvePath: data/client/client_keys/admin_rsa.pub -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa.pub
[2025-06-23 20:23:27] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:27] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:27] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/admin_rsa.pub
[2025-06-23 20:23:27] [INFO] [main] ClientConnection constructor called
[2025-06-23 20:23:27] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:23:31] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:23:31] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:23:31] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:31] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:31] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:23:31] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa.pub -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:23:31] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:31] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:23:31] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:23:31] [INFO] [main] Disconnected from server
[2025-06-23 20:25:08] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-23 20:25:08] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:25:08] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:25:22] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:25:22] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:25:22] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:25:22] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:25:22] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:25:22] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa.pub -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:25:22] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:25:22] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:25:22] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:25:39] [INFO] [main] ClientConnection constructor called
[2025-06-23 20:25:39] [INFO] [main] Connecting to localhost:2222
[2025-06-23 20:25:39] [INFO] [main] Connected successfully
[2025-06-23 20:25:39] [INFO] [main] Starting key exchange...
[2025-06-23 20:25:39] [INFO] [main] Generated DH key pair
[2025-06-23 20:25:39] [INFO] [main] Created key exchange init message
[2025-06-23 20:25:39] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 937
[2025-06-23 20:25:39] [INFO] [main] Message sent successfully
[2025-06-23 20:25:39] [INFO] [main] Sent key exchange init message
[2025-06-23 20:25:39] [INFO] [main] Waiting for key exchange reply...
[2025-06-23 20:25:39] [INFO] [main] Waiting to receive message...
[2025-06-23 20:25:39] [INFO] [main] Read 4 bytes for message length
[2025-06-23 20:25:39] [INFO] [main] Message length: 1317
[2025-06-23 20:25:39] [INFO] [main] Read 1317 bytes for message body (expected 1317)
[2025-06-23 20:25:39] [INFO] [main] Message body (first 20 bytes): 02 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
[2025-06-23 20:25:39] [INFO] [main] Raw message type byte: 2
[2025-06-23 20:25:39] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-23 20:25:39] [INFO] [main] fromPacket: restLength = 1317
[2025-06-23 20:25:39] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-23 20:25:39] [INFO] [main] fromPacket: payloadLength = 1312 (restLength=1317 - 5)
[2025-06-23 20:25:39] [INFO] [main] fromPacket: checksum = -719659282
[2025-06-23 20:25:39] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-23 20:25:39] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-23 20:25:39] [INFO] [main] Set server's public key
[2025-06-23 20:25:39] [INFO] [main] Computed shared secret, length: 256
[2025-06-23 20:25:39] [INFO] [main] Initialized symmetric encryption
[2025-06-23 20:25:39] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 20:25:39] [INFO] [main] Enabled encryption in protocol handler
[2025-06-23 20:25:39] [INFO] [main] Received session ID: 9e1ad5c0-0854-4e51-bda9-59a06e552a96
[2025-06-23 20:25:39] [INFO] [main] Starting authentication...
[2025-06-23 20:25:39] [INFO] [main] Preparing auth for user: tilman, type: dual
[2025-06-23 20:25:39] [INFO] [main] Using password authentication
[2025-06-23 20:25:39] [INFO] [main] Using public key authentication, signed session ID.
[2025-06-23 20:25:39] [INFO] [main] Sending message: AUTH_REQUEST, length: 937
[2025-06-23 20:25:39] [INFO] [main] Message encrypted, new length: 965
[2025-06-23 20:25:39] [INFO] [main] Added length prefix for encrypted message, total length: 969
[2025-06-23 20:25:39] [INFO] [main] Message sent successfully
[2025-06-23 20:25:39] [INFO] [main] Sent authentication request
[2025-06-23 20:25:39] [INFO] [main] Waiting to receive message...
[2025-06-23 20:25:39] [INFO] [main] Reading encrypted message...
[2025-06-23 20:25:39] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:25:39] [INFO] [main] Encrypted message length: 248
[2025-06-23 20:25:39] [INFO] [main] Read 248 bytes for encrypted message body
[2025-06-23 20:25:39] [INFO] [main] Decrypting encrypted message, length: 248
[2025-06-23 20:25:39] [INFO] [main] Message decrypted successfully, new length: 220
[2025-06-23 20:25:39] [INFO] [main] fromPacket: restLength = 216
[2025-06-23 20:25:39] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-23 20:25:39] [INFO] [main] fromPacket: payloadLength = 211 (restLength=216 - 5)
[2025-06-23 20:25:39] [INFO] [main] fromPacket: checksum = 1129782591
[2025-06-23 20:25:39] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-23 20:25:39] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-23 20:25:39] [INFO] [main] Authentication successful: true
[2025-06-23 20:25:49] [INFO] [main] Sending message: SHELL_COMMAND, length: 178
[2025-06-23 20:25:49] [INFO] [main] Message encrypted, new length: 206
[2025-06-23 20:25:49] [INFO] [main] Added length prefix for encrypted message, total length: 210
[2025-06-23 20:25:49] [INFO] [main] Message sent successfully
[2025-06-23 20:25:49] [INFO] [main] Waiting to receive message...
[2025-06-23 20:25:49] [INFO] [main] Reading encrypted message...
[2025-06-23 20:25:49] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:25:49] [INFO] [main] Encrypted message length: 325
[2025-06-23 20:25:49] [INFO] [main] Read 325 bytes for encrypted message body
[2025-06-23 20:25:49] [INFO] [main] Decrypting encrypted message, length: 325
[2025-06-23 20:25:49] [INFO] [main] Message decrypted successfully, new length: 297
[2025-06-23 20:25:49] [INFO] [main] fromPacket: restLength = 293
[2025-06-23 20:25:49] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-23 20:25:49] [INFO] [main] fromPacket: payloadLength = 288 (restLength=293 - 5)
[2025-06-23 20:25:49] [INFO] [main] fromPacket: checksum = -443241011
[2025-06-23 20:25:49] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-23 20:25:53] [INFO] [main] Sending message: SHELL_COMMAND, length: 181
[2025-06-23 20:25:53] [INFO] [main] Message encrypted, new length: 209
[2025-06-23 20:25:53] [INFO] [main] Added length prefix for encrypted message, total length: 213
[2025-06-23 20:25:53] [INFO] [main] Message sent successfully
[2025-06-23 20:25:53] [INFO] [main] Waiting to receive message...
[2025-06-23 20:25:53] [INFO] [main] Reading encrypted message...
[2025-06-23 20:25:53] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:25:53] [INFO] [main] Encrypted message length: 607
[2025-06-23 20:25:53] [INFO] [main] Read 607 bytes for encrypted message body
[2025-06-23 20:25:53] [INFO] [main] Decrypting encrypted message, length: 607
[2025-06-23 20:25:53] [INFO] [main] Message decrypted successfully, new length: 579
[2025-06-23 20:25:53] [INFO] [main] fromPacket: restLength = 575
[2025-06-23 20:25:53] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-23 20:25:53] [INFO] [main] fromPacket: payloadLength = 570 (restLength=575 - 5)
[2025-06-23 20:25:53] [INFO] [main] fromPacket: checksum = -1428110593
[2025-06-23 20:25:53] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-23 20:25:58] [INFO] [main] Sending message: SHELL_COMMAND, length: 182
[2025-06-23 20:25:58] [INFO] [main] Message encrypted, new length: 210
[2025-06-23 20:25:58] [INFO] [main] Added length prefix for encrypted message, total length: 214
[2025-06-23 20:25:58] [INFO] [main] Message sent successfully
[2025-06-23 20:25:58] [INFO] [main] Waiting to receive message...
[2025-06-23 20:25:58] [INFO] [main] Reading encrypted message...
[2025-06-23 20:25:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:25:58] [INFO] [main] Encrypted message length: 194
[2025-06-23 20:25:58] [INFO] [main] Read 194 bytes for encrypted message body
[2025-06-23 20:25:58] [INFO] [main] Decrypting encrypted message, length: 194
[2025-06-23 20:25:58] [INFO] [main] Message decrypted successfully, new length: 166
[2025-06-23 20:25:58] [INFO] [main] fromPacket: restLength = 162
[2025-06-23 20:25:58] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-23 20:25:58] [INFO] [main] fromPacket: payloadLength = 157 (restLength=162 - 5)
[2025-06-23 20:25:58] [INFO] [main] fromPacket: checksum = 992809896
[2025-06-23 20:25:58] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-23 20:26:00] [INFO] [main] Sending message: SHELL_COMMAND, length: 171
[2025-06-23 20:26:00] [INFO] [main] Message encrypted, new length: 199
[2025-06-23 20:26:00] [INFO] [main] Added length prefix for encrypted message, total length: 203
[2025-06-23 20:26:00] [INFO] [main] Message sent successfully
[2025-06-23 20:26:00] [INFO] [main] Waiting to receive message...
[2025-06-23 20:26:00] [INFO] [main] Reading encrypted message...
[2025-06-23 20:26:00] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:26:00] [INFO] [main] Encrypted message length: 210
[2025-06-23 20:26:00] [INFO] [main] Read 210 bytes for encrypted message body
[2025-06-23 20:26:00] [INFO] [main] Decrypting encrypted message, length: 210
[2025-06-23 20:26:00] [INFO] [main] Message decrypted successfully, new length: 182
[2025-06-23 20:26:00] [INFO] [main] fromPacket: restLength = 178
[2025-06-23 20:26:00] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-23 20:26:00] [INFO] [main] fromPacket: payloadLength = 173 (restLength=178 - 5)
[2025-06-23 20:26:00] [INFO] [main] fromPacket: checksum = 412489501
[2025-06-23 20:26:00] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-23 20:26:04] [INFO] [main] Sending message: SHELL_COMMAND, length: 178
[2025-06-23 20:26:04] [INFO] [main] Message encrypted, new length: 206
[2025-06-23 20:26:04] [INFO] [main] Added length prefix for encrypted message, total length: 210
[2025-06-23 20:26:04] [INFO] [main] Message sent successfully
[2025-06-23 20:26:04] [INFO] [main] Waiting to receive message...
[2025-06-23 20:26:04] [INFO] [main] Reading encrypted message...
[2025-06-23 20:26:04] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:26:04] [INFO] [main] Encrypted message length: 201
[2025-06-23 20:26:04] [INFO] [main] Read 201 bytes for encrypted message body
[2025-06-23 20:26:04] [INFO] [main] Decrypting encrypted message, length: 201
[2025-06-23 20:26:04] [INFO] [main] Message decrypted successfully, new length: 173
[2025-06-23 20:26:04] [INFO] [main] fromPacket: restLength = 169
[2025-06-23 20:26:04] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-23 20:26:04] [INFO] [main] fromPacket: payloadLength = 164 (restLength=169 - 5)
[2025-06-23 20:26:04] [INFO] [main] fromPacket: checksum = 1128258703
[2025-06-23 20:26:04] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-23 20:26:07] [INFO] [main] Sending message: SHELL_COMMAND, length: 178
[2025-06-23 20:26:07] [INFO] [main] Message encrypted, new length: 206
[2025-06-23 20:26:07] [INFO] [main] Added length prefix for encrypted message, total length: 210
[2025-06-23 20:26:07] [INFO] [main] Message sent successfully
[2025-06-23 20:26:07] [INFO] [main] Waiting to receive message...
[2025-06-23 20:26:07] [INFO] [main] Reading encrypted message...
[2025-06-23 20:26:07] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:26:07] [INFO] [main] Encrypted message length: 325
[2025-06-23 20:26:07] [INFO] [main] Read 325 bytes for encrypted message body
[2025-06-23 20:26:07] [INFO] [main] Decrypting encrypted message, length: 325
[2025-06-23 20:26:07] [INFO] [main] Message decrypted successfully, new length: 297
[2025-06-23 20:26:07] [INFO] [main] fromPacket: restLength = 293
[2025-06-23 20:26:07] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-23 20:26:07] [INFO] [main] fromPacket: payloadLength = 288 (restLength=293 - 5)
[2025-06-23 20:26:07] [INFO] [main] fromPacket: checksum = -443241011
[2025-06-23 20:26:07] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-23 20:26:14] [INFO] [main] Sending message: DISCONNECT, length: 9
[2025-06-23 20:26:14] [INFO] [main] Message encrypted, new length: 37
[2025-06-23 20:26:14] [INFO] [main] Added length prefix for encrypted message, total length: 41
[2025-06-23 20:26:14] [INFO] [main] Message sent successfully
[2025-06-23 20:26:14] [INFO] [main] Sending message: DISCONNECT, length: 9
[2025-06-23 20:26:14] [INFO] [main] Message encrypted, new length: 37
[2025-06-23 20:26:14] [INFO] [main] Added length prefix for encrypted message, total length: 41
[2025-06-23 20:26:14] [INFO] [main] Message sent successfully
[2025-06-23 20:26:14] [INFO] [main] Protocol handler closed
[2025-06-23 20:26:14] [INFO] [main] Disconnected from server
[2025-06-23 20:26:18] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-23 20:26:18] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:26:18] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:26:28] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:26:28] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:26:28] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:26:28] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:26:28] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:26:28] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa.pub -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:26:28] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:26:28] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:26:28] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:27:52] [INFO] [main] ClientConnection constructor called
[2025-06-23 20:27:52] [INFO] [main] Connecting to localhost:2222
[2025-06-23 20:27:52] [INFO] [main] Connected successfully
[2025-06-23 20:27:52] [INFO] [main] Starting key exchange...
[2025-06-23 20:27:52] [INFO] [main] Generated DH key pair
[2025-06-23 20:27:52] [INFO] [main] Created key exchange init message
[2025-06-23 20:27:52] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 937
[2025-06-23 20:27:52] [INFO] [main] Message sent successfully
[2025-06-23 20:27:52] [INFO] [main] Sent key exchange init message
[2025-06-23 20:27:52] [INFO] [main] Waiting for key exchange reply...
[2025-06-23 20:27:52] [INFO] [main] Waiting to receive message...
[2025-06-23 20:27:52] [INFO] [main] Read 4 bytes for message length
[2025-06-23 20:27:52] [INFO] [main] Message length: 1317
[2025-06-23 20:27:52] [INFO] [main] Read 1317 bytes for message body (expected 1317)
[2025-06-23 20:27:52] [INFO] [main] Message body (first 20 bytes): 02 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
[2025-06-23 20:27:52] [INFO] [main] Raw message type byte: 2
[2025-06-23 20:27:52] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-23 20:27:52] [INFO] [main] fromPacket: restLength = 1317
[2025-06-23 20:27:52] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-23 20:27:52] [INFO] [main] fromPacket: payloadLength = 1312 (restLength=1317 - 5)
[2025-06-23 20:27:52] [INFO] [main] fromPacket: checksum = 936294225
[2025-06-23 20:27:52] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-23 20:27:52] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-23 20:27:52] [INFO] [main] Set server's public key
[2025-06-23 20:27:52] [INFO] [main] Computed shared secret, length: 256
[2025-06-23 20:27:52] [INFO] [main] Initialized symmetric encryption
[2025-06-23 20:27:52] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 20:27:52] [INFO] [main] Enabled encryption in protocol handler
[2025-06-23 20:27:52] [INFO] [main] Received session ID: a9aa1cf1-4003-4803-b6cd-5e636c942ba0
[2025-06-23 20:27:52] [INFO] [main] Starting authentication...
[2025-06-23 20:27:52] [INFO] [main] Preparing auth for user: tilman, type: dual
[2025-06-23 20:27:52] [INFO] [main] Using password authentication
[2025-06-23 20:27:52] [INFO] [main] Using public key authentication, signed session ID.
[2025-06-23 20:27:52] [INFO] [main] Sending message: AUTH_REQUEST, length: 937
[2025-06-23 20:27:52] [INFO] [main] Message encrypted, new length: 965
[2025-06-23 20:27:52] [INFO] [main] Added length prefix for encrypted message, total length: 969
[2025-06-23 20:27:52] [INFO] [main] Message sent successfully
[2025-06-23 20:27:52] [INFO] [main] Sent authentication request
[2025-06-23 20:27:52] [INFO] [main] Waiting to receive message...
[2025-06-23 20:27:52] [INFO] [main] Reading encrypted message...
[2025-06-23 20:27:52] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:27:52] [INFO] [main] Encrypted message length: 248
[2025-06-23 20:27:52] [INFO] [main] Read 248 bytes for encrypted message body
[2025-06-23 20:27:52] [INFO] [main] Decrypting encrypted message, length: 248
[2025-06-23 20:27:52] [INFO] [main] Message decrypted successfully, new length: 220
[2025-06-23 20:27:52] [INFO] [main] fromPacket: restLength = 216
[2025-06-23 20:27:52] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-23 20:27:52] [INFO] [main] fromPacket: payloadLength = 211 (restLength=216 - 5)
[2025-06-23 20:27:52] [INFO] [main] fromPacket: checksum = 1129782591
[2025-06-23 20:27:52] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-23 20:27:52] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-23 20:27:52] [INFO] [main] Authentication successful: true
[2025-06-23 20:27:54] [INFO] [main] Sending message: DISCONNECT, length: 9
[2025-06-23 20:27:54] [INFO] [main] Message encrypted, new length: 37
[2025-06-23 20:27:54] [INFO] [main] Added length prefix for encrypted message, total length: 41
[2025-06-23 20:27:54] [INFO] [main] Message sent successfully
[2025-06-23 20:27:54] [INFO] [main] Sending message: DISCONNECT, length: 9
[2025-06-23 20:27:54] [INFO] [main] Message encrypted, new length: 37
[2025-06-23 20:27:54] [INFO] [main] Added length prefix for encrypted message, total length: 41
[2025-06-23 20:27:54] [INFO] [main] Message sent successfully
[2025-06-23 20:27:54] [INFO] [main] Protocol handler closed
[2025-06-23 20:27:54] [INFO] [main] Disconnected from server
[2025-06-23 20:27:57] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-23 20:27:57] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:28:07] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:28:10] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-23 20:28:10] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:28:10] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:28:10] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:28:10] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa
[2025-06-23 20:28:10] [INFO] [main] resolvePath: data/client/client_keys/tilman_rsa.pub -> /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:28:10] [INFO] [main]   currentDir: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:28:10] [INFO] [main]   projectRoot: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh
[2025-06-23 20:28:10] [INFO] [main] resolvePath: File exists: /Users/tilman/Library/Mobile Documents/com~apple~CloudDocs/Schule/info/projects/ssh/data/client/client_keys/tilman_rsa.pub
[2025-06-23 20:28:10] [INFO] [main] ClientConnection constructor called
[2025-06-23 20:28:10] [INFO] [main] Connecting to localhost:2222
[2025-06-23 20:28:10] [INFO] [main] Connected successfully
[2025-06-23 20:28:10] [INFO] [main] Starting key exchange...
[2025-06-23 20:28:10] [INFO] [main] Generated DH key pair
[2025-06-23 20:28:10] [INFO] [main] Created key exchange init message
[2025-06-23 20:28:10] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 937
[2025-06-23 20:28:10] [INFO] [main] Message sent successfully
[2025-06-23 20:28:10] [INFO] [main] Sent key exchange init message
[2025-06-23 20:28:10] [INFO] [main] Waiting for key exchange reply...
[2025-06-23 20:28:10] [INFO] [main] Waiting to receive message...
[2025-06-23 20:28:10] [INFO] [main] Read 4 bytes for message length
[2025-06-23 20:28:10] [INFO] [main] Message length: 1317
[2025-06-23 20:28:10] [INFO] [main] Read 1317 bytes for message body (expected 1317)
[2025-06-23 20:28:10] [INFO] [main] Message body (first 20 bytes): 02 7B 22 74 79 70 65 4E 61 6D 65 22 3A 22 4B 65 79 45 78 63 
[2025-06-23 20:28:10] [INFO] [main] Raw message type byte: 2
[2025-06-23 20:28:10] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-23 20:28:10] [INFO] [main] fromPacket: restLength = 1317
[2025-06-23 20:28:10] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-23 20:28:10] [INFO] [main] fromPacket: payloadLength = 1312 (restLength=1317 - 5)
[2025-06-23 20:28:10] [INFO] [main] fromPacket: checksum = -757967387
[2025-06-23 20:28:10] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-23 20:28:10] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-23 20:28:10] [INFO] [main] Set server's public key
[2025-06-23 20:28:10] [INFO] [main] Computed shared secret, length: 256
[2025-06-23 20:28:10] [INFO] [main] Initialized symmetric encryption
[2025-06-23 20:28:10] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-23 20:28:10] [INFO] [main] Enabled encryption in protocol handler
[2025-06-23 20:28:10] [INFO] [main] Received session ID: 5aa3bfd6-66e2-46ea-9e79-bd20e4ad6b67
[2025-06-23 20:28:10] [INFO] [main] Starting authentication...
[2025-06-23 20:28:10] [INFO] [main] Preparing auth for user: tilman, type: dual
[2025-06-23 20:28:10] [INFO] [main] Using password authentication
[2025-06-23 20:28:10] [INFO] [main] Using public key authentication, signed session ID.
[2025-06-23 20:28:10] [INFO] [main] Sending message: AUTH_REQUEST, length: 937
[2025-06-23 20:28:10] [INFO] [main] Message encrypted, new length: 965
[2025-06-23 20:28:10] [INFO] [main] Added length prefix for encrypted message, total length: 969
[2025-06-23 20:28:10] [INFO] [main] Message sent successfully
[2025-06-23 20:28:10] [INFO] [main] Sent authentication request
[2025-06-23 20:28:10] [INFO] [main] Waiting to receive message...
[2025-06-23 20:28:10] [INFO] [main] Reading encrypted message...
[2025-06-23 20:28:10] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:28:10] [INFO] [main] Encrypted message length: 248
[2025-06-23 20:28:10] [INFO] [main] Read 248 bytes for encrypted message body
[2025-06-23 20:28:10] [INFO] [main] Decrypting encrypted message, length: 248
[2025-06-23 20:28:10] [INFO] [main] Message decrypted successfully, new length: 220
[2025-06-23 20:28:10] [INFO] [main] fromPacket: restLength = 216
[2025-06-23 20:28:10] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-23 20:28:10] [INFO] [main] fromPacket: payloadLength = 211 (restLength=216 - 5)
[2025-06-23 20:28:10] [INFO] [main] fromPacket: checksum = 1129782591
[2025-06-23 20:28:10] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-23 20:28:10] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-23 20:28:10] [INFO] [main] Authentication successful: true
[2025-06-23 20:29:08] [INFO] [main] Starting file download: test.txt
[2025-06-23 20:29:08] [INFO] [main] Sending message: FILE_DOWNLOAD_REQUEST, length: 234
[2025-06-23 20:29:08] [INFO] [main] Message encrypted, new length: 262
[2025-06-23 20:29:08] [INFO] [main] Added length prefix for encrypted message, total length: 266
[2025-06-23 20:29:08] [INFO] [main] Message sent successfully
[2025-06-23 20:29:08] [INFO] [main] Sent file download request
[2025-06-23 20:29:08] [INFO] [main] Waiting to receive message...
[2025-06-23 20:29:08] [INFO] [main] Reading encrypted message...
[2025-06-23 20:29:08] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-23 20:29:08] [INFO] [main] Encrypted message length: 291
[2025-06-23 20:29:08] [INFO] [main] Read 291 bytes for encrypted message body
[2025-06-23 20:29:08] [INFO] [main] Decrypting encrypted message, length: 291
[2025-06-23 20:29:08] [INFO] [main] Message decrypted successfully, new length: 263
[2025-06-23 20:29:08] [INFO] [main] fromPacket: restLength = 259
[2025-06-23 20:29:08] [INFO] [main] fromPacket: parsed message type = FILE_DATA
[2025-06-23 20:29:08] [INFO] [main] fromPacket: payloadLength = 254 (restLength=259 - 5)
[2025-06-23 20:29:08] [INFO] [main] fromPacket: checksum = 806245415
[2025-06-23 20:29:08] [INFO] [main] Received encrypted message: FILE_DATA
[2025-06-23 20:29:08] [INFO] [main] Expecting file size: 35 bytes
[2025-06-23 20:29:08] [INFO] [main] Sending message: FILE_ACK, length: 250
[2025-06-23 20:29:08] [INFO] [main] Message encrypted, new length: 278
[2025-06-23 20:29:08] [INFO] [main] Added length prefix for encrypted message, total length: 282
[2025-06-23 20:29:08] [INFO] [main] Message sent successfully
[2025-06-23 20:29:08] [INFO] [main] File download completed: test.txt (35 bytes)
[2025-06-23 20:29:21] [INFO] [main] Sending message: DISCONNECT, length: 9
[2025-06-23 20:29:21] [INFO] [main] Message encrypted, new length: 37
[2025-06-23 20:29:21] [INFO] [main] Added length prefix for encrypted message, total length: 41
[2025-06-23 20:29:21] [INFO] [main] Message sent successfully
[2025-06-23 20:29:21] [INFO] [main] Sending message: DISCONNECT, length: 9
[2025-06-23 20:29:21] [INFO] [main] Message encrypted, new length: 37
[2025-06-23 20:29:21] [INFO] [main] Added length prefix for encrypted message, total length: 41
[2025-06-23 20:29:21] [INFO] [main] Message sent successfully
[2025-06-23 20:29:21] [INFO] [main] Protocol handler closed
[2025-06-23 20:29:21] [INFO] [main] Disconnected from server
