[2025-06-22 19:59:29] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 19:59:29] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 19:59:29] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 19:59:45] [INFO] [main] ClientConnection constructor called
[2025-06-22 19:59:45] [INFO] [main] Connecting to localhost:2222
[2025-06-22 19:59:45] [INFO] [main] Connected successfully
[2025-06-22 19:59:45] [INFO] [main] Starting key exchange...
[2025-06-22 19:59:45] [INFO] [main] Generated DH key pair
[2025-06-22 19:59:45] [INFO] [main] Created key exchange init message
[2025-06-22 19:59:45] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 787
[2025-06-22 19:59:45] [INFO] [main] Message sent successfully
[2025-06-22 19:59:45] [INFO] [main] Sent key exchange init message
[2025-06-22 19:59:45] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 19:59:45] [INFO] [main] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [main] Read 4 bytes for message length
[2025-06-22 19:59:45] [INFO] [main] Message length: 1196
[2025-06-22 19:59:45] [INFO] [main] Read 1196 bytes for message body (expected 1196)
[2025-06-22 19:59:45] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-22 19:59:45] [INFO] [main] Raw message type byte: 2
[2025-06-22 19:59:45] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 19:59:45] [INFO] [main] fromPacket: restLength = 1196
[2025-06-22 19:59:45] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 19:59:45] [INFO] [main] fromPacket: payloadLength = 1191 (restLength=1196 - 5)
[2025-06-22 19:59:45] [INFO] [main] fromPacket: checksum = -2121483453
[2025-06-22 19:59:45] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 19:59:45] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 19:59:45] [INFO] [main] Set server's public key
[2025-06-22 19:59:45] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 19:59:45] [INFO] [main] Initialized symmetric encryption
[2025-06-22 19:59:45] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 19:59:45] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 19:59:45] [INFO] [main] Received session ID: 22cf2b29-e4b1-48da-a3e6-b8eb551334eb
[2025-06-22 19:59:45] [INFO] [main] Starting authentication...
[2025-06-22 19:59:45] [INFO] [main] Preparing auth for user: test, type: password
[2025-06-22 19:59:45] [INFO] [main] Using password authentication
[2025-06-22 19:59:45] [INFO] [main] Sending message: AUTH_REQUEST, length: 55
[2025-06-22 19:59:45] [INFO] [main] Message encrypted, new length: 83
[2025-06-22 19:59:45] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-22 19:59:45] [INFO] [main] Message sent successfully
[2025-06-22 19:59:45] [INFO] [main] Sent authentication request
[2025-06-22 19:59:45] [INFO] [main] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [main] Reading encrypted message...
[2025-06-22 19:59:45] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 19:59:45] [INFO] [main] Encrypted message length: 84
[2025-06-22 19:59:45] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 19:59:45] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 19:59:45] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 19:59:45] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 19:59:45] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 19:59:45] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 19:59:45] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 19:59:45] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 19:59:45] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 19:59:45] [INFO] [main] Authentication successful
[2025-06-22 19:59:45] [INFO] [main] Sending service request for: shell
[2025-06-22 19:59:45] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 19:59:45] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 19:59:45] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 19:59:45] [INFO] [main] Message sent successfully
[2025-06-22 19:59:45] [INFO] [main] Sent service request
[2025-06-22 19:59:45] [INFO] [main] Waiting to receive message...
[2025-06-22 19:59:45] [INFO] [main] Reading encrypted message...
[2025-06-22 19:59:45] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 19:59:45] [INFO] [main] Encrypted message length: 42
[2025-06-22 19:59:45] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 19:59:45] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 19:59:45] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 19:59:45] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 19:59:45] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 19:59:45] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 19:59:45] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 19:59:45] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 19:59:45] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 19:59:45] [INFO] [main] Service request accepted
[2025-06-22 19:59:50] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 19:59:50] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 19:59:50] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 19:59:50] [INFO] [main] Message sent successfully
[2025-06-22 19:59:50] [INFO] [main] Waiting to receive message...
[2025-06-22 19:59:50] [INFO] [main] Reading encrypted message...
[2025-06-22 19:59:50] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 19:59:50] [INFO] [main] Encrypted message length: 207
[2025-06-22 19:59:50] [INFO] [main] Read 207 bytes for encrypted message body
[2025-06-22 19:59:50] [INFO] [main] Decrypting encrypted message, length: 207
[2025-06-22 19:59:50] [INFO] [main] Message decrypted successfully, new length: 179
[2025-06-22 19:59:50] [INFO] [main] fromPacket: restLength = 175
[2025-06-22 19:59:50] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 19:59:50] [INFO] [main] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-22 19:59:50] [INFO] [main] fromPacket: checksum = -207020665
[2025-06-22 19:59:50] [INFO] [main] Received encrypted message: SHELL_RESULT
