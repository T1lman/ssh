[2025-06-21 15:37:51] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:37:51] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:38:02] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:38:02] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:38:02] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:38:02] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:38:02] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:38:02] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:38:02] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:38:02] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:38:02] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:38:02] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:38:02] [INFO] [main] Connected successfully
[2025-06-21 15:38:02] [INFO] [main] Starting key exchange...
[2025-06-21 15:38:02] [INFO] [main] Generated DH key pair
[2025-06-21 15:38:02] [INFO] [main] Created key exchange init message
[2025-06-21 15:38:02] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:38:02] [INFO] [main] Message sent successfully
[2025-06-21 15:38:02] [INFO] [main] Sent key exchange init message
[2025-06-21 15:38:02] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:38:02] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:38:02] [INFO] [main] Message length: 1149
[2025-06-21 15:38:02] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:38:02] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:38:02] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:38:02] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:38:02] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:38:02] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:38:02] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:38:02] [INFO] [main] fromPacket: checksum = 1884466411
[2025-06-21 15:38:02] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:38:02] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:38:02] [INFO] [main] Set server's public key
[2025-06-21 15:38:02] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:38:02] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:38:02] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:38:02] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:38:02] [INFO] [main] Starting authentication...
[2025-06-21 15:38:02] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 15:38:02] [INFO] [main] Using password authentication
[2025-06-21 15:38:02] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 15:38:02] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 15:38:02] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 15:38:02] [INFO] [main] Message sent successfully
[2025-06-21 15:38:02] [INFO] [main] Sent authentication request
[2025-06-21 15:38:02] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:02] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:02] [INFO] [main] Encrypted message length: 84
[2025-06-21 15:38:02] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 15:38:02] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 15:38:02] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 15:38:02] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 15:38:02] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 15:38:02] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:38:02] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 15:38:02] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 15:38:02] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 15:38:02] [INFO] [main] Authentication successful
[2025-06-21 15:38:02] [INFO] [main] Sending service request for: shell
[2025-06-21 15:38:02] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 15:38:02] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 15:38:02] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:38:02] [INFO] [main] Message sent successfully
[2025-06-21 15:38:02] [INFO] [main] Sent service request
[2025-06-21 15:38:02] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:02] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:02] [INFO] [main] Encrypted message length: 42
[2025-06-21 15:38:02] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 15:38:02] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 15:38:02] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 15:38:02] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 15:38:02] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 15:38:02] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:38:02] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 15:38:02] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 15:38:02] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 15:38:02] [INFO] [main] Service request accepted
[2025-06-21 15:38:02] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:38:02] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:38:02] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:38:02] [INFO] [main] Message sent successfully
[2025-06-21 15:38:02] [INFO] [main] Waiting for shell response...
[2025-06-21 15:38:02] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:02] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:02] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:02] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:38:02] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:38:02] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:38:02] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:38:02] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:38:02] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:38:02] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:38:02] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:38:02] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:38:02] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:38:02] [INFO] [main] Shell response processed successfully
[2025-06-21 15:38:14] [INFO] [main] Sending message: SHELL_COMMAND, length: 121
[2025-06-21 15:38:14] [INFO] [main] Message encrypted, new length: 149
[2025-06-21 15:38:14] [INFO] [main] Added length prefix for encrypted message, total length: 153
[2025-06-21 15:38:14] [INFO] [main] Message sent successfully
[2025-06-21 15:38:14] [INFO] [main] Waiting for shell response...
[2025-06-21 15:38:14] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:14] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:14] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:14] [INFO] [main] Encrypted message length: 338
[2025-06-21 15:38:14] [INFO] [main] Read 338 bytes for encrypted message body
[2025-06-21 15:38:14] [INFO] [main] Decrypting encrypted message, length: 338
[2025-06-21 15:38:14] [INFO] [main] Message decrypted successfully, new length: 310
[2025-06-21 15:38:14] [INFO] [main] fromPacket: restLength = 306
[2025-06-21 15:38:14] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:38:14] [INFO] [main] fromPacket: payloadLength = 301 (restLength=306 - 5)
[2025-06-21 15:38:14] [INFO] [main] fromPacket: checksum = -763407473
[2025-06-21 15:38:14] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:38:14] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:38:14] [INFO] [main] Shell response processed successfully
[2025-06-21 15:38:28] [INFO] [main] Sending message: SHELL_COMMAND, length: 124
[2025-06-21 15:38:28] [INFO] [main] Message encrypted, new length: 152
[2025-06-21 15:38:28] [INFO] [main] Added length prefix for encrypted message, total length: 156
[2025-06-21 15:38:28] [INFO] [main] Message sent successfully
[2025-06-21 15:38:28] [INFO] [main] Waiting for shell response...
[2025-06-21 15:38:28] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:28] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:28] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:28] [INFO] [main] Encrypted message length: 196
[2025-06-21 15:38:28] [INFO] [main] Read 196 bytes for encrypted message body
[2025-06-21 15:38:28] [INFO] [main] Decrypting encrypted message, length: 196
[2025-06-21 15:38:28] [INFO] [main] Message decrypted successfully, new length: 168
[2025-06-21 15:38:28] [INFO] [main] fromPacket: restLength = 164
[2025-06-21 15:38:28] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:38:28] [INFO] [main] fromPacket: payloadLength = 159 (restLength=164 - 5)
[2025-06-21 15:38:28] [INFO] [main] fromPacket: checksum = -1668938666
[2025-06-21 15:38:28] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:38:28] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:38:28] [INFO] [main] Shell response processed successfully
[2025-06-21 15:38:36] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:38:36] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:38:36] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:38:36] [INFO] [main] Message sent successfully
[2025-06-21 15:38:36] [INFO] [main] Waiting for shell response...
[2025-06-21 15:38:36] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:36] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:36] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:36] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:38:36] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:38:36] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:38:36] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:38:36] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:38:36] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:38:36] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:38:36] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:38:36] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:38:36] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:38:36] [INFO] [main] Shell response processed successfully
[2025-06-21 15:38:40] [INFO] [main] Sending message: SHELL_COMMAND, length: 122
[2025-06-21 15:38:40] [INFO] [main] Message encrypted, new length: 150
[2025-06-21 15:38:40] [INFO] [main] Added length prefix for encrypted message, total length: 154
[2025-06-21 15:38:40] [INFO] [main] Message sent successfully
[2025-06-21 15:38:40] [INFO] [main] Waiting for shell response...
[2025-06-21 15:38:40] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:40] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:40] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:40] [INFO] [main] Encrypted message length: 194
[2025-06-21 15:38:40] [INFO] [main] Read 194 bytes for encrypted message body
[2025-06-21 15:38:40] [INFO] [main] Decrypting encrypted message, length: 194
[2025-06-21 15:38:40] [INFO] [main] Message decrypted successfully, new length: 166
[2025-06-21 15:38:40] [INFO] [main] fromPacket: restLength = 162
[2025-06-21 15:38:40] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:38:40] [INFO] [main] fromPacket: payloadLength = 157 (restLength=162 - 5)
[2025-06-21 15:38:40] [INFO] [main] fromPacket: checksum = 627754491
[2025-06-21 15:38:40] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:38:40] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:38:40] [INFO] [main] Shell response processed successfully
[2025-06-21 15:38:44] [INFO] [main] Sending message: SHELL_COMMAND, length: 127
[2025-06-21 15:38:44] [INFO] [main] Message encrypted, new length: 155
[2025-06-21 15:38:44] [INFO] [main] Added length prefix for encrypted message, total length: 159
[2025-06-21 15:38:44] [INFO] [main] Message sent successfully
[2025-06-21 15:38:44] [INFO] [main] Waiting for shell response...
[2025-06-21 15:38:44] [INFO] [main] Waiting to receive message...
[2025-06-21 15:38:44] [INFO] [main] Reading encrypted message...
[2025-06-21 15:38:44] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:38:44] [INFO] [main] Encrypted message length: 169
[2025-06-21 15:38:44] [INFO] [main] Read 169 bytes for encrypted message body
[2025-06-21 15:38:44] [INFO] [main] Decrypting encrypted message, length: 169
[2025-06-21 15:38:44] [INFO] [main] Message decrypted successfully, new length: 141
[2025-06-21 15:38:44] [INFO] [main] fromPacket: restLength = 137
[2025-06-21 15:38:44] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:38:44] [INFO] [main] fromPacket: payloadLength = 132 (restLength=137 - 5)
[2025-06-21 15:38:44] [INFO] [main] fromPacket: checksum = 1929193546
[2025-06-21 15:38:44] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:38:44] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:38:44] [INFO] [main] Shell response processed successfully
[2025-06-21 15:42:54] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:42:54] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:42:54] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:42:54] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:42:54] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:42:54] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:42:54] [INFO] [main] Protocol handler closed
[2025-06-21 15:42:54] [INFO] [main] Disconnected from server
[2025-06-21 15:42:55] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:42:55] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:42:58] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:42:58] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:42:58] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:42:58] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:42:58] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:42:58] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:42:58] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:42:58] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:42:58] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:42:58] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:42:58] [INFO] [main] Connected successfully
[2025-06-21 15:42:58] [INFO] [main] Starting key exchange...
[2025-06-21 15:42:58] [INFO] [main] Generated DH key pair
[2025-06-21 15:42:58] [INFO] [main] Created key exchange init message
[2025-06-21 15:42:58] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:42:58] [INFO] [main] Message sent successfully
[2025-06-21 15:42:58] [INFO] [main] Sent key exchange init message
[2025-06-21 15:42:58] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:42:58] [INFO] [main] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:42:58] [INFO] [main] Message length: 1149
[2025-06-21 15:42:58] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:42:58] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:42:58] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:42:58] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:42:58] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:42:58] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:42:58] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:42:58] [INFO] [main] fromPacket: checksum = -1286246889
[2025-06-21 15:42:58] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:42:58] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:42:58] [INFO] [main] Set server's public key
[2025-06-21 15:42:58] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:42:58] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:42:58] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:42:58] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:42:58] [INFO] [main] Starting authentication...
[2025-06-21 15:42:58] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 15:42:58] [INFO] [main] Using password authentication
[2025-06-21 15:42:58] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 15:42:58] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 15:42:58] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 15:42:58] [INFO] [main] Message sent successfully
[2025-06-21 15:42:58] [INFO] [main] Sent authentication request
[2025-06-21 15:42:58] [INFO] [main] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [main] Reading encrypted message...
[2025-06-21 15:42:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:42:58] [INFO] [main] Encrypted message length: 84
[2025-06-21 15:42:58] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 15:42:58] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 15:42:58] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 15:42:58] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 15:42:58] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 15:42:58] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:42:58] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 15:42:58] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 15:42:58] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 15:42:58] [INFO] [main] Authentication successful
[2025-06-21 15:42:58] [INFO] [main] Sending service request for: shell
[2025-06-21 15:42:58] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 15:42:58] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 15:42:58] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:42:58] [INFO] [main] Message sent successfully
[2025-06-21 15:42:58] [INFO] [main] Sent service request
[2025-06-21 15:42:58] [INFO] [main] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [main] Reading encrypted message...
[2025-06-21 15:42:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:42:58] [INFO] [main] Encrypted message length: 42
[2025-06-21 15:42:58] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 15:42:58] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 15:42:58] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 15:42:58] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 15:42:58] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 15:42:58] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:42:58] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 15:42:58] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 15:42:58] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 15:42:58] [INFO] [main] Service request accepted
[2025-06-21 15:42:58] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:42:58] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:42:58] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:42:58] [INFO] [main] Message sent successfully
[2025-06-21 15:42:58] [INFO] [main] Waiting for shell response...
[2025-06-21 15:42:58] [INFO] [main] Waiting to receive message...
[2025-06-21 15:42:58] [INFO] [main] Reading encrypted message...
[2025-06-21 15:42:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:42:58] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:42:58] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:42:58] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:42:58] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:42:58] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:42:58] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:42:58] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:42:58] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:42:58] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:42:58] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:42:58] [INFO] [main] Shell response processed successfully
[2025-06-21 15:43:02] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:43:02] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:43:02] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:43:02] [INFO] [main] Message sent successfully
[2025-06-21 15:43:02] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:43:02] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:43:02] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:43:02] [INFO] [main] Message sent successfully
[2025-06-21 15:43:02] [INFO] [main] Protocol handler closed
[2025-06-21 15:43:02] [INFO] [main] Disconnected from server
[2025-06-21 15:43:05] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:43:05] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:43:06] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:43:06] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:43:06] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:43:06] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:43:06] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:43:06] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:43:06] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:43:06] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:43:06] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:43:06] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:43:06] [INFO] [main] Connected successfully
[2025-06-21 15:43:06] [INFO] [main] Starting key exchange...
[2025-06-21 15:43:06] [INFO] [main] Generated DH key pair
[2025-06-21 15:43:06] [INFO] [main] Created key exchange init message
[2025-06-21 15:43:06] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:43:06] [INFO] [main] Message sent successfully
[2025-06-21 15:43:06] [INFO] [main] Sent key exchange init message
[2025-06-21 15:43:06] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:43:06] [INFO] [main] Waiting to receive message...
[2025-06-21 15:43:06] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:43:06] [INFO] [main] Message length: 1149
[2025-06-21 15:43:06] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:43:06] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:43:06] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:43:06] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:43:06] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:43:06] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:43:06] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:43:06] [INFO] [main] fromPacket: checksum = 895934684
[2025-06-21 15:43:06] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:43:06] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:43:06] [INFO] [main] Set server's public key
[2025-06-21 15:43:06] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:43:06] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:43:06] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:43:06] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:43:06] [INFO] [main] Starting authentication...
[2025-06-21 15:43:06] [INFO] [main] Preparing auth for user: user1, type: password
[2025-06-21 15:43:06] [INFO] [main] Using password authentication
[2025-06-21 15:43:06] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 15:43:06] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 15:43:06] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 15:43:06] [INFO] [main] Message sent successfully
[2025-06-21 15:43:06] [INFO] [main] Sent authentication request
[2025-06-21 15:43:06] [INFO] [main] Waiting to receive message...
[2025-06-21 15:43:06] [INFO] [main] Reading encrypted message...
[2025-06-21 15:43:06] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:43:06] [INFO] [main] Encrypted message length: 81
[2025-06-21 15:43:06] [INFO] [main] Read 81 bytes for encrypted message body
[2025-06-21 15:43:06] [INFO] [main] Decrypting encrypted message, length: 81
[2025-06-21 15:43:06] [INFO] [main] Message decrypted successfully, new length: 53
[2025-06-21 15:43:06] [INFO] [main] fromPacket: restLength = 49
[2025-06-21 15:43:06] [INFO] [main] fromPacket: parsed message type = AUTH_FAILURE
[2025-06-21 15:43:06] [INFO] [main] fromPacket: payloadLength = 44 (restLength=49 - 5)
[2025-06-21 15:43:06] [INFO] [main] fromPacket: checksum = -595954133
[2025-06-21 15:43:06] [INFO] [main] Received encrypted message: AUTH_FAILURE
[2025-06-21 15:43:06] [INFO] [main] Received auth response: AUTH_FAILURE
[2025-06-21 15:43:06] [ERROR] [main] Authentication failed
[2025-06-21 15:43:06] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:43:06] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:43:06] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:43:06] [INFO] [main] Message sent successfully
[2025-06-21 15:43:06] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:43:06] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:43:06] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:43:06] [INFO] [main] Protocol handler closed
[2025-06-21 15:43:06] [INFO] [main] Disconnected from server
[2025-06-21 15:43:09] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:43:09] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:43:10] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:43:10] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:43:10] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:43:10] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:43:10] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:43:10] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:43:10] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:43:10] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:43:10] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:43:10] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:43:10] [INFO] [main] Connected successfully
[2025-06-21 15:43:10] [INFO] [main] Starting key exchange...
[2025-06-21 15:43:10] [INFO] [main] Generated DH key pair
[2025-06-21 15:43:10] [INFO] [main] Created key exchange init message
[2025-06-21 15:43:10] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:43:10] [INFO] [main] Message sent successfully
[2025-06-21 15:43:10] [INFO] [main] Sent key exchange init message
[2025-06-21 15:43:10] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:43:10] [INFO] [main] Waiting to receive message...
[2025-06-21 15:43:10] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:43:10] [INFO] [main] Message length: 1149
[2025-06-21 15:43:10] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:43:10] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:43:10] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:43:10] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:43:10] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:43:10] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:43:10] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:43:10] [INFO] [main] fromPacket: checksum = -1506940257
[2025-06-21 15:43:10] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:43:10] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:43:10] [INFO] [main] Set server's public key
[2025-06-21 15:43:10] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:43:10] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:43:10] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:43:10] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:43:10] [INFO] [main] Starting authentication...
[2025-06-21 15:43:10] [INFO] [main] Preparing auth for user: test, type: password
[2025-06-21 15:43:10] [INFO] [main] Using password authentication
[2025-06-21 15:43:10] [INFO] [main] Sending message: AUTH_REQUEST, length: 56
[2025-06-21 15:43:10] [INFO] [main] Message encrypted, new length: 84
[2025-06-21 15:43:10] [INFO] [main] Added length prefix for encrypted message, total length: 88
[2025-06-21 15:43:10] [INFO] [main] Message sent successfully
[2025-06-21 15:43:10] [INFO] [main] Sent authentication request
[2025-06-21 15:43:10] [INFO] [main] Waiting to receive message...
[2025-06-21 15:43:10] [INFO] [main] Reading encrypted message...
[2025-06-21 15:43:10] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:43:10] [INFO] [main] Encrypted message length: 81
[2025-06-21 15:43:10] [INFO] [main] Read 81 bytes for encrypted message body
[2025-06-21 15:43:10] [INFO] [main] Decrypting encrypted message, length: 81
[2025-06-21 15:43:10] [INFO] [main] Message decrypted successfully, new length: 53
[2025-06-21 15:43:10] [INFO] [main] fromPacket: restLength = 49
[2025-06-21 15:43:10] [INFO] [main] fromPacket: parsed message type = AUTH_FAILURE
[2025-06-21 15:43:10] [INFO] [main] fromPacket: payloadLength = 44 (restLength=49 - 5)
[2025-06-21 15:43:10] [INFO] [main] fromPacket: checksum = -595954133
[2025-06-21 15:43:10] [INFO] [main] Received encrypted message: AUTH_FAILURE
[2025-06-21 15:43:10] [INFO] [main] Received auth response: AUTH_FAILURE
[2025-06-21 15:43:10] [ERROR] [main] Authentication failed
[2025-06-21 15:43:10] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:43:10] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:43:10] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:43:10] [INFO] [main] Message sent successfully
[2025-06-21 15:43:10] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:43:10] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:43:10] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:43:10] [INFO] [main] Protocol handler closed
[2025-06-21 15:43:10] [INFO] [main] Disconnected from server
[2025-06-21 15:46:28] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:46:28] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:46:28] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:46:28] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:46:28] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:46:28] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:46:28] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:46:28] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:46:28] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:46:28] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:46:28] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:46:28] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:46:28] [INFO] [main] Connected successfully
[2025-06-21 15:46:28] [INFO] [main] Starting key exchange...
[2025-06-21 15:46:28] [INFO] [main] Generated DH key pair
[2025-06-21 15:46:28] [INFO] [main] Created key exchange init message
[2025-06-21 15:46:28] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:46:28] [INFO] [main] Message sent successfully
[2025-06-21 15:46:28] [INFO] [main] Sent key exchange init message
[2025-06-21 15:46:28] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:46:28] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:46:28] [INFO] [main] Message length: 1149
[2025-06-21 15:46:28] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:46:28] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:46:28] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:46:28] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:46:28] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:46:28] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:46:28] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:46:28] [INFO] [main] fromPacket: checksum = -1964882163
[2025-06-21 15:46:28] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:46:28] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:46:28] [INFO] [main] Set server's public key
[2025-06-21 15:46:28] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:46:28] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:46:28] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:46:28] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:46:28] [INFO] [main] Starting authentication...
[2025-06-21 15:46:28] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 15:46:28] [INFO] [main] Using password authentication
[2025-06-21 15:46:28] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 15:46:28] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 15:46:28] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 15:46:28] [INFO] [main] Message sent successfully
[2025-06-21 15:46:28] [INFO] [main] Sent authentication request
[2025-06-21 15:46:28] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [main] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [main] Encrypted message length: 84
[2025-06-21 15:46:28] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 15:46:28] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 15:46:28] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 15:46:28] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 15:46:28] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:46:28] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 15:46:28] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 15:46:28] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 15:46:28] [INFO] [main] Authentication successful
[2025-06-21 15:46:28] [INFO] [main] Sending service request for: shell
[2025-06-21 15:46:28] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 15:46:28] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 15:46:28] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:46:28] [INFO] [main] Message sent successfully
[2025-06-21 15:46:28] [INFO] [main] Sent service request
[2025-06-21 15:46:28] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [main] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [main] Encrypted message length: 42
[2025-06-21 15:46:28] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 15:46:28] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 15:46:28] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 15:46:28] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 15:46:28] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:46:28] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 15:46:28] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 15:46:28] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 15:46:28] [INFO] [main] Service request accepted
[2025-06-21 15:46:28] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:46:28] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:46:28] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:46:28] [INFO] [main] Message sent successfully
[2025-06-21 15:46:28] [INFO] [main] Waiting for shell response...
[2025-06-21 15:46:28] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:28] [INFO] [main] Reading encrypted message...
[2025-06-21 15:46:28] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:46:28] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:46:28] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:46:28] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:46:28] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:46:28] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:46:28] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:46:28] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:46:28] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:46:28] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:46:28] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:46:28] [INFO] [main] Shell response processed successfully
[2025-06-21 15:46:28] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:46:28] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:46:28] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:46:28] [INFO] [main] Message sent successfully
[2025-06-21 15:46:29] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:46:29] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:46:29] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:46:29] [INFO] [main] Message sent successfully
[2025-06-21 15:46:29] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:46:29] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:46:29] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:46:29] [INFO] [main] Protocol handler closed
[2025-06-21 15:46:29] [INFO] [main] Disconnected from server
[2025-06-21 15:46:51] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:46:51] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:46:51] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:46:51] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:46:51] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:46:51] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:46:51] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:46:51] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:46:51] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:46:51] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 15:46:51] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:46:51] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:46:51] [INFO] [main] Connected successfully
[2025-06-21 15:46:51] [INFO] [main] Starting key exchange...
[2025-06-21 15:46:51] [INFO] [main] Generated DH key pair
[2025-06-21 15:46:51] [INFO] [main] Created key exchange init message
[2025-06-21 15:46:51] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:46:51] [INFO] [main] Message sent successfully
[2025-06-21 15:46:51] [INFO] [main] Sent key exchange init message
[2025-06-21 15:46:51] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:46:51] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:46:51] [INFO] [main] Message length: 1149
[2025-06-21 15:46:51] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:46:51] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:46:51] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:46:51] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:46:51] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:46:51] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:46:51] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:46:51] [INFO] [main] fromPacket: checksum = -66514943
[2025-06-21 15:46:51] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:46:51] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:46:51] [INFO] [main] Set server's public key
[2025-06-21 15:46:51] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:46:51] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:46:51] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:46:51] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:46:51] [INFO] [main] Starting authentication...
[2025-06-21 15:46:51] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 15:46:51] [INFO] [main] Using password authentication
[2025-06-21 15:46:51] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 15:46:51] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 15:46:51] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 15:46:51] [INFO] [main] Message sent successfully
[2025-06-21 15:46:51] [INFO] [main] Sent authentication request
[2025-06-21 15:46:51] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [main] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [main] Encrypted message length: 84
[2025-06-21 15:46:51] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 15:46:51] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 15:46:51] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 15:46:51] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 15:46:51] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:46:51] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 15:46:51] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 15:46:51] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 15:46:51] [INFO] [main] Authentication successful
[2025-06-21 15:46:51] [INFO] [main] Sending service request for: shell
[2025-06-21 15:46:51] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 15:46:51] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 15:46:51] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:46:51] [INFO] [main] Message sent successfully
[2025-06-21 15:46:51] [INFO] [main] Sent service request
[2025-06-21 15:46:51] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [main] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [main] Encrypted message length: 42
[2025-06-21 15:46:51] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 15:46:51] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 15:46:51] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 15:46:51] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 15:46:51] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:46:51] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 15:46:51] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 15:46:51] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 15:46:51] [INFO] [main] Service request accepted
[2025-06-21 15:46:51] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:46:51] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:46:51] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:46:51] [INFO] [main] Message sent successfully
[2025-06-21 15:46:51] [INFO] [main] Waiting for shell response...
[2025-06-21 15:46:51] [INFO] [main] Waiting to receive message...
[2025-06-21 15:46:51] [INFO] [main] Reading encrypted message...
[2025-06-21 15:46:51] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:46:51] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:46:51] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:46:51] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:46:51] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:46:51] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:46:51] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:46:51] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:46:51] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:46:51] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:46:51] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:46:51] [INFO] [main] Shell response processed successfully
[2025-06-21 15:46:51] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:46:51] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:46:51] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:46:51] [INFO] [main] Message sent successfully
[2025-06-21 15:46:52] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:46:52] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:46:52] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:46:52] [INFO] [main] Message sent successfully
[2025-06-21 15:46:52] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:46:52] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:46:52] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:46:52] [INFO] [main] Protocol handler closed
[2025-06-21 15:46:52] [INFO] [main] Disconnected from server
[2025-06-21 15:49:34] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:49:34] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:49:37] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:49:37] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:49:37] [INFO] [main] Auth credentials for user2 - Username: user1, Type: password
[2025-06-21 15:49:37] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:49:37] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:49:37] [INFO] [main] Connected successfully
[2025-06-21 15:49:37] [INFO] [main] Starting key exchange...
[2025-06-21 15:49:37] [INFO] [main] Generated DH key pair
[2025-06-21 15:49:37] [INFO] [main] Created key exchange init message
[2025-06-21 15:49:37] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:49:37] [INFO] [main] Message sent successfully
[2025-06-21 15:49:37] [INFO] [main] Sent key exchange init message
[2025-06-21 15:49:37] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:49:37] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:49:37] [INFO] [main] Message length: 1149
[2025-06-21 15:49:37] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:49:37] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 15:49:37] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:49:37] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:49:37] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:49:37] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:49:37] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:49:37] [INFO] [main] fromPacket: checksum = 441157768
[2025-06-21 15:49:37] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:49:37] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:49:37] [INFO] [main] Set server's public key
[2025-06-21 15:49:37] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:49:37] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:49:37] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:49:37] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:49:37] [INFO] [main] Starting authentication...
[2025-06-21 15:49:37] [INFO] [main] Preparing auth for user: user1, type: password
[2025-06-21 15:49:37] [INFO] [main] Using password authentication
[2025-06-21 15:49:37] [INFO] [main] Sending message: AUTH_REQUEST, length: 60
[2025-06-21 15:49:37] [INFO] [main] Message encrypted, new length: 88
[2025-06-21 15:49:37] [INFO] [main] Added length prefix for encrypted message, total length: 92
[2025-06-21 15:49:37] [INFO] [main] Message sent successfully
[2025-06-21 15:49:37] [INFO] [main] Sent authentication request
[2025-06-21 15:49:37] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [main] Reading encrypted message...
[2025-06-21 15:49:37] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:49:37] [INFO] [main] Encrypted message length: 84
[2025-06-21 15:49:37] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 15:49:37] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 15:49:37] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 15:49:37] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 15:49:37] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 15:49:37] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:49:37] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 15:49:37] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 15:49:37] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 15:49:37] [INFO] [main] Authentication successful
[2025-06-21 15:49:37] [INFO] [main] Sending service request for: shell
[2025-06-21 15:49:37] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 15:49:37] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 15:49:37] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:49:37] [INFO] [main] Message sent successfully
[2025-06-21 15:49:37] [INFO] [main] Sent service request
[2025-06-21 15:49:37] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [main] Reading encrypted message...
[2025-06-21 15:49:37] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:49:37] [INFO] [main] Encrypted message length: 42
[2025-06-21 15:49:37] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 15:49:37] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 15:49:37] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 15:49:37] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 15:49:37] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 15:49:37] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:49:37] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 15:49:37] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 15:49:37] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 15:49:37] [INFO] [main] Service request accepted
[2025-06-21 15:49:37] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:49:37] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:49:37] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:49:37] [INFO] [main] Message sent successfully
[2025-06-21 15:49:37] [INFO] [main] Waiting for shell response...
[2025-06-21 15:49:37] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:37] [INFO] [main] Reading encrypted message...
[2025-06-21 15:49:37] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:49:37] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:49:37] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:49:37] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:49:37] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:49:37] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:49:37] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:49:37] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:49:37] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:49:37] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:49:37] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:49:37] [INFO] [main] Shell response processed successfully
[2025-06-21 15:49:51] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:49:51] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:49:51] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:49:51] [INFO] [main] Message sent successfully
[2025-06-21 15:49:51] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 15:49:51] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 15:49:51] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 15:49:51] [INFO] [main] Message sent successfully
[2025-06-21 15:49:51] [INFO] [main] Protocol handler closed
[2025-06-21 15:49:51] [INFO] [main] Disconnected from server
[2025-06-21 15:49:52] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 15:49:52] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 15:49:54] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 15:49:54] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 15:49:54] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 15:49:54] [INFO] [main] ClientConnection constructor called
[2025-06-21 15:49:54] [INFO] [main] Connecting to localhost:2222
[2025-06-21 15:49:54] [INFO] [main] Connected successfully
[2025-06-21 15:49:54] [INFO] [main] Starting key exchange...
[2025-06-21 15:49:55] [INFO] [main] Generated DH key pair
[2025-06-21 15:49:55] [INFO] [main] Created key exchange init message
[2025-06-21 15:49:55] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 15:49:55] [INFO] [main] Message sent successfully
[2025-06-21 15:49:55] [INFO] [main] Sent key exchange init message
[2025-06-21 15:49:55] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 15:49:55] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [main] Read 4 bytes for message length
[2025-06-21 15:49:55] [INFO] [main] Message length: 1149
[2025-06-21 15:49:55] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 15:49:55] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 15:49:55] [INFO] [main] Raw message type byte: 2
[2025-06-21 15:49:55] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 15:49:55] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 15:49:55] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 15:49:55] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 15:49:55] [INFO] [main] fromPacket: checksum = -1253471221
[2025-06-21 15:49:55] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 15:49:55] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 15:49:55] [INFO] [main] Set server's public key
[2025-06-21 15:49:55] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 15:49:55] [INFO] [main] Initialized symmetric encryption
[2025-06-21 15:49:55] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 15:49:55] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 15:49:55] [INFO] [main] Starting authentication...
[2025-06-21 15:49:55] [INFO] [main] Preparing auth for user: test, type: password
[2025-06-21 15:49:55] [INFO] [main] Using password authentication
[2025-06-21 15:49:55] [INFO] [main] Sending message: AUTH_REQUEST, length: 55
[2025-06-21 15:49:55] [INFO] [main] Message encrypted, new length: 83
[2025-06-21 15:49:55] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-21 15:49:55] [INFO] [main] Message sent successfully
[2025-06-21 15:49:55] [INFO] [main] Sent authentication request
[2025-06-21 15:49:55] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [main] Reading encrypted message...
[2025-06-21 15:49:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:49:55] [INFO] [main] Encrypted message length: 84
[2025-06-21 15:49:55] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 15:49:55] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 15:49:55] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 15:49:55] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 15:49:55] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 15:49:55] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 15:49:55] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 15:49:55] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 15:49:55] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 15:49:55] [INFO] [main] Authentication successful
[2025-06-21 15:49:55] [INFO] [main] Sending service request for: shell
[2025-06-21 15:49:55] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 15:49:55] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 15:49:55] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 15:49:55] [INFO] [main] Message sent successfully
[2025-06-21 15:49:55] [INFO] [main] Sent service request
[2025-06-21 15:49:55] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [main] Reading encrypted message...
[2025-06-21 15:49:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:49:55] [INFO] [main] Encrypted message length: 42
[2025-06-21 15:49:55] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 15:49:55] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 15:49:55] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 15:49:55] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 15:49:55] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 15:49:55] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 15:49:55] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 15:49:55] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 15:49:55] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 15:49:55] [INFO] [main] Service request accepted
[2025-06-21 15:49:55] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 15:49:55] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 15:49:55] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 15:49:55] [INFO] [main] Message sent successfully
[2025-06-21 15:49:55] [INFO] [main] Waiting for shell response...
[2025-06-21 15:49:55] [INFO] [main] Waiting to receive message...
[2025-06-21 15:49:55] [INFO] [main] Reading encrypted message...
[2025-06-21 15:49:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:49:55] [INFO] [main] Encrypted message length: 171
[2025-06-21 15:49:55] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 15:49:55] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 15:49:55] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 15:49:55] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 15:49:55] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:49:55] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 15:49:55] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 15:49:55] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:49:55] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:49:55] [INFO] [main] Shell response processed successfully
[2025-06-21 15:50:03] [INFO] [main] Sending message: SHELL_COMMAND, length: 121
[2025-06-21 15:50:03] [INFO] [main] Message encrypted, new length: 149
[2025-06-21 15:50:03] [INFO] [main] Added length prefix for encrypted message, total length: 153
[2025-06-21 15:50:03] [INFO] [main] Message sent successfully
[2025-06-21 15:50:03] [INFO] [main] Waiting for shell response...
[2025-06-21 15:50:03] [INFO] [main] Waiting to receive message...
[2025-06-21 15:50:03] [INFO] [main] Reading encrypted message...
[2025-06-21 15:50:03] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 15:50:03] [INFO] [main] Encrypted message length: 338
[2025-06-21 15:50:03] [INFO] [main] Read 338 bytes for encrypted message body
[2025-06-21 15:50:03] [INFO] [main] Decrypting encrypted message, length: 338
[2025-06-21 15:50:03] [INFO] [main] Message decrypted successfully, new length: 310
[2025-06-21 15:50:03] [INFO] [main] fromPacket: restLength = 306
[2025-06-21 15:50:03] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 15:50:03] [INFO] [main] fromPacket: payloadLength = 301 (restLength=306 - 5)
[2025-06-21 15:50:03] [INFO] [main] fromPacket: checksum = -763407473
[2025-06-21 15:50:03] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 15:50:03] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 15:50:03] [INFO] [main] Shell response processed successfully
[2025-06-21 17:01:36] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 17:01:36] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 17:01:36] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 17:01:36] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 17:01:36] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 17:01:36] [INFO] [main] ClientConnection constructor called
[2025-06-21 17:01:36] [INFO] [main] Connecting to localhost:2222
[2025-06-21 17:01:36] [INFO] [main] Connected successfully
[2025-06-21 17:01:36] [INFO] [main] Starting key exchange...
[2025-06-21 17:01:36] [INFO] [main] Generated DH key pair
[2025-06-21 17:01:36] [INFO] [main] Created key exchange init message
[2025-06-21 17:01:36] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 17:01:36] [INFO] [main] Message sent successfully
[2025-06-21 17:01:36] [INFO] [main] Sent key exchange init message
[2025-06-21 17:01:36] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 17:01:36] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [main] Read 4 bytes for message length
[2025-06-21 17:01:36] [INFO] [main] Message length: 1149
[2025-06-21 17:01:36] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 17:01:36] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:01:36] [INFO] [main] Raw message type byte: 2
[2025-06-21 17:01:36] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 17:01:36] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 17:01:36] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 17:01:36] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 17:01:36] [INFO] [main] fromPacket: checksum = -1369731716
[2025-06-21 17:01:36] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 17:01:36] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 17:01:36] [INFO] [main] Set server's public key
[2025-06-21 17:01:36] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 17:01:36] [INFO] [main] Initialized symmetric encryption
[2025-06-21 17:01:36] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:01:36] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 17:01:36] [INFO] [main] Starting authentication...
[2025-06-21 17:01:36] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 17:01:36] [INFO] [main] Using password authentication
[2025-06-21 17:01:36] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 17:01:36] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 17:01:36] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 17:01:36] [INFO] [main] Message sent successfully
[2025-06-21 17:01:36] [INFO] [main] Sent authentication request
[2025-06-21 17:01:36] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [main] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [main] Encrypted message length: 84
[2025-06-21 17:01:36] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 17:01:36] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 17:01:36] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 17:01:36] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 17:01:36] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 17:01:36] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 17:01:36] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 17:01:36] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 17:01:36] [INFO] [main] Authentication successful
[2025-06-21 17:01:36] [INFO] [main] Sending service request for: shell
[2025-06-21 17:01:36] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 17:01:36] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 17:01:36] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:01:36] [INFO] [main] Message sent successfully
[2025-06-21 17:01:36] [INFO] [main] Sent service request
[2025-06-21 17:01:36] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [main] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [main] Encrypted message length: 42
[2025-06-21 17:01:36] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 17:01:36] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 17:01:36] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 17:01:36] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 17:01:36] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:01:36] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 17:01:36] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 17:01:36] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 17:01:36] [INFO] [main] Service request accepted
[2025-06-21 17:01:36] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 17:01:36] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 17:01:36] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 17:01:36] [INFO] [main] Message sent successfully
[2025-06-21 17:01:36] [INFO] [main] Waiting for shell response...
[2025-06-21 17:01:36] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:36] [INFO] [main] Reading encrypted message...
[2025-06-21 17:01:36] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:01:36] [INFO] [main] Encrypted message length: 171
[2025-06-21 17:01:36] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 17:01:36] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 17:01:36] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 17:01:36] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 17:01:36] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 17:01:36] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 17:01:36] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 17:01:36] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 17:01:36] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 17:01:36] [INFO] [main] Shell response processed successfully
[2025-06-21 17:01:36] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:01:36] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:01:36] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:01:36] [INFO] [main] Message sent successfully
[2025-06-21 17:01:37] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:01:37] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:01:37] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:01:37] [INFO] [main] Message sent successfully
[2025-06-21 17:01:37] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:01:37] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:01:37] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:01:37] [INFO] [main] Protocol handler closed
[2025-06-21 17:01:37] [INFO] [main] Disconnected from server
[2025-06-21 17:01:38] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 17:01:38] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 17:01:38] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 17:01:38] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 17:01:38] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 17:01:38] [INFO] [main] ClientConnection constructor called
[2025-06-21 17:01:38] [INFO] [main] Connecting to localhost:2222
[2025-06-21 17:01:38] [INFO] [main] Connected successfully
[2025-06-21 17:01:38] [INFO] [main] Starting key exchange...
[2025-06-21 17:01:38] [INFO] [main] Generated DH key pair
[2025-06-21 17:01:38] [INFO] [main] Created key exchange init message
[2025-06-21 17:01:38] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 17:01:38] [INFO] [main] Message sent successfully
[2025-06-21 17:01:38] [INFO] [main] Sent key exchange init message
[2025-06-21 17:01:38] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 17:01:38] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [main] Read 4 bytes for message length
[2025-06-21 17:01:38] [INFO] [main] Message length: 1149
[2025-06-21 17:01:38] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 17:01:38] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 17:01:38] [INFO] [main] Raw message type byte: 2
[2025-06-21 17:01:38] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 17:01:38] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 17:01:38] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 17:01:38] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 17:01:38] [INFO] [main] fromPacket: checksum = 206100894
[2025-06-21 17:01:38] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 17:01:38] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 17:01:38] [INFO] [main] Set server's public key
[2025-06-21 17:01:38] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 17:01:38] [INFO] [main] Initialized symmetric encryption
[2025-06-21 17:01:38] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:01:38] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 17:01:38] [INFO] [main] Starting authentication...
[2025-06-21 17:01:38] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 17:01:38] [INFO] [main] Using password authentication
[2025-06-21 17:01:38] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 17:01:38] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 17:01:38] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 17:01:38] [INFO] [main] Message sent successfully
[2025-06-21 17:01:38] [INFO] [main] Sent authentication request
[2025-06-21 17:01:38] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [main] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [main] Encrypted message length: 84
[2025-06-21 17:01:38] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 17:01:38] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 17:01:38] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 17:01:38] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 17:01:38] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 17:01:38] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 17:01:38] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 17:01:38] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 17:01:38] [INFO] [main] Authentication successful
[2025-06-21 17:01:38] [INFO] [main] Sending service request for: shell
[2025-06-21 17:01:38] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 17:01:38] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 17:01:38] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:01:38] [INFO] [main] Message sent successfully
[2025-06-21 17:01:38] [INFO] [main] Sent service request
[2025-06-21 17:01:38] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [main] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [main] Encrypted message length: 42
[2025-06-21 17:01:38] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 17:01:38] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 17:01:38] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 17:01:38] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 17:01:38] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:01:38] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 17:01:38] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 17:01:38] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 17:01:38] [INFO] [main] Service request accepted
[2025-06-21 17:01:38] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 17:01:38] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 17:01:38] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 17:01:38] [INFO] [main] Message sent successfully
[2025-06-21 17:01:38] [INFO] [main] Waiting for shell response...
[2025-06-21 17:01:38] [INFO] [main] Waiting to receive message...
[2025-06-21 17:01:38] [INFO] [main] Reading encrypted message...
[2025-06-21 17:01:38] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:01:38] [INFO] [main] Encrypted message length: 171
[2025-06-21 17:01:38] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 17:01:38] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 17:01:38] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 17:01:38] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 17:01:38] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 17:01:38] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 17:01:38] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 17:01:38] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 17:01:38] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 17:01:38] [INFO] [main] Shell response processed successfully
[2025-06-21 17:01:38] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:01:38] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:01:38] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:01:38] [INFO] [main] Message sent successfully
[2025-06-21 17:01:39] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:01:39] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:01:39] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:01:39] [INFO] [main] Message sent successfully
[2025-06-21 17:01:39] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:01:39] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:01:39] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:01:39] [INFO] [main] Protocol handler closed
[2025-06-21 17:01:39] [INFO] [main] Disconnected from server
[2025-06-21 17:10:09] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 17:10:09] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 17:10:14] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 17:10:14] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 17:10:14] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 17:10:14] [INFO] [main] ClientConnection constructor called
[2025-06-21 17:10:14] [INFO] [main] Connecting to localhost:2222
[2025-06-21 17:10:14] [INFO] [main] Connected successfully
[2025-06-21 17:10:14] [INFO] [main] Starting key exchange...
[2025-06-21 17:10:14] [INFO] [main] Generated DH key pair
[2025-06-21 17:10:14] [INFO] [main] Created key exchange init message
[2025-06-21 17:10:14] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 17:10:14] [INFO] [main] Message sent successfully
[2025-06-21 17:10:14] [INFO] [main] Sent key exchange init message
[2025-06-21 17:10:14] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 17:10:14] [INFO] [main] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [main] Read 4 bytes for message length
[2025-06-21 17:10:14] [INFO] [main] Message length: 1149
[2025-06-21 17:10:14] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 17:10:14] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-21 17:10:14] [INFO] [main] Raw message type byte: 2
[2025-06-21 17:10:14] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 17:10:14] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 17:10:14] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 17:10:14] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 17:10:14] [INFO] [main] fromPacket: checksum = 1088602876
[2025-06-21 17:10:14] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 17:10:14] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 17:10:14] [INFO] [main] Set server's public key
[2025-06-21 17:10:14] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 17:10:14] [INFO] [main] Initialized symmetric encryption
[2025-06-21 17:10:14] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:10:14] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 17:10:14] [INFO] [main] Starting authentication...
[2025-06-21 17:10:14] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 17:10:14] [INFO] [main] Using password authentication
[2025-06-21 17:10:14] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 17:10:14] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 17:10:14] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 17:10:14] [INFO] [main] Message sent successfully
[2025-06-21 17:10:14] [INFO] [main] Sent authentication request
[2025-06-21 17:10:14] [INFO] [main] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [main] Reading encrypted message...
[2025-06-21 17:10:14] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:10:14] [INFO] [main] Encrypted message length: 84
[2025-06-21 17:10:14] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 17:10:14] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 17:10:14] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 17:10:14] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 17:10:14] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 17:10:14] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 17:10:14] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 17:10:14] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 17:10:14] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 17:10:14] [INFO] [main] Authentication successful
[2025-06-21 17:10:14] [INFO] [main] Sending service request for: shell
[2025-06-21 17:10:14] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 17:10:14] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 17:10:14] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:10:14] [INFO] [main] Message sent successfully
[2025-06-21 17:10:14] [INFO] [main] Sent service request
[2025-06-21 17:10:14] [INFO] [main] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [main] Reading encrypted message...
[2025-06-21 17:10:14] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:10:14] [INFO] [main] Encrypted message length: 42
[2025-06-21 17:10:14] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 17:10:14] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 17:10:14] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 17:10:14] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 17:10:14] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 17:10:14] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:10:14] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 17:10:14] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 17:10:14] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 17:10:14] [INFO] [main] Service request accepted
[2025-06-21 17:10:14] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 17:10:14] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 17:10:14] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 17:10:14] [INFO] [main] Message sent successfully
[2025-06-21 17:10:14] [INFO] [main] Waiting for shell response...
[2025-06-21 17:10:14] [INFO] [main] Waiting to receive message...
[2025-06-21 17:10:14] [INFO] [main] Reading encrypted message...
[2025-06-21 17:10:14] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:10:14] [INFO] [main] Encrypted message length: 171
[2025-06-21 17:10:14] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 17:10:14] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 17:10:14] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 17:10:14] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 17:10:14] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 17:10:14] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 17:10:14] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 17:10:14] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 17:10:14] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 17:10:14] [INFO] [main] Shell response processed successfully
[2025-06-21 17:11:23] [INFO] [main] Starting file download: test_upload2.txt
[2025-06-21 17:11:23] [INFO] [main] Sending message: FILE_DOWNLOAD_REQUEST, length: 63
[2025-06-21 17:11:23] [INFO] [main] Message encrypted, new length: 91
[2025-06-21 17:11:23] [INFO] [main] Added length prefix for encrypted message, total length: 95
[2025-06-21 17:11:23] [INFO] [main] Message sent successfully
[2025-06-21 17:11:23] [INFO] [main] Sent file download request
[2025-06-21 17:12:31] [INFO] [main] Starting file upload: test_upload2.txt (44 bytes)
[2025-06-21 17:12:31] [INFO] [main] Sending message: FILE_UPLOAD_REQUEST, length: 76
[2025-06-21 17:12:31] [INFO] [main] Message encrypted, new length: 104
[2025-06-21 17:12:31] [INFO] [main] Added length prefix for encrypted message, total length: 108
[2025-06-21 17:12:50] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:12:50] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:12:50] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:12:50] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:12:50] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:12:50] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:12:50] [INFO] [main] Protocol handler closed
[2025-06-21 17:12:50] [INFO] [main] Disconnected from server
[2025-06-21 17:12:52] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 17:12:52] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 17:12:55] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 17:12:55] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 17:12:55] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-21 17:12:55] [INFO] [main] ClientConnection constructor called
[2025-06-21 17:12:55] [INFO] [main] Connecting to localhost:2222
[2025-06-21 17:12:55] [INFO] [main] Connected successfully
[2025-06-21 17:12:55] [INFO] [main] Starting key exchange...
[2025-06-21 17:12:55] [INFO] [main] Generated DH key pair
[2025-06-21 17:12:55] [INFO] [main] Created key exchange init message
[2025-06-21 17:12:55] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 17:12:55] [INFO] [main] Message sent successfully
[2025-06-21 17:12:55] [INFO] [main] Sent key exchange init message
[2025-06-21 17:12:55] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 17:12:55] [INFO] [main] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [main] Read 4 bytes for message length
[2025-06-21 17:12:55] [INFO] [main] Message length: 1149
[2025-06-21 17:12:55] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 17:12:55] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:12:55] [INFO] [main] Raw message type byte: 2
[2025-06-21 17:12:55] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 17:12:55] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 17:12:55] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 17:12:55] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 17:12:55] [INFO] [main] fromPacket: checksum = 274618878
[2025-06-21 17:12:55] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 17:12:55] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 17:12:55] [INFO] [main] Set server's public key
[2025-06-21 17:12:55] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 17:12:55] [INFO] [main] Initialized symmetric encryption
[2025-06-21 17:12:55] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:12:55] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 17:12:55] [INFO] [main] Starting authentication...
[2025-06-21 17:12:55] [INFO] [main] Preparing auth for user: test, type: password
[2025-06-21 17:12:55] [INFO] [main] Using password authentication
[2025-06-21 17:12:55] [INFO] [main] Sending message: AUTH_REQUEST, length: 55
[2025-06-21 17:12:55] [INFO] [main] Message encrypted, new length: 83
[2025-06-21 17:12:55] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-21 17:12:55] [INFO] [main] Message sent successfully
[2025-06-21 17:12:55] [INFO] [main] Sent authentication request
[2025-06-21 17:12:55] [INFO] [main] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [main] Reading encrypted message...
[2025-06-21 17:12:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:12:55] [INFO] [main] Encrypted message length: 84
[2025-06-21 17:12:55] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 17:12:55] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 17:12:55] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 17:12:55] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 17:12:55] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 17:12:55] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 17:12:55] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 17:12:55] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 17:12:55] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 17:12:55] [INFO] [main] Authentication successful
[2025-06-21 17:12:55] [INFO] [main] Sending service request for: shell
[2025-06-21 17:12:55] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 17:12:55] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 17:12:55] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:12:55] [INFO] [main] Message sent successfully
[2025-06-21 17:12:55] [INFO] [main] Sent service request
[2025-06-21 17:12:55] [INFO] [main] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [main] Reading encrypted message...
[2025-06-21 17:12:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:12:55] [INFO] [main] Encrypted message length: 42
[2025-06-21 17:12:55] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 17:12:55] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 17:12:55] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 17:12:55] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 17:12:55] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 17:12:55] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:12:55] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 17:12:55] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 17:12:55] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 17:12:55] [INFO] [main] Service request accepted
[2025-06-21 17:12:55] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 17:12:55] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 17:12:55] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 17:12:55] [INFO] [main] Message sent successfully
[2025-06-21 17:12:55] [INFO] [main] Waiting for shell response...
[2025-06-21 17:12:55] [INFO] [main] Waiting to receive message...
[2025-06-21 17:12:55] [INFO] [main] Reading encrypted message...
[2025-06-21 17:12:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:12:55] [INFO] [main] Encrypted message length: 171
[2025-06-21 17:12:55] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 17:12:55] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 17:12:55] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 17:12:55] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 17:12:55] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 17:12:55] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 17:12:55] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 17:12:55] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 17:12:55] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 17:12:55] [INFO] [main] Shell response processed successfully
[2025-06-21 17:13:31] [INFO] [main] Starting file download: test.txt
[2025-06-21 17:13:31] [INFO] [main] Sending message: FILE_DOWNLOAD_REQUEST, length: 47
[2025-06-21 17:13:31] [INFO] [main] Message encrypted, new length: 75
[2025-06-21 17:13:31] [INFO] [main] Added length prefix for encrypted message, total length: 79
[2025-06-21 17:13:31] [INFO] [main] Message sent successfully
[2025-06-21 17:13:31] [INFO] [main] Sent file download request
[2025-06-21 17:16:39] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 17:16:39] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 17:16:48] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 17:16:48] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 17:16:48] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 17:16:48] [INFO] [main] ClientConnection constructor called
[2025-06-21 17:16:48] [INFO] [main] Connecting to localhost:2222
[2025-06-21 17:16:48] [INFO] [main] Connected successfully
[2025-06-21 17:16:48] [INFO] [main] Starting key exchange...
[2025-06-21 17:16:49] [INFO] [main] Generated DH key pair
[2025-06-21 17:16:49] [INFO] [main] Created key exchange init message
[2025-06-21 17:16:49] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 17:16:49] [INFO] [main] Message sent successfully
[2025-06-21 17:16:49] [INFO] [main] Sent key exchange init message
[2025-06-21 17:16:49] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 17:16:49] [INFO] [main] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [main] Read 4 bytes for message length
[2025-06-21 17:16:49] [INFO] [main] Message length: 1149
[2025-06-21 17:16:49] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 17:16:49] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:16:49] [INFO] [main] Raw message type byte: 2
[2025-06-21 17:16:49] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 17:16:49] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 17:16:49] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 17:16:49] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 17:16:49] [INFO] [main] fromPacket: checksum = -1165682134
[2025-06-21 17:16:49] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 17:16:49] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 17:16:49] [INFO] [main] Set server's public key
[2025-06-21 17:16:49] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 17:16:49] [INFO] [main] Initialized symmetric encryption
[2025-06-21 17:16:49] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:16:49] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 17:16:49] [INFO] [main] Starting authentication...
[2025-06-21 17:16:49] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 17:16:49] [INFO] [main] Using password authentication
[2025-06-21 17:16:49] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 17:16:49] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 17:16:49] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 17:16:49] [INFO] [main] Message sent successfully
[2025-06-21 17:16:49] [INFO] [main] Sent authentication request
[2025-06-21 17:16:49] [INFO] [main] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [main] Reading encrypted message...
[2025-06-21 17:16:49] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:16:49] [INFO] [main] Encrypted message length: 84
[2025-06-21 17:16:49] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 17:16:49] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 17:16:49] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 17:16:49] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 17:16:49] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 17:16:49] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 17:16:49] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 17:16:49] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 17:16:49] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 17:16:49] [INFO] [main] Authentication successful
[2025-06-21 17:16:49] [INFO] [main] Sending service request for: shell
[2025-06-21 17:16:49] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 17:16:49] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 17:16:49] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:16:49] [INFO] [main] Message sent successfully
[2025-06-21 17:16:49] [INFO] [main] Sent service request
[2025-06-21 17:16:49] [INFO] [main] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [main] Reading encrypted message...
[2025-06-21 17:16:49] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:16:49] [INFO] [main] Encrypted message length: 42
[2025-06-21 17:16:49] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 17:16:49] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 17:16:49] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 17:16:49] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 17:16:49] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 17:16:49] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:16:49] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 17:16:49] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 17:16:49] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 17:16:49] [INFO] [main] Service request accepted
[2025-06-21 17:16:49] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 17:16:49] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 17:16:49] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 17:16:49] [INFO] [main] Message sent successfully
[2025-06-21 17:16:49] [INFO] [main] Waiting for shell response...
[2025-06-21 17:16:49] [INFO] [main] Waiting to receive message...
[2025-06-21 17:16:49] [INFO] [main] Reading encrypted message...
[2025-06-21 17:16:49] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:16:49] [INFO] [main] Encrypted message length: 171
[2025-06-21 17:16:49] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 17:16:49] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 17:16:49] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 17:16:49] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 17:16:49] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 17:16:49] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 17:16:49] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 17:16:49] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 17:16:49] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 17:16:49] [INFO] [main] Shell response processed successfully
[2025-06-21 17:17:50] [INFO] [main] Starting file upload: test_upload.txt (74 bytes)
[2025-06-21 17:17:50] [INFO] [main] Sending message: FILE_UPLOAD_REQUEST, length: 75
[2025-06-21 17:17:50] [INFO] [main] Message encrypted, new length: 103
[2025-06-21 17:17:50] [INFO] [main] Added length prefix for encrypted message, total length: 107
[2025-06-21 17:17:50] [INFO] [main] Message sent successfully
[2025-06-21 17:17:50] [INFO] [main] Sent file upload request
[2025-06-21 17:17:50] [INFO] [main] Waiting to receive message...
[2025-06-21 17:17:50] [INFO] [main] Reading encrypted message...
[2025-06-21 17:18:08] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:18:08] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:18:08] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:18:08] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-21 17:18:08] [INFO] [main] Message encrypted, new length: 71
[2025-06-21 17:18:08] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-21 17:18:08] [INFO] [main] Protocol handler closed
[2025-06-21 17:18:08] [INFO] [main] Disconnected from server
[2025-06-21 17:20:48] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-21 17:20:48] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-21 17:20:58] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-21 17:20:58] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-21 17:20:58] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-21 17:20:58] [INFO] [main] ClientConnection constructor called
[2025-06-21 17:20:58] [INFO] [main] Connecting to localhost:2222
[2025-06-21 17:20:58] [INFO] [main] Connected successfully
[2025-06-21 17:20:58] [INFO] [main] Starting key exchange...
[2025-06-21 17:20:58] [INFO] [main] Generated DH key pair
[2025-06-21 17:20:58] [INFO] [main] Created key exchange init message
[2025-06-21 17:20:58] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-21 17:20:58] [INFO] [main] Message sent successfully
[2025-06-21 17:20:58] [INFO] [main] Sent key exchange init message
[2025-06-21 17:20:58] [INFO] [main] Waiting for key exchange reply...
[2025-06-21 17:20:58] [INFO] [main] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [main] Read 4 bytes for message length
[2025-06-21 17:20:58] [INFO] [main] Message length: 1149
[2025-06-21 17:20:58] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-21 17:20:58] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-21 17:20:58] [INFO] [main] Raw message type byte: 2
[2025-06-21 17:20:58] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-21 17:20:58] [INFO] [main] fromPacket: restLength = 1149
[2025-06-21 17:20:58] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-21 17:20:58] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-21 17:20:58] [INFO] [main] fromPacket: checksum = 608255691
[2025-06-21 17:20:58] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-21 17:20:58] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-21 17:20:58] [INFO] [main] Set server's public key
[2025-06-21 17:20:58] [INFO] [main] Computed shared secret, length: 256
[2025-06-21 17:20:58] [INFO] [main] Initialized symmetric encryption
[2025-06-21 17:20:58] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-21 17:20:58] [INFO] [main] Enabled encryption in protocol handler
[2025-06-21 17:20:58] [INFO] [main] Starting authentication...
[2025-06-21 17:20:58] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-21 17:20:58] [INFO] [main] Using password authentication
[2025-06-21 17:20:58] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-21 17:20:58] [INFO] [main] Message encrypted, new length: 85
[2025-06-21 17:20:58] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-21 17:20:58] [INFO] [main] Message sent successfully
[2025-06-21 17:20:58] [INFO] [main] Sent authentication request
[2025-06-21 17:20:58] [INFO] [main] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [main] Reading encrypted message...
[2025-06-21 17:20:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:20:58] [INFO] [main] Encrypted message length: 84
[2025-06-21 17:20:58] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-21 17:20:58] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-21 17:20:58] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-21 17:20:58] [INFO] [main] fromPacket: restLength = 52
[2025-06-21 17:20:58] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-21 17:20:58] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-21 17:20:58] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-21 17:20:58] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-21 17:20:58] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-21 17:20:58] [INFO] [main] Authentication successful
[2025-06-21 17:20:58] [INFO] [main] Sending service request for: shell
[2025-06-21 17:20:58] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-21 17:20:58] [INFO] [main] Message encrypted, new length: 42
[2025-06-21 17:20:58] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-21 17:20:58] [INFO] [main] Message sent successfully
[2025-06-21 17:20:58] [INFO] [main] Sent service request
[2025-06-21 17:20:58] [INFO] [main] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [main] Reading encrypted message...
[2025-06-21 17:20:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:20:58] [INFO] [main] Encrypted message length: 42
[2025-06-21 17:20:58] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-21 17:20:58] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-21 17:20:58] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-21 17:20:58] [INFO] [main] fromPacket: restLength = 10
[2025-06-21 17:20:58] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-21 17:20:58] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-21 17:20:58] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-21 17:20:58] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-21 17:20:58] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-21 17:20:58] [INFO] [main] Service request accepted
[2025-06-21 17:20:58] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-21 17:20:58] [INFO] [main] Message encrypted, new length: 157
[2025-06-21 17:20:58] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-21 17:20:58] [INFO] [main] Message sent successfully
[2025-06-21 17:20:58] [INFO] [main] Waiting for shell response...
[2025-06-21 17:20:58] [INFO] [main] Waiting to receive message...
[2025-06-21 17:20:58] [INFO] [main] Reading encrypted message...
[2025-06-21 17:20:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-21 17:20:58] [INFO] [main] Encrypted message length: 171
[2025-06-21 17:20:58] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-21 17:20:58] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-21 17:20:58] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-21 17:20:58] [INFO] [main] fromPacket: restLength = 139
[2025-06-21 17:20:58] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-21 17:20:58] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-21 17:20:58] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-21 17:20:58] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-21 17:20:58] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-21 17:20:58] [INFO] [main] Shell response processed successfully
[2025-06-22 17:35:39] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 17:35:39] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 17:35:39] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-22 17:35:39] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-22 17:35:39] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-22 17:35:39] [INFO] [main] ClientConnection constructor called
[2025-06-22 17:35:39] [INFO] [main] Connecting to localhost:2222
[2025-06-22 17:35:39] [INFO] [main] Connected successfully
[2025-06-22 17:35:39] [INFO] [main] Starting key exchange...
[2025-06-22 17:35:39] [INFO] [main] Generated DH key pair
[2025-06-22 17:35:39] [INFO] [main] Created key exchange init message
[2025-06-22 17:35:39] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-22 17:35:39] [INFO] [main] Message sent successfully
[2025-06-22 17:35:39] [INFO] [main] Sent key exchange init message
[2025-06-22 17:35:39] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 17:35:39] [INFO] [main] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [main] Read 4 bytes for message length
[2025-06-22 17:35:39] [INFO] [main] Message length: 1149
[2025-06-22 17:35:39] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-22 17:35:39] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 17:35:39] [INFO] [main] Raw message type byte: 2
[2025-06-22 17:35:39] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 17:35:39] [INFO] [main] fromPacket: restLength = 1149
[2025-06-22 17:35:39] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 17:35:39] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-22 17:35:39] [INFO] [main] fromPacket: checksum = 240069820
[2025-06-22 17:35:39] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 17:35:39] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 17:35:39] [INFO] [main] Set server's public key
[2025-06-22 17:35:39] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 17:35:39] [INFO] [main] Initialized symmetric encryption
[2025-06-22 17:35:39] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:35:39] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 17:35:39] [INFO] [main] Starting authentication...
[2025-06-22 17:35:39] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-22 17:35:39] [INFO] [main] Using password authentication
[2025-06-22 17:35:39] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-22 17:35:39] [INFO] [main] Message encrypted, new length: 85
[2025-06-22 17:35:39] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-22 17:35:39] [INFO] [main] Message sent successfully
[2025-06-22 17:35:39] [INFO] [main] Sent authentication request
[2025-06-22 17:35:39] [INFO] [main] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [main] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [main] Encrypted message length: 84
[2025-06-22 17:35:39] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 17:35:39] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 17:35:39] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 17:35:39] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 17:35:39] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 17:35:39] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 17:35:39] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 17:35:39] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 17:35:39] [INFO] [main] Authentication successful
[2025-06-22 17:35:39] [INFO] [main] Sending service request for: shell
[2025-06-22 17:35:39] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 17:35:39] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 17:35:39] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:35:39] [INFO] [main] Message sent successfully
[2025-06-22 17:35:39] [INFO] [main] Sent service request
[2025-06-22 17:35:39] [INFO] [main] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [main] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [main] Encrypted message length: 42
[2025-06-22 17:35:39] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 17:35:39] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 17:35:39] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 17:35:39] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 17:35:39] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:35:39] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 17:35:39] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 17:35:39] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 17:35:39] [INFO] [main] Service request accepted
[2025-06-22 17:35:39] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-22 17:35:39] [INFO] [main] Message encrypted, new length: 157
[2025-06-22 17:35:39] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-22 17:35:39] [INFO] [main] Message sent successfully
[2025-06-22 17:35:39] [INFO] [main] Waiting for shell response...
[2025-06-22 17:35:39] [INFO] [main] Waiting to receive message...
[2025-06-22 17:35:39] [INFO] [main] Reading encrypted message...
[2025-06-22 17:35:39] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:35:39] [INFO] [main] Encrypted message length: 171
[2025-06-22 17:35:39] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-22 17:35:39] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-22 17:35:39] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-22 17:35:39] [INFO] [main] fromPacket: restLength = 139
[2025-06-22 17:35:39] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 17:35:39] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-22 17:35:39] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-22 17:35:39] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 17:35:39] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-22 17:35:39] [INFO] [main] Shell response processed successfully
[2025-06-22 17:35:39] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:35:39] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:35:39] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:35:39] [INFO] [main] Message sent successfully
[2025-06-22 17:35:40] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:35:40] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:35:40] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:35:40] [INFO] [main] Message sent successfully
[2025-06-22 17:35:40] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:35:40] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:35:40] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:35:40] [INFO] [main] Message sent successfully
[2025-06-22 17:35:40] [INFO] [main] Protocol handler closed
[2025-06-22 17:35:40] [INFO] [main] Disconnected from server
[2025-06-22 17:37:58] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 17:37:58] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 17:37:58] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-22 17:37:58] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-22 17:37:58] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-22 17:37:58] [INFO] [main] ClientConnection constructor called
[2025-06-22 17:37:58] [INFO] [main] Connecting to localhost:2222
[2025-06-22 17:37:58] [INFO] [main] Connected successfully
[2025-06-22 17:37:58] [INFO] [main] Starting key exchange...
[2025-06-22 17:37:58] [INFO] [main] Generated DH key pair
[2025-06-22 17:37:58] [INFO] [main] Created key exchange init message
[2025-06-22 17:37:58] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-22 17:37:58] [INFO] [main] Message sent successfully
[2025-06-22 17:37:58] [INFO] [main] Sent key exchange init message
[2025-06-22 17:37:58] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 17:37:58] [INFO] [main] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [main] Read 4 bytes for message length
[2025-06-22 17:37:58] [INFO] [main] Message length: 1149
[2025-06-22 17:37:58] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-22 17:37:58] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 17:37:58] [INFO] [main] Raw message type byte: 2
[2025-06-22 17:37:58] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 17:37:58] [INFO] [main] fromPacket: restLength = 1149
[2025-06-22 17:37:58] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 17:37:58] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-22 17:37:58] [INFO] [main] fromPacket: checksum = 553869004
[2025-06-22 17:37:58] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 17:37:58] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 17:37:58] [INFO] [main] Set server's public key
[2025-06-22 17:37:58] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 17:37:58] [INFO] [main] Initialized symmetric encryption
[2025-06-22 17:37:58] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:37:58] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 17:37:58] [INFO] [main] Starting authentication...
[2025-06-22 17:37:58] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-22 17:37:58] [INFO] [main] Using password authentication
[2025-06-22 17:37:58] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-22 17:37:58] [INFO] [main] Message encrypted, new length: 85
[2025-06-22 17:37:58] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-22 17:37:58] [INFO] [main] Message sent successfully
[2025-06-22 17:37:58] [INFO] [main] Sent authentication request
[2025-06-22 17:37:58] [INFO] [main] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [main] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [main] Encrypted message length: 84
[2025-06-22 17:37:58] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 17:37:58] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 17:37:58] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 17:37:58] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 17:37:58] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 17:37:58] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 17:37:58] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 17:37:58] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 17:37:58] [INFO] [main] Authentication successful
[2025-06-22 17:37:58] [INFO] [main] Sending service request for: shell
[2025-06-22 17:37:58] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 17:37:58] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 17:37:58] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:37:58] [INFO] [main] Message sent successfully
[2025-06-22 17:37:58] [INFO] [main] Sent service request
[2025-06-22 17:37:58] [INFO] [main] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [main] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [main] Encrypted message length: 42
[2025-06-22 17:37:58] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 17:37:58] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 17:37:58] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 17:37:58] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 17:37:58] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:37:58] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 17:37:58] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 17:37:58] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 17:37:58] [INFO] [main] Service request accepted
[2025-06-22 17:37:58] [INFO] [main] Sending message: SHELL_COMMAND, length: 129
[2025-06-22 17:37:58] [INFO] [main] Message encrypted, new length: 157
[2025-06-22 17:37:58] [INFO] [main] Added length prefix for encrypted message, total length: 161
[2025-06-22 17:37:58] [INFO] [main] Message sent successfully
[2025-06-22 17:37:58] [INFO] [main] Waiting for shell response...
[2025-06-22 17:37:58] [INFO] [main] Waiting to receive message...
[2025-06-22 17:37:58] [INFO] [main] Reading encrypted message...
[2025-06-22 17:37:58] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:37:58] [INFO] [main] Encrypted message length: 171
[2025-06-22 17:37:58] [INFO] [main] Read 171 bytes for encrypted message body
[2025-06-22 17:37:58] [INFO] [main] Decrypting encrypted message, length: 171
[2025-06-22 17:37:58] [INFO] [main] Message decrypted successfully, new length: 143
[2025-06-22 17:37:58] [INFO] [main] fromPacket: restLength = 139
[2025-06-22 17:37:58] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 17:37:58] [INFO] [main] fromPacket: payloadLength = 134 (restLength=139 - 5)
[2025-06-22 17:37:58] [INFO] [main] fromPacket: checksum = -696480792
[2025-06-22 17:37:58] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 17:37:58] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-22 17:37:58] [INFO] [main] Shell response processed successfully
[2025-06-22 17:37:58] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:37:58] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:37:58] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:37:58] [INFO] [main] Message sent successfully
[2025-06-22 17:37:59] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:37:59] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:37:59] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:37:59] [INFO] [main] Message sent successfully
[2025-06-22 17:37:59] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:37:59] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:37:59] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:37:59] [INFO] [main] Message sent successfully
[2025-06-22 17:37:59] [INFO] [main] Protocol handler closed
[2025-06-22 17:37:59] [INFO] [main] Disconnected from server
[2025-06-22 17:43:33] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 17:43:33] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 17:43:33] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-22 17:43:33] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-22 17:43:33] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-22 17:43:33] [INFO] [main] ClientConnection constructor called
[2025-06-22 17:43:33] [INFO] [main] Connecting to localhost:2222
[2025-06-22 17:43:33] [INFO] [main] Connected successfully
[2025-06-22 17:43:33] [INFO] [main] Starting key exchange...
[2025-06-22 17:43:33] [INFO] [main] Generated DH key pair
[2025-06-22 17:43:33] [INFO] [main] Created key exchange init message
[2025-06-22 17:43:33] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-22 17:43:33] [INFO] [main] Message sent successfully
[2025-06-22 17:43:33] [INFO] [main] Sent key exchange init message
[2025-06-22 17:43:33] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 17:43:33] [INFO] [main] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [main] Read 4 bytes for message length
[2025-06-22 17:43:33] [INFO] [main] Message length: 1149
[2025-06-22 17:43:33] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-22 17:43:33] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 44 43 
[2025-06-22 17:43:33] [INFO] [main] Raw message type byte: 2
[2025-06-22 17:43:33] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 17:43:33] [INFO] [main] fromPacket: restLength = 1149
[2025-06-22 17:43:33] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 17:43:33] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-22 17:43:33] [INFO] [main] fromPacket: checksum = 841783102
[2025-06-22 17:43:33] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 17:43:33] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 17:43:33] [INFO] [main] Set server's public key
[2025-06-22 17:43:33] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 17:43:33] [INFO] [main] Initialized symmetric encryption
[2025-06-22 17:43:33] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:43:33] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 17:43:33] [INFO] [main] Starting authentication...
[2025-06-22 17:43:33] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-22 17:43:33] [INFO] [main] Using password authentication
[2025-06-22 17:43:33] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-22 17:43:33] [INFO] [main] Message encrypted, new length: 85
[2025-06-22 17:43:33] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-22 17:43:33] [INFO] [main] Message sent successfully
[2025-06-22 17:43:33] [INFO] [main] Sent authentication request
[2025-06-22 17:43:33] [INFO] [main] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [main] Reading encrypted message...
[2025-06-22 17:43:33] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:43:33] [INFO] [main] Encrypted message length: 84
[2025-06-22 17:43:33] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 17:43:33] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 17:43:33] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 17:43:33] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 17:43:33] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 17:43:33] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 17:43:33] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 17:43:33] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 17:43:33] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 17:43:33] [INFO] [main] Authentication successful
[2025-06-22 17:43:33] [INFO] [main] Sending service request for: shell
[2025-06-22 17:43:33] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 17:43:33] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 17:43:33] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:43:33] [INFO] [main] Message sent successfully
[2025-06-22 17:43:33] [INFO] [main] Sent service request
[2025-06-22 17:43:33] [INFO] [main] Waiting to receive message...
[2025-06-22 17:43:33] [INFO] [main] Reading encrypted message...
[2025-06-22 17:43:33] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:43:33] [INFO] [main] Encrypted message length: 42
[2025-06-22 17:43:33] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 17:43:33] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 17:43:33] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 17:43:33] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 17:43:33] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 17:43:33] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:43:33] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 17:43:33] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 17:43:33] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 17:43:33] [INFO] [main] Service request accepted
[2025-06-22 17:48:16] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 17:48:16] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 17:48:20] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-22 17:48:20] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-22 17:48:20] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-22 17:48:20] [INFO] [main] ClientConnection constructor called
[2025-06-22 17:48:20] [INFO] [main] Connecting to localhost:2222
[2025-06-22 17:48:20] [INFO] [main] Connected successfully
[2025-06-22 17:48:20] [INFO] [main] Starting key exchange...
[2025-06-22 17:48:20] [INFO] [main] Generated DH key pair
[2025-06-22 17:48:20] [INFO] [main] Created key exchange init message
[2025-06-22 17:48:20] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-22 17:48:20] [INFO] [main] Message sent successfully
[2025-06-22 17:48:20] [INFO] [main] Sent key exchange init message
[2025-06-22 17:48:20] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 17:48:20] [INFO] [main] Waiting to receive message...
[2025-06-22 17:48:20] [INFO] [main] Read 4 bytes for message length
[2025-06-22 17:48:20] [INFO] [main] Message length: 1149
[2025-06-22 17:48:20] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-22 17:48:20] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 17:48:20] [INFO] [main] Raw message type byte: 2
[2025-06-22 17:48:20] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 17:48:20] [INFO] [main] fromPacket: restLength = 1149
[2025-06-22 17:48:20] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 17:48:20] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-22 17:48:20] [INFO] [main] fromPacket: checksum = -1583486844
[2025-06-22 17:48:20] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 17:48:20] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 17:48:20] [INFO] [main] Set server's public key
[2025-06-22 17:48:21] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 17:48:21] [INFO] [main] Initialized symmetric encryption
[2025-06-22 17:48:21] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 17:48:21] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 17:48:21] [INFO] [main] Starting authentication...
[2025-06-22 17:48:21] [INFO] [main] Preparing auth for user: test, type: password
[2025-06-22 17:48:21] [INFO] [main] Using password authentication
[2025-06-22 17:48:21] [INFO] [main] Sending message: AUTH_REQUEST, length: 55
[2025-06-22 17:48:21] [INFO] [main] Message encrypted, new length: 83
[2025-06-22 17:48:21] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-22 17:48:21] [INFO] [main] Message sent successfully
[2025-06-22 17:48:21] [INFO] [main] Sent authentication request
[2025-06-22 17:48:21] [INFO] [main] Waiting to receive message...
[2025-06-22 17:48:21] [INFO] [main] Reading encrypted message...
[2025-06-22 17:48:21] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:48:21] [INFO] [main] Encrypted message length: 84
[2025-06-22 17:48:21] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 17:48:21] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 17:48:21] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 17:48:21] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 17:48:21] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 17:48:21] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 17:48:21] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 17:48:21] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 17:48:21] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 17:48:21] [INFO] [main] Authentication successful
[2025-06-22 17:48:21] [INFO] [main] Sending service request for: shell
[2025-06-22 17:48:21] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 17:48:21] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 17:48:21] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 17:48:21] [INFO] [main] Message sent successfully
[2025-06-22 17:48:21] [INFO] [main] Sent service request
[2025-06-22 17:48:21] [INFO] [main] Waiting to receive message...
[2025-06-22 17:48:21] [INFO] [main] Reading encrypted message...
[2025-06-22 17:48:21] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:48:21] [INFO] [main] Encrypted message length: 42
[2025-06-22 17:48:21] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 17:48:21] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 17:48:21] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 17:48:21] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 17:48:21] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 17:48:21] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 17:48:21] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 17:48:21] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 17:48:21] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 17:48:21] [INFO] [main] Service request accepted
[2025-06-22 17:48:34] [INFO] [main] Sending message: SHELL_COMMAND, length: 121
[2025-06-22 17:48:34] [INFO] [main] Message encrypted, new length: 149
[2025-06-22 17:48:34] [INFO] [main] Added length prefix for encrypted message, total length: 153
[2025-06-22 17:48:34] [INFO] [main] Message sent successfully
[2025-06-22 17:48:34] [INFO] [main] Waiting for shell response...
[2025-06-22 17:48:34] [INFO] [main] Waiting to receive message...
[2025-06-22 17:48:34] [INFO] [main] Reading encrypted message...
[2025-06-22 17:48:34] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:48:34] [INFO] [main] Encrypted message length: 307
[2025-06-22 17:48:34] [INFO] [main] Read 307 bytes for encrypted message body
[2025-06-22 17:48:34] [INFO] [main] Decrypting encrypted message, length: 307
[2025-06-22 17:48:34] [INFO] [main] Message decrypted successfully, new length: 279
[2025-06-22 17:48:34] [INFO] [main] fromPacket: restLength = 275
[2025-06-22 17:48:34] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 17:48:34] [INFO] [main] fromPacket: payloadLength = 270 (restLength=275 - 5)
[2025-06-22 17:48:34] [INFO] [main] fromPacket: checksum = 1121450539
[2025-06-22 17:48:34] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 17:48:34] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-22 17:48:34] [INFO] [main] Shell response processed successfully
[2025-06-22 17:48:39] [INFO] [main] Sending message: SHELL_COMMAND, length: 125
[2025-06-22 17:48:39] [INFO] [main] Message encrypted, new length: 153
[2025-06-22 17:48:39] [INFO] [main] Added length prefix for encrypted message, total length: 157
[2025-06-22 17:48:39] [INFO] [main] Message sent successfully
[2025-06-22 17:48:39] [INFO] [main] Waiting for shell response...
[2025-06-22 17:48:39] [INFO] [main] Waiting to receive message...
[2025-06-22 17:48:39] [INFO] [main] Reading encrypted message...
[2025-06-22 17:48:39] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:48:39] [INFO] [main] Encrypted message length: 165
[2025-06-22 17:48:39] [INFO] [main] Read 165 bytes for encrypted message body
[2025-06-22 17:48:39] [INFO] [main] Decrypting encrypted message, length: 165
[2025-06-22 17:48:39] [INFO] [main] Message decrypted successfully, new length: 137
[2025-06-22 17:48:39] [INFO] [main] fromPacket: restLength = 133
[2025-06-22 17:48:39] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 17:48:39] [INFO] [main] fromPacket: payloadLength = 128 (restLength=133 - 5)
[2025-06-22 17:48:39] [INFO] [main] fromPacket: checksum = -877710415
[2025-06-22 17:48:39] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 17:48:39] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-22 17:48:39] [INFO] [main] Shell response processed successfully
[2025-06-22 17:48:41] [INFO] [main] Sending message: SHELL_COMMAND, length: 121
[2025-06-22 17:48:41] [INFO] [main] Message encrypted, new length: 149
[2025-06-22 17:48:41] [INFO] [main] Added length prefix for encrypted message, total length: 153
[2025-06-22 17:48:41] [INFO] [main] Message sent successfully
[2025-06-22 17:48:41] [INFO] [main] Waiting for shell response...
[2025-06-22 17:48:41] [INFO] [main] Waiting to receive message...
[2025-06-22 17:48:41] [INFO] [main] Reading encrypted message...
[2025-06-22 17:48:41] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 17:48:41] [INFO] [main] Encrypted message length: 307
[2025-06-22 17:48:41] [INFO] [main] Read 307 bytes for encrypted message body
[2025-06-22 17:48:41] [INFO] [main] Decrypting encrypted message, length: 307
[2025-06-22 17:48:41] [INFO] [main] Message decrypted successfully, new length: 279
[2025-06-22 17:48:41] [INFO] [main] fromPacket: restLength = 275
[2025-06-22 17:48:41] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 17:48:41] [INFO] [main] fromPacket: payloadLength = 270 (restLength=275 - 5)
[2025-06-22 17:48:41] [INFO] [main] fromPacket: checksum = 1121450539
[2025-06-22 17:48:41] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 17:48:41] [INFO] [main] Received response type: SHELL_RESULT
[2025-06-22 17:48:41] [INFO] [main] Shell response processed successfully
[2025-06-22 17:48:48] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:48:48] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:48:48] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:48:48] [INFO] [main] Message sent successfully
[2025-06-22 17:48:48] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 17:48:48] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 17:48:48] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 17:48:48] [INFO] [main] Message sent successfully
[2025-06-22 17:48:48] [INFO] [main] Protocol handler closed
[2025-06-22 17:48:48] [INFO] [main] Disconnected from server
[2025-06-22 18:03:09] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 18:03:09] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 18:03:12] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-22 18:03:12] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-22 18:03:12] [INFO] [main] Auth credentials for default - Username: admin, Type: password
[2025-06-22 18:03:12] [INFO] [main] ClientConnection constructor called
[2025-06-22 18:03:12] [INFO] [main] Connecting to localhost:2222
[2025-06-22 18:03:12] [INFO] [main] Connected successfully
[2025-06-22 18:03:12] [INFO] [main] Starting key exchange...
[2025-06-22 18:03:12] [INFO] [main] Generated DH key pair
[2025-06-22 18:03:12] [INFO] [main] Created key exchange init message
[2025-06-22 18:03:12] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-22 18:03:12] [INFO] [main] Message sent successfully
[2025-06-22 18:03:12] [INFO] [main] Sent key exchange init message
[2025-06-22 18:03:12] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 18:03:12] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [main] Read 4 bytes for message length
[2025-06-22 18:03:12] [INFO] [main] Message length: 1149
[2025-06-22 18:03:12] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-22 18:03:12] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 18:03:12] [INFO] [main] Raw message type byte: 2
[2025-06-22 18:03:12] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 18:03:12] [INFO] [main] fromPacket: restLength = 1149
[2025-06-22 18:03:12] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 18:03:12] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-22 18:03:12] [INFO] [main] fromPacket: checksum = -1190499941
[2025-06-22 18:03:12] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 18:03:12] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 18:03:12] [INFO] [main] Set server's public key
[2025-06-22 18:03:12] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 18:03:12] [INFO] [main] Initialized symmetric encryption
[2025-06-22 18:03:12] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 18:03:12] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 18:03:12] [INFO] [main] Starting authentication...
[2025-06-22 18:03:12] [INFO] [main] Preparing auth for user: admin, type: password
[2025-06-22 18:03:12] [INFO] [main] Using password authentication
[2025-06-22 18:03:12] [INFO] [main] Sending message: AUTH_REQUEST, length: 57
[2025-06-22 18:03:12] [INFO] [main] Message encrypted, new length: 85
[2025-06-22 18:03:12] [INFO] [main] Added length prefix for encrypted message, total length: 89
[2025-06-22 18:03:12] [INFO] [main] Message sent successfully
[2025-06-22 18:03:12] [INFO] [main] Sent authentication request
[2025-06-22 18:03:12] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:12] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:12] [INFO] [main] Encrypted message length: 84
[2025-06-22 18:03:12] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 18:03:12] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 18:03:12] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 18:03:12] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 18:03:12] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 18:03:12] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 18:03:12] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 18:03:12] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 18:03:12] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 18:03:12] [INFO] [main] Authentication successful
[2025-06-22 18:03:12] [INFO] [main] Sending service request for: shell
[2025-06-22 18:03:12] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 18:03:12] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 18:03:12] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 18:03:12] [INFO] [main] Message sent successfully
[2025-06-22 18:03:12] [INFO] [main] Sent service request
[2025-06-22 18:03:12] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:12] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:12] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:12] [INFO] [main] Encrypted message length: 42
[2025-06-22 18:03:12] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 18:03:12] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 18:03:12] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 18:03:12] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 18:03:12] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 18:03:12] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 18:03:12] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 18:03:12] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 18:03:12] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 18:03:12] [INFO] [main] Service request accepted
[2025-06-22 18:03:24] [INFO] [main] Sending message: SHELL_COMMAND, length: 55
[2025-06-22 18:03:24] [INFO] [main] Message encrypted, new length: 83
[2025-06-22 18:03:24] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-22 18:03:24] [INFO] [main] Message sent successfully
[2025-06-22 18:03:24] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:24] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:24] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:24] [INFO] [main] Encrypted message length: 130
[2025-06-22 18:03:24] [INFO] [main] Read 130 bytes for encrypted message body
[2025-06-22 18:03:24] [INFO] [main] Decrypting encrypted message, length: 130
[2025-06-22 18:03:24] [INFO] [main] Message decrypted successfully, new length: 102
[2025-06-22 18:03:24] [INFO] [main] fromPacket: restLength = 98
[2025-06-22 18:03:24] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:24] [INFO] [main] fromPacket: payloadLength = 93 (restLength=98 - 5)
[2025-06-22 18:03:24] [INFO] [main] fromPacket: checksum = -449758787
[2025-06-22 18:03:24] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:27] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:03:27] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:03:27] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:03:27] [INFO] [main] Message sent successfully
[2025-06-22 18:03:27] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:27] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:27] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:27] [INFO] [main] Encrypted message length: 207
[2025-06-22 18:03:27] [INFO] [main] Read 207 bytes for encrypted message body
[2025-06-22 18:03:27] [INFO] [main] Decrypting encrypted message, length: 207
[2025-06-22 18:03:27] [INFO] [main] Message decrypted successfully, new length: 179
[2025-06-22 18:03:27] [INFO] [main] fromPacket: restLength = 175
[2025-06-22 18:03:27] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:27] [INFO] [main] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-22 18:03:27] [INFO] [main] fromPacket: checksum = -207020665
[2025-06-22 18:03:27] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:36] [INFO] [main] Sending message: SHELL_COMMAND, length: 58
[2025-06-22 18:03:36] [INFO] [main] Message encrypted, new length: 86
[2025-06-22 18:03:36] [INFO] [main] Added length prefix for encrypted message, total length: 90
[2025-06-22 18:03:36] [INFO] [main] Message sent successfully
[2025-06-22 18:03:36] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:36] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:36] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:36] [INFO] [main] Encrypted message length: 102
[2025-06-22 18:03:36] [INFO] [main] Read 102 bytes for encrypted message body
[2025-06-22 18:03:36] [INFO] [main] Decrypting encrypted message, length: 102
[2025-06-22 18:03:36] [INFO] [main] Message decrypted successfully, new length: 74
[2025-06-22 18:03:36] [INFO] [main] fromPacket: restLength = 70
[2025-06-22 18:03:36] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:36] [INFO] [main] fromPacket: payloadLength = 65 (restLength=70 - 5)
[2025-06-22 18:03:36] [INFO] [main] fromPacket: checksum = 1100938607
[2025-06-22 18:03:36] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:39] [INFO] [main] Sending message: SHELL_COMMAND, length: 58
[2025-06-22 18:03:39] [INFO] [main] Message encrypted, new length: 86
[2025-06-22 18:03:39] [INFO] [main] Added length prefix for encrypted message, total length: 90
[2025-06-22 18:03:39] [INFO] [main] Message sent successfully
[2025-06-22 18:03:39] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:39] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:39] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:39] [INFO] [main] Encrypted message length: 2091
[2025-06-22 18:03:39] [INFO] [main] Read 2091 bytes for encrypted message body
[2025-06-22 18:03:39] [INFO] [main] Decrypting encrypted message, length: 2091
[2025-06-22 18:03:39] [INFO] [main] Message decrypted successfully, new length: 2063
[2025-06-22 18:03:39] [INFO] [main] fromPacket: restLength = 2059
[2025-06-22 18:03:39] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:39] [INFO] [main] fromPacket: payloadLength = 2054 (restLength=2059 - 5)
[2025-06-22 18:03:39] [INFO] [main] fromPacket: checksum = -589114611
[2025-06-22 18:03:39] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:41] [INFO] [main] Sending message: SHELL_COMMAND, length: 65
[2025-06-22 18:03:41] [INFO] [main] Message encrypted, new length: 93
[2025-06-22 18:03:41] [INFO] [main] Added length prefix for encrypted message, total length: 97
[2025-06-22 18:03:41] [INFO] [main] Message sent successfully
[2025-06-22 18:03:41] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:41] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:41] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:41] [INFO] [main] Encrypted message length: 140
[2025-06-22 18:03:41] [INFO] [main] Read 140 bytes for encrypted message body
[2025-06-22 18:03:41] [INFO] [main] Decrypting encrypted message, length: 140
[2025-06-22 18:03:41] [INFO] [main] Message decrypted successfully, new length: 112
[2025-06-22 18:03:41] [INFO] [main] fromPacket: restLength = 108
[2025-06-22 18:03:41] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:41] [INFO] [main] fromPacket: payloadLength = 103 (restLength=108 - 5)
[2025-06-22 18:03:41] [INFO] [main] fromPacket: checksum = 959921511
[2025-06-22 18:03:41] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:45] [INFO] [main] Sending message: SHELL_COMMAND, length: 61
[2025-06-22 18:03:45] [INFO] [main] Message encrypted, new length: 89
[2025-06-22 18:03:45] [INFO] [main] Added length prefix for encrypted message, total length: 93
[2025-06-22 18:03:45] [INFO] [main] Message sent successfully
[2025-06-22 18:03:45] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:45] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:45] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:45] [INFO] [main] Encrypted message length: 95
[2025-06-22 18:03:45] [INFO] [main] Read 95 bytes for encrypted message body
[2025-06-22 18:03:45] [INFO] [main] Decrypting encrypted message, length: 95
[2025-06-22 18:03:45] [INFO] [main] Message decrypted successfully, new length: 67
[2025-06-22 18:03:45] [INFO] [main] fromPacket: restLength = 63
[2025-06-22 18:03:45] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:45] [INFO] [main] fromPacket: payloadLength = 58 (restLength=63 - 5)
[2025-06-22 18:03:45] [INFO] [main] fromPacket: checksum = -872243554
[2025-06-22 18:03:45] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:50] [INFO] [main] Sending message: SHELL_COMMAND, length: 55
[2025-06-22 18:03:50] [INFO] [main] Message encrypted, new length: 83
[2025-06-22 18:03:50] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-22 18:03:50] [INFO] [main] Message sent successfully
[2025-06-22 18:03:50] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:50] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:50] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:50] [INFO] [main] Encrypted message length: 127
[2025-06-22 18:03:50] [INFO] [main] Read 127 bytes for encrypted message body
[2025-06-22 18:03:50] [INFO] [main] Decrypting encrypted message, length: 127
[2025-06-22 18:03:50] [INFO] [main] Message decrypted successfully, new length: 99
[2025-06-22 18:03:50] [INFO] [main] fromPacket: restLength = 95
[2025-06-22 18:03:50] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:50] [INFO] [main] fromPacket: payloadLength = 90 (restLength=95 - 5)
[2025-06-22 18:03:50] [INFO] [main] fromPacket: checksum = -704972985
[2025-06-22 18:03:50] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:51] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:03:51] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:03:51] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:03:51] [INFO] [main] Message sent successfully
[2025-06-22 18:03:51] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:51] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:51] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:51] [INFO] [main] Encrypted message length: 207
[2025-06-22 18:03:51] [INFO] [main] Read 207 bytes for encrypted message body
[2025-06-22 18:03:51] [INFO] [main] Decrypting encrypted message, length: 207
[2025-06-22 18:03:51] [INFO] [main] Message decrypted successfully, new length: 179
[2025-06-22 18:03:51] [INFO] [main] fromPacket: restLength = 175
[2025-06-22 18:03:51] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:51] [INFO] [main] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-22 18:03:51] [INFO] [main] fromPacket: checksum = -207020665
[2025-06-22 18:03:51] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:03:55] [INFO] [main] Sending message: SHELL_COMMAND, length: 58
[2025-06-22 18:03:55] [INFO] [main] Message encrypted, new length: 86
[2025-06-22 18:03:55] [INFO] [main] Added length prefix for encrypted message, total length: 90
[2025-06-22 18:03:55] [INFO] [main] Message sent successfully
[2025-06-22 18:03:55] [INFO] [main] Waiting to receive message...
[2025-06-22 18:03:55] [INFO] [main] Reading encrypted message...
[2025-06-22 18:03:55] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:03:55] [INFO] [main] Encrypted message length: 133
[2025-06-22 18:03:55] [INFO] [main] Read 133 bytes for encrypted message body
[2025-06-22 18:03:55] [INFO] [main] Decrypting encrypted message, length: 133
[2025-06-22 18:03:55] [INFO] [main] Message decrypted successfully, new length: 105
[2025-06-22 18:03:55] [INFO] [main] fromPacket: restLength = 101
[2025-06-22 18:03:55] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:03:55] [INFO] [main] fromPacket: payloadLength = 96 (restLength=101 - 5)
[2025-06-22 18:03:55] [INFO] [main] fromPacket: checksum = 996549617
[2025-06-22 18:03:55] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:04:19] [INFO] [main] Sending message: SHELL_COMMAND, length: 58
[2025-06-22 18:04:19] [INFO] [main] Message encrypted, new length: 86
[2025-06-22 18:04:19] [INFO] [main] Added length prefix for encrypted message, total length: 90
[2025-06-22 18:04:19] [INFO] [main] Message sent successfully
[2025-06-22 18:04:19] [INFO] [main] Waiting to receive message...
[2025-06-22 18:04:19] [INFO] [main] Reading encrypted message...
[2025-06-22 18:04:19] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:04:19] [INFO] [main] Encrypted message length: 102
[2025-06-22 18:04:19] [INFO] [main] Read 102 bytes for encrypted message body
[2025-06-22 18:04:19] [INFO] [main] Decrypting encrypted message, length: 102
[2025-06-22 18:04:19] [INFO] [main] Message decrypted successfully, new length: 74
[2025-06-22 18:04:19] [INFO] [main] fromPacket: restLength = 70
[2025-06-22 18:04:19] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:04:19] [INFO] [main] fromPacket: payloadLength = 65 (restLength=70 - 5)
[2025-06-22 18:04:19] [INFO] [main] fromPacket: checksum = 1100938607
[2025-06-22 18:04:19] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:04:21] [INFO] [main] Sending message: SHELL_COMMAND, length: 58
[2025-06-22 18:04:21] [INFO] [main] Message encrypted, new length: 86
[2025-06-22 18:04:21] [INFO] [main] Added length prefix for encrypted message, total length: 90
[2025-06-22 18:04:21] [INFO] [main] Message sent successfully
[2025-06-22 18:04:21] [INFO] [main] Waiting to receive message...
[2025-06-22 18:04:21] [INFO] [main] Reading encrypted message...
[2025-06-22 18:04:21] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:04:21] [INFO] [main] Encrypted message length: 2091
[2025-06-22 18:04:21] [INFO] [main] Read 2091 bytes for encrypted message body
[2025-06-22 18:04:21] [INFO] [main] Decrypting encrypted message, length: 2091
[2025-06-22 18:04:21] [INFO] [main] Message decrypted successfully, new length: 2063
[2025-06-22 18:04:21] [INFO] [main] fromPacket: restLength = 2059
[2025-06-22 18:04:21] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:04:21] [INFO] [main] fromPacket: payloadLength = 2054 (restLength=2059 - 5)
[2025-06-22 18:04:21] [INFO] [main] fromPacket: checksum = -589114611
[2025-06-22 18:04:21] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:04:30] [INFO] [main] Sending message: SHELL_COMMAND, length: 65
[2025-06-22 18:04:30] [INFO] [main] Message encrypted, new length: 93
[2025-06-22 18:04:30] [INFO] [main] Added length prefix for encrypted message, total length: 97
[2025-06-22 18:04:30] [INFO] [main] Message sent successfully
[2025-06-22 18:04:30] [INFO] [main] Waiting to receive message...
[2025-06-22 18:04:30] [INFO] [main] Reading encrypted message...
[2025-06-22 18:04:30] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:04:30] [INFO] [main] Encrypted message length: 140
[2025-06-22 18:04:30] [INFO] [main] Read 140 bytes for encrypted message body
[2025-06-22 18:04:30] [INFO] [main] Decrypting encrypted message, length: 140
[2025-06-22 18:04:30] [INFO] [main] Message decrypted successfully, new length: 112
[2025-06-22 18:04:30] [INFO] [main] fromPacket: restLength = 108
[2025-06-22 18:04:30] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:04:30] [INFO] [main] fromPacket: payloadLength = 103 (restLength=108 - 5)
[2025-06-22 18:04:30] [INFO] [main] fromPacket: checksum = 959921511
[2025-06-22 18:04:30] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:04:33] [INFO] [main] Sending message: SHELL_COMMAND, length: 61
[2025-06-22 18:04:33] [INFO] [main] Message encrypted, new length: 89
[2025-06-22 18:04:33] [INFO] [main] Added length prefix for encrypted message, total length: 93
[2025-06-22 18:04:33] [INFO] [main] Message sent successfully
[2025-06-22 18:04:33] [INFO] [main] Waiting to receive message...
[2025-06-22 18:04:33] [INFO] [main] Reading encrypted message...
[2025-06-22 18:04:33] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:04:33] [INFO] [main] Encrypted message length: 95
[2025-06-22 18:04:33] [INFO] [main] Read 95 bytes for encrypted message body
[2025-06-22 18:04:33] [INFO] [main] Decrypting encrypted message, length: 95
[2025-06-22 18:04:33] [INFO] [main] Message decrypted successfully, new length: 67
[2025-06-22 18:04:33] [INFO] [main] fromPacket: restLength = 63
[2025-06-22 18:04:33] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:04:33] [INFO] [main] fromPacket: payloadLength = 58 (restLength=63 - 5)
[2025-06-22 18:04:33] [INFO] [main] fromPacket: checksum = -872243554
[2025-06-22 18:04:33] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:04:35] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:04:35] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:04:35] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:04:35] [INFO] [main] Message sent successfully
[2025-06-22 18:04:35] [INFO] [main] Waiting to receive message...
[2025-06-22 18:04:35] [INFO] [main] Reading encrypted message...
[2025-06-22 18:04:35] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:04:35] [INFO] [main] Encrypted message length: 207
[2025-06-22 18:04:35] [INFO] [main] Read 207 bytes for encrypted message body
[2025-06-22 18:04:35] [INFO] [main] Decrypting encrypted message, length: 207
[2025-06-22 18:04:35] [INFO] [main] Message decrypted successfully, new length: 179
[2025-06-22 18:04:35] [INFO] [main] fromPacket: restLength = 175
[2025-06-22 18:04:35] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:04:35] [INFO] [main] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-22 18:04:35] [INFO] [main] fromPacket: checksum = -207020665
[2025-06-22 18:04:35] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:05:26] [INFO] [main] Sending message: SHELL_COMMAND, length: 54
[2025-06-22 18:05:26] [INFO] [main] Message encrypted, new length: 82
[2025-06-22 18:05:26] [INFO] [main] Added length prefix for encrypted message, total length: 86
[2025-06-22 18:05:26] [INFO] [main] Message sent successfully
[2025-06-22 18:05:26] [INFO] [main] Waiting to receive message...
[2025-06-22 18:05:26] [INFO] [main] Reading encrypted message...
[2025-06-22 18:05:38] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:05:38] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:05:38] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:05:48] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:05:48] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:05:48] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:05:51] [INFO] [main] Sending message: SHELL_COMMAND, length: 54
[2025-06-22 18:05:51] [INFO] [main] Message encrypted, new length: 82
[2025-06-22 18:05:51] [INFO] [main] Added length prefix for encrypted message, total length: 86
[2025-06-22 18:05:54] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 18:05:54] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 18:05:54] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 18:05:54] [INFO] [main] Sending message: DISCONNECT, length: 43
[2025-06-22 18:05:54] [INFO] [main] Message encrypted, new length: 71
[2025-06-22 18:05:54] [INFO] [main] Added length prefix for encrypted message, total length: 75
[2025-06-22 18:05:54] [INFO] [main] Protocol handler closed
[2025-06-22 18:05:54] [INFO] [main] Disconnected from server
[2025-06-22 18:06:00] [INFO] [main] Logger initialized - logging to: logs/client.log
[2025-06-22 18:06:00] [INFO] [main] Credentials loaded from: config/credentials.properties
[2025-06-22 18:06:02] [ERROR] [main] Invalid port in credentials file: 2222 
[2025-06-22 18:06:02] [INFO] [main] Server info - Host: localhost, Port: 2222, Username: admin
[2025-06-22 18:06:02] [INFO] [main] Auth credentials for user1 - Username: test, Type: password
[2025-06-22 18:06:02] [INFO] [main] ClientConnection constructor called
[2025-06-22 18:06:02] [INFO] [main] Connecting to localhost:2222
[2025-06-22 18:06:02] [INFO] [main] Connected successfully
[2025-06-22 18:06:02] [INFO] [main] Starting key exchange...
[2025-06-22 18:06:02] [INFO] [main] Generated DH key pair
[2025-06-22 18:06:02] [INFO] [main] Created key exchange init message
[2025-06-22 18:06:02] [INFO] [main] Sending message: KEY_EXCHANGE_INIT, length: 791
[2025-06-22 18:06:02] [INFO] [main] Message sent successfully
[2025-06-22 18:06:02] [INFO] [main] Sent key exchange init message
[2025-06-22 18:06:02] [INFO] [main] Waiting for key exchange reply...
[2025-06-22 18:06:02] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [main] Read 4 bytes for message length
[2025-06-22 18:06:02] [INFO] [main] Message length: 1149
[2025-06-22 18:06:02] [INFO] [main] Read 1149 bytes for message body (expected 1149)
[2025-06-22 18:06:02] [INFO] [main] Message body (first 20 bytes): 02 64 68 50 75 62 6C 69 63 4B 65 79 3A 4D 49 49 43 4B 54 43 
[2025-06-22 18:06:02] [INFO] [main] Raw message type byte: 2
[2025-06-22 18:06:02] [INFO] [main] Parsed message type: KEY_EXCHANGE_REPLY
[2025-06-22 18:06:02] [INFO] [main] fromPacket: restLength = 1149
[2025-06-22 18:06:02] [INFO] [main] fromPacket: parsed message type = KEY_EXCHANGE_REPLY
[2025-06-22 18:06:02] [INFO] [main] fromPacket: payloadLength = 1144 (restLength=1149 - 5)
[2025-06-22 18:06:02] [INFO] [main] fromPacket: checksum = -997196463
[2025-06-22 18:06:02] [INFO] [main] Received message: KEY_EXCHANGE_REPLY
[2025-06-22 18:06:02] [INFO] [main] Received reply message: KEY_EXCHANGE_REPLY
[2025-06-22 18:06:02] [INFO] [main] Set server's public key
[2025-06-22 18:06:02] [INFO] [main] Computed shared secret, length: 256
[2025-06-22 18:06:02] [INFO] [main] Initialized symmetric encryption
[2025-06-22 18:06:02] [INFO] [main] Encryption enabled - subsequent messages will be encrypted/decrypted
[2025-06-22 18:06:02] [INFO] [main] Enabled encryption in protocol handler
[2025-06-22 18:06:02] [INFO] [main] Starting authentication...
[2025-06-22 18:06:02] [INFO] [main] Preparing auth for user: test, type: password
[2025-06-22 18:06:02] [INFO] [main] Using password authentication
[2025-06-22 18:06:02] [INFO] [main] Sending message: AUTH_REQUEST, length: 55
[2025-06-22 18:06:02] [INFO] [main] Message encrypted, new length: 83
[2025-06-22 18:06:02] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-22 18:06:02] [INFO] [main] Message sent successfully
[2025-06-22 18:06:02] [INFO] [main] Sent authentication request
[2025-06-22 18:06:02] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:02] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:02] [INFO] [main] Encrypted message length: 84
[2025-06-22 18:06:02] [INFO] [main] Read 84 bytes for encrypted message body
[2025-06-22 18:06:02] [INFO] [main] Decrypting encrypted message, length: 84
[2025-06-22 18:06:02] [INFO] [main] Message decrypted successfully, new length: 56
[2025-06-22 18:06:02] [INFO] [main] fromPacket: restLength = 52
[2025-06-22 18:06:02] [INFO] [main] fromPacket: parsed message type = AUTH_SUCCESS
[2025-06-22 18:06:02] [INFO] [main] fromPacket: payloadLength = 47 (restLength=52 - 5)
[2025-06-22 18:06:02] [INFO] [main] fromPacket: checksum = 773878918
[2025-06-22 18:06:02] [INFO] [main] Received encrypted message: AUTH_SUCCESS
[2025-06-22 18:06:02] [INFO] [main] Received auth response: AUTH_SUCCESS
[2025-06-22 18:06:02] [INFO] [main] Authentication successful
[2025-06-22 18:06:02] [INFO] [main] Sending service request for: shell
[2025-06-22 18:06:02] [INFO] [main] Sending message: SERVICE_REQUEST, length: 14
[2025-06-22 18:06:02] [INFO] [main] Message encrypted, new length: 42
[2025-06-22 18:06:02] [INFO] [main] Added length prefix for encrypted message, total length: 46
[2025-06-22 18:06:02] [INFO] [main] Message sent successfully
[2025-06-22 18:06:02] [INFO] [main] Sent service request
[2025-06-22 18:06:02] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:02] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:02] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:02] [INFO] [main] Encrypted message length: 42
[2025-06-22 18:06:02] [INFO] [main] Read 42 bytes for encrypted message body
[2025-06-22 18:06:02] [INFO] [main] Decrypting encrypted message, length: 42
[2025-06-22 18:06:02] [INFO] [main] Message decrypted successfully, new length: 14
[2025-06-22 18:06:02] [INFO] [main] fromPacket: restLength = 10
[2025-06-22 18:06:02] [INFO] [main] fromPacket: parsed message type = SERVICE_ACCEPT
[2025-06-22 18:06:02] [INFO] [main] fromPacket: payloadLength = 5 (restLength=10 - 5)
[2025-06-22 18:06:02] [INFO] [main] fromPacket: checksum = 1167241981
[2025-06-22 18:06:02] [INFO] [main] Received encrypted message: SERVICE_ACCEPT
[2025-06-22 18:06:02] [INFO] [main] Received service response: SERVICE_ACCEPT
[2025-06-22 18:06:02] [INFO] [main] Service request accepted
[2025-06-22 18:06:07] [INFO] [main] Sending message: SHELL_COMMAND, length: 54
[2025-06-22 18:06:07] [INFO] [main] Message encrypted, new length: 82
[2025-06-22 18:06:07] [INFO] [main] Added length prefix for encrypted message, total length: 86
[2025-06-22 18:06:07] [INFO] [main] Message sent successfully
[2025-06-22 18:06:07] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:07] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:07] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:07] [INFO] [main] Encrypted message length: 88
[2025-06-22 18:06:07] [INFO] [main] Read 88 bytes for encrypted message body
[2025-06-22 18:06:07] [INFO] [main] Decrypting encrypted message, length: 88
[2025-06-22 18:06:07] [INFO] [main] Message decrypted successfully, new length: 60
[2025-06-22 18:06:07] [INFO] [main] fromPacket: restLength = 56
[2025-06-22 18:06:07] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:07] [INFO] [main] fromPacket: payloadLength = 51 (restLength=56 - 5)
[2025-06-22 18:06:07] [INFO] [main] fromPacket: checksum = 1481709134
[2025-06-22 18:06:07] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:06:09] [INFO] [main] Sending message: SHELL_COMMAND, length: 45
[2025-06-22 18:06:09] [INFO] [main] Message encrypted, new length: 73
[2025-06-22 18:06:09] [INFO] [main] Added length prefix for encrypted message, total length: 77
[2025-06-22 18:06:09] [INFO] [main] Message sent successfully
[2025-06-22 18:06:09] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:09] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:09] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:09] [INFO] [main] Encrypted message length: 124
[2025-06-22 18:06:09] [INFO] [main] Read 124 bytes for encrypted message body
[2025-06-22 18:06:09] [INFO] [main] Decrypting encrypted message, length: 124
[2025-06-22 18:06:09] [INFO] [main] Message decrypted successfully, new length: 96
[2025-06-22 18:06:09] [INFO] [main] fromPacket: restLength = 92
[2025-06-22 18:06:09] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:09] [INFO] [main] fromPacket: payloadLength = 87 (restLength=92 - 5)
[2025-06-22 18:06:09] [INFO] [main] fromPacket: checksum = -1084845967
[2025-06-22 18:06:09] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:06:11] [INFO] [main] Sending message: SHELL_COMMAND, length: 44
[2025-06-22 18:06:11] [INFO] [main] Message encrypted, new length: 72
[2025-06-22 18:06:11] [INFO] [main] Added length prefix for encrypted message, total length: 76
[2025-06-22 18:06:11] [INFO] [main] Message sent successfully
[2025-06-22 18:06:11] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:11] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:11] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:11] [INFO] [main] Encrypted message length: 102
[2025-06-22 18:06:11] [INFO] [main] Read 102 bytes for encrypted message body
[2025-06-22 18:06:11] [INFO] [main] Decrypting encrypted message, length: 102
[2025-06-22 18:06:11] [INFO] [main] Message decrypted successfully, new length: 74
[2025-06-22 18:06:11] [INFO] [main] fromPacket: restLength = 70
[2025-06-22 18:06:11] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:11] [INFO] [main] fromPacket: payloadLength = 65 (restLength=70 - 5)
[2025-06-22 18:06:11] [INFO] [main] fromPacket: checksum = 863128434
[2025-06-22 18:06:11] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:06:18] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:06:18] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:06:18] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:06:18] [INFO] [main] Message sent successfully
[2025-06-22 18:06:18] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:18] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:18] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:18] [INFO] [main] Encrypted message length: 95
[2025-06-22 18:06:18] [INFO] [main] Read 95 bytes for encrypted message body
[2025-06-22 18:06:18] [INFO] [main] Decrypting encrypted message, length: 95
[2025-06-22 18:06:18] [INFO] [main] Message decrypted successfully, new length: 67
[2025-06-22 18:06:18] [INFO] [main] fromPacket: restLength = 63
[2025-06-22 18:06:18] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:18] [INFO] [main] fromPacket: payloadLength = 58 (restLength=63 - 5)
[2025-06-22 18:06:18] [INFO] [main] fromPacket: checksum = -872243554
[2025-06-22 18:06:18] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:06:21] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:06:21] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:06:21] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:06:21] [INFO] [main] Message sent successfully
[2025-06-22 18:06:21] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:21] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:21] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:21] [INFO] [main] Encrypted message length: 207
[2025-06-22 18:06:21] [INFO] [main] Read 207 bytes for encrypted message body
[2025-06-22 18:06:21] [INFO] [main] Decrypting encrypted message, length: 207
[2025-06-22 18:06:21] [INFO] [main] Message decrypted successfully, new length: 179
[2025-06-22 18:06:21] [INFO] [main] fromPacket: restLength = 175
[2025-06-22 18:06:21] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:21] [INFO] [main] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-22 18:06:21] [INFO] [main] fromPacket: checksum = -207020665
[2025-06-22 18:06:21] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:06:26] [INFO] [main] Sending message: SHELL_COMMAND, length: 55
[2025-06-22 18:06:26] [INFO] [main] Message encrypted, new length: 83
[2025-06-22 18:06:26] [INFO] [main] Added length prefix for encrypted message, total length: 87
[2025-06-22 18:06:26] [INFO] [main] Message sent successfully
[2025-06-22 18:06:26] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:26] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:26] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:26] [INFO] [main] Encrypted message length: 127
[2025-06-22 18:06:26] [INFO] [main] Read 127 bytes for encrypted message body
[2025-06-22 18:06:26] [INFO] [main] Decrypting encrypted message, length: 127
[2025-06-22 18:06:26] [INFO] [main] Message decrypted successfully, new length: 99
[2025-06-22 18:06:26] [INFO] [main] fromPacket: restLength = 95
[2025-06-22 18:06:26] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:26] [INFO] [main] fromPacket: payloadLength = 90 (restLength=95 - 5)
[2025-06-22 18:06:26] [INFO] [main] fromPacket: checksum = -704972985
[2025-06-22 18:06:26] [INFO] [main] Received encrypted message: SHELL_RESULT
[2025-06-22 18:06:27] [INFO] [main] Sending message: SHELL_COMMAND, length: 51
[2025-06-22 18:06:27] [INFO] [main] Message encrypted, new length: 79
[2025-06-22 18:06:27] [INFO] [main] Added length prefix for encrypted message, total length: 83
[2025-06-22 18:06:27] [INFO] [main] Message sent successfully
[2025-06-22 18:06:27] [INFO] [main] Waiting to receive message...
[2025-06-22 18:06:27] [INFO] [main] Reading encrypted message...
[2025-06-22 18:06:27] [INFO] [main] Read 4 bytes for encrypted message length
[2025-06-22 18:06:27] [INFO] [main] Encrypted message length: 207
[2025-06-22 18:06:27] [INFO] [main] Read 207 bytes for encrypted message body
[2025-06-22 18:06:27] [INFO] [main] Decrypting encrypted message, length: 207
[2025-06-22 18:06:27] [INFO] [main] Message decrypted successfully, new length: 179
[2025-06-22 18:06:27] [INFO] [main] fromPacket: restLength = 175
[2025-06-22 18:06:27] [INFO] [main] fromPacket: parsed message type = SHELL_RESULT
[2025-06-22 18:06:27] [INFO] [main] fromPacket: payloadLength = 170 (restLength=175 - 5)
[2025-06-22 18:06:27] [INFO] [main] fromPacket: checksum = -207020665
[2025-06-22 18:06:27] [INFO] [main] Received encrypted message: SHELL_RESULT
